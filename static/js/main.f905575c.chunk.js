(this.webpackJsonppem=this.webpackJsonppem||[]).push([[0],{44:function(e,t,c){},61:function(e,t,c){},62:function(e,t,c){},63:function(e,t,c){},94:function(e,t,c){"use strict";c.r(t);var a=c(0),n=c(2),s=c.n(n),r=c(33),l=c.n(r),o=(c(61),c(62),c(44),c(6)),i=c(4),u=(c(63),function(){return Object(a.jsx)("div",{className:"outtro",children:Object(a.jsx)("div",{className:"fixed-action-btn",children:Object(a.jsx)("a",{href:"#modal1",className:" modal-trigger btn-floating red darken-2",children:Object(a.jsx)("i",{className:"material-icons mat-icon",style:{fontSize:"140%"},children:"help_outline"})})})})}),d=c(118),j=c(117),b=c(119),f=c(48),m=c.n(f),h=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=Object(n.useState)({}),l=Object(i.a)(r,2),o=l[0],u=l[1];return Object(n.useEffect)((function(){if(c&&s){var e=c.data.fValues,t=s.data.fValues;u({pref:e,nonPref:t})}}),[c,s]),Object(a.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(a.jsx)("div",{className:"s10 ",children:c&&Object(a.jsxs)("div",{className:"choice-container",children:[Object(a.jsx)("p",{children:c.data.scText}),Object(a.jsx)("img",{className:"swipe-img choice-container",src:c.data.scImg,alt:"Image not loaded"})]})}),c&&Object(a.jsx)("button",{value:"A",onClick:function(){t(o)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},O=function(e){var t=e.handleClick,c=e.sc2,s=e.sc1,r=Object(n.useState)({}),l=Object(i.a)(r,2),o=l[0],u=l[1];return Object(n.useEffect)((function(){if(s&&c){var e=s.data.fValues,t=c.data.fValues;u({pref:t,nonPref:e})}}),[s,c]),Object(a.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(a.jsx)("div",{className:"s10 ",children:c&&Object(a.jsxs)("div",{className:"choice-container",children:[Object(a.jsx)("p",{children:c.data.scText}),Object(a.jsx)("img",{className:"swipe-img choice-container",src:c.data.scImg,alt:"Image not loaded"})]})}),c&&Object(a.jsx)("button",{value:"B",onClick:function(){t(o)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},p=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=Object(n.useState)(0),l=Object(i.a)(r,2),o=l[0],u=l[1],f=Object(n.useState)(0),p=Object(i.a)(f,2),g=p[0],x=p[1],v={tabs:{background:"#fff"},label:{fontSize:"100%"}};return Object(a.jsxs)("div",{className:"swiper-container",children:[Object(a.jsx)(b.a,{position:"static",color:"default",children:Object(a.jsxs)(d.a,{indicatorColor:"primary",textColor:"primary",background:"primary",variant:"fullWidth",value:g,onChange:function(e,t){x(t),u(t)},style:v.tabs,children:[Object(a.jsx)(j.a,{style:v.label,label:"option n\xb01"}),Object(a.jsx)(j.a,{style:v.label,label:"option n\xb02"})]})}),Object(a.jsxs)(m.a,{enableMouseEvents:!0,index:o,onChangeIndex:function(e){u(e),x(e)},children:[Object(a.jsx)("div",{className:"slide",children:Object(a.jsx)("div",{className:"innerslide",children:Object(a.jsx)(h,{handleClick:t,sc1:c,sc2:s})})}),Object(a.jsx)("div",{className:"slide",children:Object(a.jsx)("div",{className:"innerslide",children:Object(a.jsx)(O,{handleClick:t,sc1:c,sc2:s})})})]})]})},g=function(e){var t=e.nrQuestions,c=e.sc1,n=e.sc2;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{id:"introModal",className:"modal",children:Object(a.jsxs)("div",{className:"modal-content black-text modal-close center",children:[Object(a.jsx)("h4",{children:"Intro"}),Object(a.jsxs)("p",{className:"flow-text",children:["There are ",t," choices to make during this experiment. In each dilemma, choose one from the two options."]}),Object(a.jsxs)("p",{className:"flow-text",children:[Object(a.jsx)("i",{className:"material-icons danger red darken-2 btn-floating btn-sm",style:{color:"#ffff",fontSize:"140%",margin:"15px"},children:"help_outline"}),"shows additional explanation of each dilemma."]})]})}),Object(a.jsx)("div",{id:"modal1","data-id":"modal1",className:"modal",children:Object(a.jsx)("div",{className:"modal-content black-text modal-close center",children:Object(a.jsxs)("div",{className:"flow-text",children:[Object(a.jsx)("h4",{className:"mb-3",children:"Additional explanation:"}),Object(a.jsx)("h6",{children:Object(a.jsx)("u",{children:"Scenario 1:"})}),c&&Object(a.jsx)("p",{className:"flow-text",children:c.data.scExpl}),c&&0===c.data.scExpl.length&&Object(a.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(a.jsx)("h6",{children:Object(a.jsx)("u",{children:"Scenario 2:"})}),n&&Object(a.jsx)("p",{className:"flow-text",children:n.data.scExpl}),n&&0===n.data.scExpl.length&&Object(a.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(a.jsx)("button",{className:"btn btn-sm blue darken-2 waves-effect waves-light z-depth-2",children:"Close"})]})})})]})},x=c(49),v=c.n(x),N=function(e){var t=e.handleClick,c=e.sc1,n=e.sc2;return Object(a.jsxs)("div",{className:"pc-view",children:[Object(a.jsx)("h4",{children:"Make a choice between the 2 options"}),Object(a.jsxs)("div",{className:"pc-container",children:[Object(a.jsx)("div",{className:"option-container",children:Object(a.jsx)(h,{handleClick:t,sc1:c,sc2:n})}),Object(a.jsx)("div",{className:"option-container",children:Object(a.jsx)(O,{handleClick:t,sc2:n,sc1:c})})]})]})},S=c(15),y=function(){return Object(a.jsxs)("div",{className:"my-5",children:[Object(a.jsx)("p",{children:"Thank you for completing this experiment!"}),Object(a.jsxs)("p",{children:["Your contribution might actually trigger a chain of events that could eventually even save lives!!",Object(a.jsx)("br",{})]})]})},E=c(8),w=c.n(E),C=c(12),F=c(13),k=c(30);c(95),c(96),c(89);k.a.initializeApp({apiKey:"AIzaSyDkuqUfQCo8w_7OWogV44gsGLzaE-yEvX4",authDomain:"pem-firestore.firebaseapp.com",projectId:"pem-firestore",storageBucket:"pem-firestore.appspot.com",messagingSenderId:"528017814946",appId:"1:528017814946:web:f8fab7864531498a146efb"});var D=k.a.storage(),J=k.a.firestore(),V=(k.a.firestore.FieldValue.serverTimestamp,k.a.firestore.FieldPath.documentId,k.a.auth()),A=new k.a.auth.GoogleAuthProvider,I=function(){V.signInWithPopup(A)},L=function(){var e=Object(F.a)(w.a.mark((function e(t,c){var a,n,s,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a=J.doc("users/".concat(t.uid)),e.next=5,a.get();case 5:if(e.sent.exists){e.next=16;break}return n=t.email,s=t.displayName,r=t.photoURL,e.prev=8,e.next=11,a.set(Object(C.a)({displayName:s,email:n,photoURL:r},c));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error creating user document",e.t0);case 16:return e.abrupt("return",P(t.uid));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,c){return e.apply(this,arguments)}}(),P=function(){var e=Object(F.a)(w.a.mark((function e(t){var c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,J.doc("users/".concat(t)).get();case 5:return c=e.sent,e.abrupt("return",Object(C.a)({uid:t},c.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),R=function(e,t){var c=Object(n.useState)([]),a=Object(i.a)(c,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){var c=J.collection("users").doc(e).collection("DceList").doc(t).collection("Scenarios").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(C.a)(Object(C.a)({},e.data()),{},{id:e.id}))})),r(t)}));return function(){return c()}}),[]),{scenarios:s}};var T=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(1),l=Object(i.a)(r,2),d=l[0],j=l[1],b=Object(n.useState)([Object(a.jsx)("span",{class:"dot blue darken-2"})]),f=Object(i.a)(b,2),m=f[0],h=f[1],O=Object(n.useState)([]),x=Object(i.a)(O,2),E=x[0],w=x[1],C=Object(n.useState)(null),F=Object(i.a)(C,2),k=F[0],D=F[1],V=Object(n.useState)(null),A=Object(i.a)(V,2),I=A[0],L=A[1],P=Object(n.useState)(null),T=Object(i.a)(P,2),q=T[0],G=T[1],B=Object(n.useState)(null),U=Object(i.a)(B,2),_=U[0],M=U[1],Q=Object(n.useState)(0),z=Object(i.a)(Q,2),W=z[0],Y=z[1],H=Object(n.useState)(!1),K=Object(i.a)(H,2),X=K[0],Z=K[1],$=Object(n.useState)(!1),ee=Object(i.a)($,2),te=ee[0],ce=ee[1],ae=Object(S.g)(),ne=ae.userId,se=ae.dceId,re=R(ne,se).scenarios,le=Object(n.useRef)(!0);Object(n.useEffect)((function(){v.a.AutoInit()}));var oe=function(e){console.log("result passed from Choices: "+JSON.stringify(e));var t=Object(o.a)(c);t.push(e),s(t),ie(X),d+1>W&&ce(!0),j(d+1),ue()},ie=function(e){if(!e){var t=be(),c=t.ScenarioA,a=t.ScenarioB;D(c),L(a),console.log("not grouped: random scenario1: "+JSON.stringify(c)),console.log("not grouped: random scenario2: "+JSON.stringify(a))}if(e){var n=je(),s=n.ScenarioA,r=n.ScenarioB;D(s),L(r),console.log("grouped: random scenario1: "+JSON.stringify(s)),console.log("grouped: random scenario2: "+JSON.stringify(r))}},ue=function(){console.log(m);var e=[];(e=Object(o.a)(m)).push(Object(a.jsx)("span",{class:"dot blue darken-2"})),h(e);var t=[];(t=Object(o.a)(E)).pop(),w(t)},de=function(e){var t=[];null!=q&&(t=Object(o.a)(q));for(var c=-1,a=5*re.length;a>0;a--){var n=Math.floor(Math.random()*e);if(console.log("tempRndA nr is: "+n),console.log("usedNrsA in for loop: "+JSON.stringify(t)),!t.includes(n)){c=n;break}}return-1!==c&&t.push(c),G(t),c},je=function(){var e=re.length,t=de(e),c=re[t];if(c){console.log("randNrA: "+t+" scenarioA: "+JSON.stringify(c));var a=c.data.altnr;console.log("altnr from getGroupedSc: "+a);var n=re.find((function(e){return e.data.nr===a}));return console.log("scenario B inside getGroupedscenarios: "+JSON.stringify(n)),{ScenarioA:c,ScenarioB:n}}return ce(!0),{ScenarioA:"",ScenarioB:""}},be=function(){var e=function(){var e=[];null!=_&&(e=Object(o.a)(_));var t=re.length,c=de(t),a=-1;console.log("usedNrsB: "+JSON.stringify(e)),console.log("maxnr is: "+t);for(var n=10*re.length;n>0;n--){var s=Math.floor(Math.random()*t);if(console.log("tempRndB nr is: "+s),console.log("usedNrsB in for loop: "+JSON.stringify(e)),c!==s){a=s;break}}return-1!==a&&e.push(a),M(e),{RandomNrA:c,RandomNrB:a}}(),t=e.RandomNrA,c=e.RandomNrB;return{ScenarioA:re[t],ScenarioB:re[c]}};return Object(n.useEffect)((function(){J.collection("users").doc(ne).collection("DceList").doc(se).get().then((function(e){console.log("dce nr questions: "+JSON.stringify(e.data().nrQuestions));var t=e.data().nrQuestions,c=e.data().grouped;Y(t),Z(c),function(e){for(var t=[],c=0;c<e-1;c++)t.push(Object(a.jsx)("span",{class:"dot"}));w(t)}(t),0!==re.length&&ie(c)}))}),[re]),Object(n.useEffect)((function(){if(console.log("initial render: "+le+" and intialRender.current: "+le.current),le.current)le.current=!1;else{console.log("dce is finished: save to db");var e=J.collection("users").doc(ne).collection("DceList").doc(se).collection("RawResults");c.map((function(t,c){e.add(t)}))}}),[te]),Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(g,{nrQuestions:W,sc1:k,sc2:I}),!te&&Object(a.jsx)(p,{handleClick:oe,sc1:k,sc2:I}),!te&&k&&Object(a.jsx)(N,{handleClick:oe,sc1:k,sc2:I}),te&&Object(a.jsx)(y,{}),!te&&Object(a.jsx)(u,{}),!te&&Object(a.jsxs)("div",{className:"footer",children:[m,E]})]})},q=c(9),G=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(""),l=Object(i.a)(r,2),o=l[0],u=l[1],d=Object(n.useState)(null),j=Object(i.a)(d,2),b=j[0],f=j[1],m=function(e){var t=e.currentTarget,c=t.name,a=t.value;"userEmail"===c?s(a):"userPassword"===c&&u(a)};return Object(a.jsxs)("div",{className:"row justify-content-center",children:[Object(a.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign In"}),Object(a.jsxs)("div",{className:"col-sm-7",children:[null!==b&&Object(a.jsx)("div",{className:"text-danger mb-3",children:b}),Object(a.jsxs)("form",{className:"",children:[Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your email",id:"userEmail",onChange:function(e){return m(e)}}),Object(a.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(a.jsxs)("div",{className:"form-floating ",children:[Object(a.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return m(e)}}),Object(a.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){!function(e,t,c){e.preventDefault(),console.log("signing in w pw n email "+JSON.stringify(t)),V.signInWithEmailAndPassword(t,c).catch((function(e){f("Error signing in with password and email!"),console.error("Error signing in with password and email",e)}))}(e,c,o)},children:"Sign in"})]}),Object(a.jsx)("p",{className:"my-3",children:"or"}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(){I()},children:"Sign in with Google"}),Object(a.jsxs)("p",{className:"my-3",children:["Don't have an account?"," ",Object(a.jsx)(q.b,{to:"/signUp",className:"text-blue-500 hover:text-blue-600",children:"Sign up here"})," ",Object(a.jsx)("br",{})," ",Object(a.jsx)(q.b,{to:"passwordReset",className:"text-blue-500 hover:text-blue-600",children:"Forgot Password?"})]})]})]})},B=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(""),l=Object(i.a)(r,2),o=l[0],u=l[1],d=Object(n.useState)(""),j=Object(i.a)(d,2),b=j[0],f=j[1],m=Object(n.useState)(null),h=Object(i.a)(m,2),O=h[0],p=h[1],g=function(){var e=Object(F.a)(w.a.mark((function e(t,c,a){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,V.createUserWithEmailAndPassword(c,a);case 4:n=e.sent,r=n.user,L(r,{displayName:b}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),p("Error Signing up with email and password");case 12:s(""),u(""),f("");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,c,a){return e.apply(this,arguments)}}(),x=function(e){var t=e.currentTarget,c=t.name,a=t.value;"userEmail"===c?s(a):"userPassword"===c?u(a):"displayName"===c&&f(a)};return Object(a.jsxs)("div",{className:"row justify-content-center",children:[Object(a.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign Up"}),Object(a.jsxs)("div",{className:"col-sm-7",children:[null!==O&&Object(a.jsx)("div",{className:"text-danger mb-3",children:O}),Object(a.jsxs)("form",{className:"",children:[Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"text",className:"form-control ",name:"displayName",value:b,placeholder:"Display name",id:"displayName",onChange:function(e){return x(e)}}),Object(a.jsx)("label",{htmlFor:"displayName",className:"block",children:"Display Name:"})]}),Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your Email",id:"userEmail",onChange:function(e){return x(e)}}),Object(a.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return x(e)}}),Object(a.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){g(e,c,o)},children:"Sign up"})]}),Object(a.jsx)("p",{className:"my-3",children:"or"}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(){try{I()}catch(O){console.error("Error signing in with Google",O)}},children:"Sign In with Google"}),Object(a.jsxs)("p",{className:"my-3",children:["Already have an account?"," ",Object(a.jsx)(q.b,{to:"/",className:"text-blue-500 hover:text-blue-600",children:"Sign in here"})," "]})]})]})},U=c(50),_=c(34),M=c(52),Q=c(51),z=Object(n.createContext)({user:null}),W=function(e){Object(M.a)(c,e);var t=Object(Q.a)(c);function c(){var e;Object(U.a)(this,c);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={user:null},e.componentDidMount=Object(F.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:V.onAuthStateChanged(function(){var t=Object(F.a)(w.a.mark((function t(c){var a;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L(c);case 2:a=t.sent,e.setState({user:a}),console.log("Logged in, user: "+JSON.stringify(a));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e}return Object(_.a)(c,[{key:"render",value:function(){var e=this.state.user;return Object(a.jsx)(z.Provider,{value:e,children:this.props.children})}}]),c}(n.Component),Y=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(!1),l=Object(i.a)(r,2),o=l[0],u=l[1],d=Object(n.useState)(null),j=Object(i.a)(d,2),b=j[0],f=j[1];return Object(a.jsxs)("div",{className:"row justify-content-center",children:[Object(a.jsx)("h1",{className:"text-xl text-center font-bold mb-3",children:"Reset your Password"}),Object(a.jsxs)("div",{className:"col-sm-7",children:[Object(a.jsxs)("form",{action:"",children:[o&&Object(a.jsx)("div",{className:"text-danger mb-3",children:"An email has been sent to you!"}),null!==b&&Object(a.jsx)("div",{className:"text-danger mb-3",children:b}),Object(a.jsxs)("div",{class:"form-floating",children:[Object(a.jsx)("input",{type:"email",name:"userEmail",id:"userEmail",value:c,placeholder:"Input your email",onChange:function(e){var t=e.currentTarget,c=t.name,a=t.value;"userEmail"===c&&s(a)},className:"form-control"}),Object(a.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(a.jsx)("button",{className:"btn btn-outline-info my-3",onClick:function(e){!function(e){e.preventDefault(),V.sendPasswordResetEmail(c).then((function(){u(!0),setTimeout((function(){u(!1)}),3e3)})).catch((function(){f("Error resetting password")}))}(e)},children:"Send me a reset link"})]}),Object(a.jsx)(q.b,{to:"/",className:"my-2 text-blue-700 hover:text-blue-800 text-center block",children:"\u2190 back to sign in page"})]})]})};function H(e){var t=e.showDceList,c=e.showNewDceForm,s=e.dceNameList,r=Object(n.useState)([{featureName:null,featureValue1:null,featureValue2:null}]),l=Object(i.a)(r,2),u=l[0],d=l[1],j=Object(n.useState)([{dceName:""}]),b=Object(i.a)(j,2),f=b[0],m=b[1],h=Object(n.useState)(!1),O=Object(i.a)(h,2),p=O[0],g=O[1],x=Object(n.useState)(null),v=Object(i.a)(x,2),N=v[0],S=v[1],y=Object(n.useState)(0),E=Object(i.a)(y,2),w=E[0],C=E[1],F=Object(n.useContext)(z).uid,k=function(e){return null==e.featureName||""===e.featureName?(alert("Please fill in all feature names"),!1):null!=e.featureValue1&&""!==e.featureValue1&&null!=e.featureValue2&&""!==e.featureValue2||(alert("Please fill in all feature values"),!1)},D=function(e){return f[0].dceName===e},V=function(e,t){var c=e.target,a=c.name,n=c.value,s=Object(o.a)(u);s[t][a]=n,d(s)},A=function(){d([].concat(Object(o.a)(u),[{featureName:null,featureValue1:null,featureValue2:null}]))},I=u.map((function(e,t){return Object(a.jsx)("option",{value:e.featureName,children:e.featureName},t)}));return Object(a.jsx)("div",{children:Object(a.jsxs)("form",{className:"form-inline",children:[Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"text",className:"form-control",name:"dceName",placeholder:"DCE name",id:"dceName",required:!0,onChange:function(e){var t=e.target.value,c=Object(o.a)(f);c[0].dceName=t,m(c)}}),Object(a.jsx)("label",{htmlFor:"dceName",className:"block",children:"Name: "})]}),u.map((function(e,c){return Object(a.jsxs)("div",{className:" row",children:[Object(a.jsxs)("div",{className:"col-xs-12 col-sm-9 form-floating",children:[Object(a.jsx)("input",{className:"form-control ",name:"featureName",required:!0,id:c,placeholder:"Enter feature name",value:e.featureName,onChange:function(e){return V(e,c)}}),Object(a.jsx)("label",{htmlFor:c,className:"",children:"Feature name: "})]}),Object(a.jsx)("div",{className:"col col-xs-1",children:1!==u.length&&Object(a.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(){return function(e){var c=Object(o.a)(u);c.splice(e,1),d(c),t()}(c)},children:Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})})}),Object(a.jsxs)("div",{className:"col-xs-12 col-sm-9 form-floating",children:[Object(a.jsx)("input",{className:"form-control ",name:"featureValue1",required:!0,id:c,placeholder:"Enter feature value 1",value:e.featureValue1,onChange:function(e){return V(e,c)}}),Object(a.jsx)("label",{htmlFor:c,className:"",children:"Feature value 1: "})]}),Object(a.jsxs)("div",{className:"col-xs-12 col-sm-9 form-floating",children:[Object(a.jsx)("input",{className:"form-control ",name:"featureValue2",required:!0,id:c,placeholder:"Enter feature value 2",value:e.featureValue2,onChange:function(e){return V(e,c)}}),Object(a.jsx)("label",{htmlFor:c,className:"",children:"Feature value 2: "})]}),Object(a.jsx)("div",{children:u.length-1===c&&Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:A,children:"Add another feature"})})]})})),Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{htmlFor:"nrChoices",children:"Nr of questions in DCE"}),Object(a.jsx)("input",{type:"number",className:"col col-xs-1",id:"nrChoices",required:!0,onChange:function(e){var t,c=e.target.value;t=Number(c),C(t)}})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{type:"checkbox",name:"group",id:"chkGrp",onClick:function(e){var t=e.target.checked;g(t)}}),Object(a.jsx)("label",{htmlFor:"group",className:"",children:"Group by feature "})]}),Object(a.jsx)("div",{children:p&&Object(a.jsxs)("label",{htmlFor:"groupFeature",className:"col-xs-6 col-form-label",children:["Group feature",Object(a.jsxs)("select",{className:"form-select form-select-sm col-xs-6 ",defaultValue:"",name:"groupFeature",id:"groupFeature",onChange:function(e){var t=e.target.value;S(t)},children:[Object(a.jsx)("option",{value:"",disabled:!0}),I]})]})}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){(e.preventDefault(),u.every(k)&&(""===f[0].dceName||s.some(D)?(alert("Fill in a unique DCE name"),0):!(w<=0)||(alert("Fill in the number of questions the participant has to answer in the DCE"),0)))&&(J.collection("users").doc(F).collection("DceList").add({name:f[0],features:u,nrFeatures:u.length,grouped:p,groupFeature:N,nrQuestions:w}).then((function(e){console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)})),t(),c())},children:"Save DCE"})]})})}var K=function(e,t,c){var a=Object(n.useState)(0),s=Object(i.a)(a,2),r=s[0],l=s[1],o=Object(n.useState)(null),u=Object(i.a)(o,2),d=u[0],j=u[1],b=Object(n.useState)(null),f=Object(i.a)(b,2),m=f[0],h=f[1],O=Object(n.useContext)(z).uid;return Object(n.useEffect)((function(){var c=D.ref(e.name);J.collection("users").doc(O).collection("DceList").doc(t).collection("Scenarios");c.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;l(t)}),(function(e){j(e)}),Object(F.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getDownloadURL();case 2:t=e.sent,h(t);case 4:case"end":return e.stop()}}),e)}))))}),[e]),{progress:r,url:m,error:d}},X=function(e){var t=e.file,c=e.setFile,s=e.dceId,r=e.scNr,l=e.setUrl,o=K(t,s,r),i=o.progress,u=o.url;return Object(n.useEffect)((function(){u&&(c(null),l(u))}),[u,c]),Object(a.jsx)("div",{className:"progress-bar",style:{width:i+"%"}})},Z=function(e){var t=e.dceId,c=e.scNr,s=e.setUrl,r=Object(n.useState)(null),l=Object(i.a)(r,2),o=l[0],u=l[1],d=Object(n.useState)(null),j=Object(i.a)(d,2),b=j[0],f=j[1],m=["image/png","image/jpeg"];return Object(a.jsxs)("form",{children:[Object(a.jsxs)("label",{children:[Object(a.jsx)("input",{type:"file",style:{height:0,width:0},onChange:function(e){var t=e.target.files[0];t&&m.includes(t.type)?(u(t),f("")):(u(null),f("Please select an image file (png or jpg)"))}}),Object(a.jsx)("span",{className:"btn btn-sm btn-outline-info mb-3",children:"Upload image"})]}),Object(a.jsxs)("div",{className:"output",children:[b&&Object(a.jsx)("div",{className:"error",children:b}),o&&Object(a.jsx)("div",{children:o.name}),o&&Object(a.jsx)(X,{file:o,setFile:u,dceId:t,scNr:c,setUrl:s})]})]})};function $(e){var t=e.dceId,c=e.dceFeatures,s=e.dceDetails,r=e.scNr,l=e.setScNr,u=e.chosen,d=e.setChosen,j=e.handleAddScenario,b=e.setIsSaved,f=e.isSaved,m=Object(n.useContext)(z).uid,h=Object(n.useState)(r),O=Object(i.a)(h,2),p=(O[0],O[1]),g=function(e){e.preventDefault();var t=e.target,c=t.name,a=t.value,n=Object(o.a)(u);n[0].data.fValues[c]=a,d(n),b(!1)},x=function(e){e.preventDefault();var t=e.target,c=t.name,a=t.value,n=Object(o.a)(u);n[0].data[c]=a,d(n),b(!1)},v=function(e){var t,a=s.details.groupFeature,n=e[a];c.map((function(e,c){console.log("Feature: "+JSON.stringify(e.featureName)),e.featureName===a&&(console.log("Group feat ===featureName"),e.featureValue1===n&&(t=e.featureValue2),e.featureValue2===n&&(t=e.featureValue1))})),console.log("newFeatValue is: "+t);var r=Object(C.a)({},e);return r[a]=t,{altFValueList:r,newFeatValue:t}},N=function(){var e=Object(F.a)(w.a.mark((function e(a){var n,s,l,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),0===u[0].data.scText.length&&0===u[0].data.scImg.length&&alert("Fill in the Scenario Text or upload a Scenario Image, or do both"),c.some((function(e){return 0===u[0].data.fValues[e.featureName].length&&(alert("Select a value for every feature in the scenario"),!0)})),J.collection("users").doc(m).collection("DceList").doc(t).collection("Scenarios").doc(r.toString()).set(u[0]),n=u[0].data.fValues,console.log("fValues in handleSave: "+JSON.stringify(n)),s=u[0].data.altnr,console.log("altnr is: "+s),l=v(n),o=l.altFValueList,console.log("altFValues in handleSave: "+JSON.stringify(o)),s&&J.collection("users").doc(m).collection("DceList").doc(t).collection("Scenarios").doc(s.toString()).update({"data.fValues":o}),b(!0);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{children:[s&&s.details.grouped&&u[0].data&&Object(a.jsxs)("h5",{children:["Paired with scenario nr: ",u[0].data.altnr]}),Object(a.jsxs)("form",{className:"form-row",children:[Object(a.jsx)("h6",{children:"Features"}),u[0].data&&c.map((function(e,t){return Object(a.jsxs)("label",{htmlFor:t,className:"col-md-3 col-form-label",children:[e.featureName,Object(a.jsxs)("select",{className:"form-select form-select-sm col-md-3  mb-3",disabled:u[0].data.altSc,name:e.featureName,defaultValue:u[0].data.fValues[e.featureName],onChange:g,id:t,required:!0,children:[Object(a.jsx)("option",{value:"",disabled:!0}),Object(a.jsx)("option",{value:e.featureValue1,children:e.featureValue1}),Object(a.jsx)("option",{value:e.featureValue2,children:e.featureValue2})]})]})}))]}),u[0].data&&Object(a.jsxs)("form",{id:"textForm",onSubmit:N,children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("h6",{children:"Scenario text"}),Object(a.jsx)("textarea",{className:"form-control form-control-sm mb-3",name:"scText",value:u[0].data.scText,placeholder:"Enter scenario text",id:"scText",onChange:function(e){return x(e)}})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("h6",{children:"Scenario explanation"}),Object(a.jsx)("textarea",{className:"form-control form-control-sm mb-3",type:"text",name:"scExpl",value:u[0].data.scExpl,placeholder:"Enter additional explanatory text",id:"scExpl",onChange:function(e){return x(e)}})]}),Object(a.jsx)("h6",{children:"Scenario image link"}),Object(a.jsx)(Z,{dceId:t,scNr:r,setUrl:function(e){var t=Object(o.a)(u);t[0].data.scImg=e,d(t),b(!1)}}),u[0].data.scImg&&Object(a.jsx)("img",{src:u[0].data.scImg,className:"scImage",alt:"scenario image"}),s&&s.details.grouped&&!u[0].data.altnr&&Object(a.jsx)("input",{className:"btn  btn-outline-success mb-3",type:"button",onClick:function(e){var c;console.log("handle create clicked"),j(r).then((function(a){c=a,console.log("New seqNr is: "+c);var n=Object(o.a)(u),s=u[0].data.fValues;console.log("fValueList: "+JSON.stringify(s));var r=v(s),i=r.altFValueList;r.newFeatValue;console.log("altFValues is: "+JSON.stringify(i)),n[0].data.altnr=c,d(n),p(c),l(c),N(e).then((function(){d([{}]),J.collection("users").doc(m).collection("DceList").doc(t).collection("Scenarios").doc(c.toString()).get().then((function(e){var a=[e.data()];a[0].data.fValues=i,d(a),J.collection("users").doc(m).collection("DceList").doc(t).collection("Scenarios").doc(c.toString()).set(a[0])}))}))}))},value:"Save & Create pair"}),(u[0].data.altnr||!s.details.grouped)&&Object(a.jsx)("input",{className:"btn  btn-outline-success mb-3",type:"submit",value:"Save"})]}),f&&Object(a.jsx)("div",{className:f,children:"Scenario has been saved"})]})}function ee(e){var t=e.dceNameEdit,c=e.dceId,s=e.dceFeatures,r=e.dceDetails,l=Object(n.useContext)(z).uid,o=Object(n.useState)([{nr:0}]),u=Object(i.a)(o,2),d=u[0],j=u[1],b=Object(n.useState)([]),f=Object(i.a)(b,2),m=f[0],h=f[1],O=Object(n.useState)(""),p=Object(i.a)(O,2),g=p[0],x=p[1],v=Object(n.useState)(!1),N=Object(i.a)(v,2),S=N[0],y=N[1],E=function(){var e=Object(F.a)(w.a.mark((function e(){var t,a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=8;break}return t=J.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").orderBy("data.nr"),e.next=4,t.get();case 4:a=e.sent,n=[],a.docs.forEach((function(e){n.push(Object(C.a)(Object(C.a)({},e.data()),{},{id:e.id}))})),h(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){E(),j([{}]),x(null),y(!1)}),[c]);var k=function(){var e=Object(F.a)(w.a.mark((function e(t){var a,n,r,o,i,u;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=19;break}return a={},s.map((function(e){a[e.featureName]=""})),n=J.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").orderBy("data.nr"),e.next=6,n.get();case 6:return r=e.sent,o=1,r.docs.forEach((function(e){e.data().data.nr===o?(console.log("doc id == seqNr, seqNr is: "+o+"doc id is: "+e.data().data.nr),o+=1):console.log("doc id !== seqNr, seqNr is: "+o+"doc id is: "+e.data().data.nr)})),i=!1,t&&(i=!0),j([{}]),u={data:{nr:o,altnr:t,altSc:i,fValues:a,scText:"",scImg:"",scExpl:""}},J.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(o.toString()).set(u),j([u]),x(o),E(),e.abrupt("return",o);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){var t;j([{}]),console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),x(t),J.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(t).get().then((function(e){var t=e.data();j([t]),y(!1)}))};return Object(a.jsxs)("div",{children:[Object(a.jsxs)("h4",{children:[Object(a.jsx)("u",{children:"Details"})," for ",Object(a.jsxs)("b",{children:[" ",t]}),g&&Object(a.jsxs)("span",{children:[" - Scenario nr. ",g]}),!g&&Object(a.jsx)("span",{children:" - Select a scenario nr."})]}),Object(a.jsx)("div",{className:"",children:Object(a.jsxs)("h6",{children:[r&&Object(a.jsxs)("span",{children:[" ",Object(a.jsx)(q.b,{to:{pathname:"/app/"+l+"/"+c},children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"play_circle_outline"})})})]}),r&&Object(a.jsx)("span",{children:" Play this DCE"})," ",r&&Object(a.jsxs)("span",{children:[" ",Object(a.jsx)("hr",{className:"ruler detailsRuler"})," ",Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){var e=window.location.href+"app/"+l+"/"+c;navigator.clipboard.writeText(e)},children:"Copy DCE link "})]})," "]})}),Object(a.jsx)("div",{className:"pb-4",children:Object(a.jsxs)("h6",{children:[" ",r&&r.details.grouped&&Object(a.jsxs)("span",{children:["Group feature: ",r.details.groupFeature]})," ",r&&Object(a.jsxs)("span",{children:[" ",Object(a.jsx)("hr",{className:"ruler detailsRuler"})," Questions in DCE: ",r.details.nrQuestions]})]})}),Object(a.jsxs)("div",{className:"row",children:[Object(a.jsxs)("div",{className:"scenarioList col col-6 col-md-3 col-sm-5",children:[Object(a.jsx)("h5",{children:"Scenario's"}),Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{className:"listRuler mb-1",children:["Nr.  ",Object(a.jsx)("hr",{className:"ruler"})," Edit ",Object(a.jsx)("hr",{className:"rulerSm"}),"\xa0Delete "]}),m&&m.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:D,children:e.data.nr}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsxs)("button",{className:"btn  btn-outline-warning btn-sm mx-2",onClick:D,children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"edit"})]}),Object(a.jsx)("hr",{className:"rulerSm"}),Object(a.jsxs)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:function(e){window.confirm("Are you sure you wish to delete this scenario?")&&function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");var a=m.find((function(e){return e.id===t})).data.altnr;console.log("Alt sc that should be deleted: "+JSON.stringify(a)),J.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(t).delete().then((function(){console.log("Scenario with ID "+t+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),a&&J.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(a.toString()).delete().then((function(){console.log("Alt scenario with ID "+a.toString()+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),t===g&&(j([{}]),x(""),y(!1)),E()}(e)},children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]})]})})},t)})),c&&Object(a.jsx)("li",{className:"mb-2",children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){return k(null)},children:"Add scenario"})})]})]}),Object(a.jsx)("div",{className:"col",children:Object(a.jsx)($,{dceId:c,dceFeatures:s,dceDetails:r,scNr:g,setScNr:x,chosen:d,setChosen:j,handleAddScenario:k,setIsSaved:y,isSaved:S})})]})]})}function te(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(!1),l=Object(i.a)(r,2),o=l[0],u=l[1],d=Object(n.useState)("(Click on EDIT in DCE list)"),j=Object(i.a)(d,2),b=j[0],f=j[1],m=Object(n.useState)([]),h=Object(i.a)(m,2),O=h[0],p=h[1],g=Object(n.useState)(""),x=Object(i.a)(g,2),v=x[0],N=x[1],S=Object(n.useState)([]),y=Object(i.a)(S,2),E=y[0],k=y[1],D=Object(n.useState)(null),V=Object(i.a)(D,2),A=V[0],I=V[1],L=Object(n.useContext)(z),P=L.uid;console.log("user uid in dcelist is: "+JSON.stringify(L.uid));var R=function(){var e=Object(F.a)(w.a.mark((function e(){var t,c,a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=J.collection("users").doc(P).collection("DceList"),e.next=3,t.get();case 3:c=e.sent,a=[],n=[],c.docs.forEach((function(e){a.push(Object(C.a)(Object(C.a)({},e.data()),{},{id:e.id})),n.push(e.data().name.dceName)})),s(a),k(n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){R()}),[]);var T=function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");J.collection("users").doc(P).collection("DceList").doc(t).get().then((function(e){var c=e.data().name.dceName,a={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};f(c),p(e.data().features),N(t),I(a)}))},G=function(){o?u(!1):o||u(!0)};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row my-4",children:[Object(a.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(a.jsxs)("div",{className:" col-auto ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"DCE list"})}),Object(a.jsxs)("ul",{children:[c&&console.log("dceHtml: "+JSON.stringify(c)),c&&c.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(a.jsx)("b",{children:e.name.dceName}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-warning mx-1",onClick:T,children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"edit"})}),Object(a.jsx)(q.b,{to:{pathname:"/aspectList/"+P+"/"+e.id,dceFeatures:e.features,groupFeature:e.groupFeature,dceNameEdit:b},children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"settings"})})}),Object(a.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-1",onClick:function(e){window.confirm("Are you sure you wish to delete this DCE?")&&function(e){var t;t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),J.collection("users").doc(P).collection("DceList").doc(t).delete().then((function(){console.log("Documentwith ID"+t.id+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),R()}(e)},children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"delete_forever"})})]})})},t)}))]})]}),Object(a.jsx)("div",{className:"row my-4",children:Object(a.jsxs)("div",{className:"col-auto  ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"Create new DCE"})}),Object(a.jsxs)("div",{children:[" ",Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:G,children:" new DCE"})]}),o&&Object(a.jsx)(H,{showDceList:R,showNewDceForm:G,dceNameList:E})]})})]}),Object(a.jsx)("div",{className:"col scenarioContainer",children:Object(a.jsx)(ee,{dceNameEdit:b,dceId:v,dceFeatures:O,dceDetails:A})})]})})}var ce=function(e,t){var c=Object(n.useState)([]),a=Object(i.a)(c,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){if(t){console.log("user en dce id in loadResults: "+e+" "+t);var c=J.collection("users").doc(e).collection("DceList").doc(t).collection("RawResults").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(C.a)(Object(C.a)({},e.data().pref),{},{id:e.id}))})),r(t)}));return function(){return c()}}}),[t]),{results:s}};function ae(e){var t=e.dceId,c=e.dceNameEdit,s=e.dceDetails,r=e.dceFeatures,l=e.user,u=Object(n.useState)([]),d=Object(i.a)(u,2),j=d[0],b=d[1],f=Object(n.useState)([]),m=Object(i.a)(f,2),h=(m[0],m[1],Object(n.useState)([])),O=Object(i.a)(h,2),p=O[0],g=O[1],x=(Object(S.f)(),l.uid);console.log("user and dce id in ResultDce: "+JSON.stringify(l.uid)+" "+t),console.log("dceDetails in ResultDce start: "+JSON.stringify(s));var v=ce(x,t).results,N=Object(n.useState)(null),y=Object(i.a)(N,2),E=y[0],w=(y[1],s.details);Object(n.useEffect)((function(){if(t&&w){console.log("DceId in useEffect: "+t);var e=[];J.collection("users").doc(x).collection("DceList").doc(t).collection("AspectList").get().then((function(c){c.forEach((function(c){console.log("Aspects just loaded, in docs.forEach, doc: "+JSON.stringify(c.data())),e.push({aspectName:c.data().aspectName,id:c.id}),J.collection("users").doc(x).collection("DceList").doc(t).collection("AspectList").doc(c.id).collection("Combis").get().then((function(t){console.log("tempAspectObjs at start: "+JSON.stringify(e));var a=[];t.forEach((function(e){console.log("doc.is is: "+c.id);var t=e.data(),n=[],s=[];n.push.apply(n,Object(o.a)(t.filters)),s.push.apply(s,Object(o.a)(t.filters)),console.log("favorFilters is : "+JSON.stringify(n));var l={fName:w.groupFeature,fValue:e.data().groupValue};n.push(l);var i="";r.map((function(t,c){console.log("Feature: "+JSON.stringify(t.featureName)),t.featureName===w.groupFeature&&(console.log("Group feat ===featureName"),t.featureValue1===e.data().groupValue&&(i=t.featureValue2),t.featureValue2===e.data().groupValue&&(i=t.featureValue1))}));var u={fName:w.groupFeature,fValue:i};s.push(u),console.log("tempFilter: "+JSON.stringify(t)),t.favorFilters=n,t.againstFilters=s,console.log("tempFilter: "+JSON.stringify(t)),console.log("groupFeature: "+w.groupFeature+" favorFilters: "+JSON.stringify(n)+"  againstFilters: "+JSON.stringify(s)),a.push(t),console.log("Combis in snap: "+JSON.stringify(a)+JSON.stringify(c.id))})),console.log("doc.is is: "+c.id);var n=[].concat(e),s=e.findIndex((function(e){return e.id===c.id}));console.log("index2: "+JSON.stringify(s)),n[s].combis=a,console.log("ind: "+E),console.log("newtempObjs before setting: "+JSON.stringify(n)),g(n)}))}))}))}else;}),[t]),Object(n.useEffect)((function(){var e=[];console.log("all aspectObj is: "+JSON.stringify(p)),p.forEach((function(t){var c=t.aspectName,n=[],s=[];console.log("aspectObj is: "+JSON.stringify(t)),t.combis&&(console.log("combi if entered"),t.combis.forEach((function(e){console.log("combi: "+JSON.stringify(e));e.nr;v.filter((function(t){var c=!0;return e.favorFilters.forEach((function(e){console.log("forEach favFilter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){console.log(" forEach favor "+JSON.stringify(e)),-1===n.indexOf(e)&&n.push(e)}));v.filter((function(t){var c=!0;return e.againstFilters.forEach((function(e){console.log("forEach againstFilter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){console.log(" forEach against "+JSON.stringify(e)),-1===s.indexOf(e)&&s.push(e),console.log("oddsAgainst: "+JSON.stringify(s))}))})));var r=1;s.length>0&&(r=n.length/s.length);C(r);var l=n.length/(n.length+s.length)*2-1,o=Math.abs(50*l),i=F(l),u=k(l);console.log("oddsFavor: "+JSON.stringify(n)),e.push(Object(a.jsxs)("div",{children:["Aspect: ",c," ",Object(a.jsx)("br",{}),Object(a.jsxs)("div",{className:i,children:[Object(a.jsx)("div",{className:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"}),0===l&&Object(a.jsx)("div",{class:"progress-bar bg-teal",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"}),Object(a.jsx)("div",{className:u,role:"progressbar","aria-valuenow":l,"aria-valuemin":"0","aria-valuemax":"100",style:{width:o+"%"},children:(l>=.1||l<=-.1)&&Object(a.jsxs)("span",{className:"sr-only",children:["\u0394 P = ",l.toFixed(2)]})})]}),l<.1&&l>-.1&&Object(a.jsxs)("div",{children:["\u0394 P = ",l.toFixed(2)]})]})),console.log("resultHtml: "+JSON.stringify(e)),b(e)}))}),[p]);var C=function(e){return 1/(1+Math.pow(Math.E,-e))},F=function(e){var t="progress w-80 mx-auto";return e<0&&(t="progress w-80 mx-auto flex-row-reverse"),console.log("clNames: "+t),t},k=function(e){var t="progress-bar bg-teal progress-bar-striped";return e<0&&(t="progress-bar bg-purple progress-bar-striped"),t};return Object(a.jsxs)("div",{children:[Object(a.jsxs)("h4",{children:["Results for: ",c]}),Object(a.jsx)("div",{className:"mb-3",children:" \u0394 P shows the difference in probability that the aspect is true and the probability that the aspect is not true"}),j,Object(a.jsxs)("div",{class:"progress w-80 mx-auto flex-row-reverse",children:[Object(a.jsx)("div",{class:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"}),Object(a.jsx)("div",{class:"progress-bar bg-success",role:"progressbar",style:{width:"10%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100",children:Object(a.jsx)("span",{className:"sr-only",children:"\u0394P = -0.08"})}),Object(a.jsx)("div",{class:"progress-bar bg-danger",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"})]})]})}function ne(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(!1),l=Object(i.a)(r,2),o=(l[0],l[1],Object(n.useState)("(Click on EDIT in DCE list)")),u=Object(i.a)(o,2),d=u[0],j=u[1],b=Object(n.useState)([]),f=Object(i.a)(b,2),m=f[0],h=f[1],O=Object(n.useState)(""),p=Object(i.a)(O,2),g=p[0],x=p[1],v=Object(n.useState)([]),N=Object(i.a)(v,2),y=(N[0],N[1]),E=Object(n.useState)([]),k=Object(i.a)(E,2),D=k[0],V=k[1];console.log("Params at start dces "+JSON.stringify(Object(S.g)()));var A=Object(n.useContext)(z),I=A.uid;console.log("user uid in dces is: "+JSON.stringify(A.uid));var L=function(){var e=Object(F.a)(w.a.mark((function e(){var t,c,a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=J.collection("users").doc(I).collection("DceList"),e.next=3,t.get();case 3:c=e.sent,a=[],n=[],c.docs.forEach((function(e){a.push(Object(C.a)(Object(C.a)({},e.data()),{},{id:e.id})),n.push(e.data().name.dceName)})),s(a),y(n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){L(),console.log("user uid in dces is: "+JSON.stringify(A.uid))}),[A]);var P=function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");J.collection("users").doc(I).collection("DceList").doc(t).get().then((function(e){var c=e.data().name.dceName,a={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};j(c),V(a),h(e.data().features),x(t),console.log("dceDetails onCreate: "+JSON.stringify(a))}))};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row my-4",children:[Object(a.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(a.jsxs)("div",{className:" col-auto ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"DCE list"})}),Object(a.jsx)("ul",{children:c&&c.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(a.jsx)("b",{children:e.name.dceName}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsx)(q.b,{to:{pathname:"/app/"+I+"/"+e.id},children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"play_circle_outline"})})}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",onClick:P,children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"poll"})})]})})},t)}))})]}),Object(a.jsx)("div",{className:"row my-4",children:Object(a.jsx)("div",{className:"col-auto  ",children:Object(a.jsx)("div",{})})})]}),Object(a.jsx)("div",{className:"col scenarioContainer",children:Object(a.jsx)(ae,{dceDetails:D,dceNameEdit:d,dceId:g,dceFeatures:m,user:A})})]})})}function se(e){var t=e.showAspectList,c=e.showNewAspectForm,s=e.aspectNameList,r=Object(n.useState)([{featureName:null,featureValue1:null,featureValue2:null}]),l=Object(i.a)(r,2),u=(l[0],l[1],Object(n.useState)(["name"])),d=Object(i.a)(u,2),j=d[0],b=d[1],f=Object(S.g)(),m=f.userId,h=f.dceId,O=(Object(n.useContext)(z).uid,function(e){return j[0].aspectName===e});return Object(a.jsx)("div",{children:Object(a.jsxs)("form",{className:"form-inline",children:[Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"text",className:"form-control",name:"aspectName",placeholder:"Aspect name",id:"aspectName",required:!0,onChange:function(e){var t=e.target.value,c=Object(o.a)(j);c[0]=t,b(c)}}),Object(a.jsx)("label",{htmlFor:"aspectName",className:"block",children:"Name: "})]}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){if(e.preventDefault(),""!==j[0].aspectName&&!s.some(O)||(alert("Fill in a unique aspect name"),0)){var a=J.collection("users").doc(m).collection("DceList").doc(h).collection("AspectList");a.add({aspectName:j[0]}).then((function(e){console.log("Document written with ID: ",e.id),a.doc(e.id).collection("Combis").doc("0").set({nr:0,groupValue:"",filters:[]})})).catch((function(e){console.error("Error adding document: ",e)})),t(),c()}},children:"Save aspect"})]})})}function re(e){var t=e.aspectNameEdit,c=e.aspectFilters,s=e.saveFilters,r=e.chosenFeatures,l=e.setChosenFeatures,u=e.handleAddCombi,d=e.handleDeleteCombi,j=e.aspectsObjs,b=e.groupValues,f=e.setGroupValues,m=Object(n.useState)(1),h=Object(i.a)(m,2),O=(h[0],h[1],Object(n.useState)(null)),p=Object(i.a)(O,2),g=p[0],x=p[1],v=Object(n.useState)(null),N=Object(i.a)(v,2),y=N[0],E=N[1],w=Object(n.useState)([]),C=Object(i.a)(w,2),F=C[0],k=C[1],D=Object(n.useState)([]),J=Object(i.a)(D,2),V=J[0],A=J[1],I=Object(n.useState)([]),L=Object(i.a)(I,2),P=(L[0],L[1]),R=Object(S.g)(),T=R.userId,q=R.dceId,G=Object(S.f)(),B=G.dceFeatures,U=G.groupFeature,_=ce(T,q).results;console.log("props from location: "+JSON.stringify(G)),console.log("aspectNameEdit: "+JSON.stringify(t)),console.log("aspecteFilters: "+JSON.stringify(c)),Object(n.useEffect)((function(){var e=[];j.forEach((function(t){var c=t.aspectName,n=[];console.log("aspectObj: "+JSON.stringify(t));var s=t.combis.nr;t.combis.filters.forEach((function(e){_.filter((function(t){return console.log("forEach filter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)})).forEach((function(e){-1===n.indexOf(e)&&n.push(e)}))})),console.log("oddsFavor: "+JSON.stringify(n)),e.push(Object(a.jsxs)("div",{children:["Aspect: ",c,"Nr: ",s,"Length: ",n.length,JSON.stringify(n)]})),console.log("resultHtml: "+JSON.stringify(e)),P(e)}))}),[j]);var M=function(e){e.preventDefault(),x(null),console.log("SetFormValue null");var t=e.target,a=t.value,n=(t.id,e.target.dataset.id);console.log("handleChosen triggered, target:"+JSON.stringify(e.target.dataset)),console.log("value is: "+JSON.stringify(a)),console.log("chosenFeatures before copy: "+JSON.stringify(r)),console.log("aspectFilter before copy: "+JSON.stringify(c));var s=Object(o.a)(r);s[n][0]={fName:a},console.log("chosenList: "+JSON.stringify(s)),l(s)},Q=function(e){e.preventDefault(),x(null),E(null);var t=e.target,c=t.value,a=(t.id,e.target.dataset.id);console.log("handleFValue triggered, cIndex = "+a);var n=Object(o.a)(r);console.log("chosenList: "+JSON.stringify(n)),n[a][0].fValue=c,console.log("chosenList: "+JSON.stringify(n)),l(n)},z=function(e){e.preventDefault();var t=e.target,c=t.value,a=(t.id,e.target.dataset.id),n=Object(o.a)(b);n[a]=c,f(n),console.log("handleGroup value: "+c),console.log("Group values: "+JSON.stringify(n))},W=function(e){e.preventDefault();var t=e.target.dataset.id;console.log("handleSave data-id: "+JSON.stringify(e.target.dataset.id)),console.log("chosenFeatures at start of handleSave: "+JSON.stringify(r)),console.log("chosenFeatues[cIndex] at start of handleSave: "+JSON.stringify(r[t]));var a=[].concat(Object(o.a)(c[t]),Object(o.a)(r[t])),n=Object(o.a)(r);n[t]=[],console.log("group values: "+JSON.stringify(b)),0===b[t].length?alert("Select a value for the Group feature before saving"):(s(t,a,n,b),console.log("tempList in save: "+JSON.stringify(a)),console.log("tempChosen in save: "+JSON.stringify(n)),x(""),console.log("SetFormValue blanc"),E(""))};Object(n.useEffect)((function(){console.log("chosenFeatures in useEffect: "+JSON.stringify(r)),console.log("aspectFilters in useEffect: "+JSON.stringify(c)),x(""),E("");var e=[];c.map((function(t,n){e.push(Object(a.jsxs)("div",{children:[" ",0!==n&&Object(a.jsxs)("h5",{className:"my-5",children:[Object(a.jsxs)("button",{onClick:function(e){return d(e,n)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]}),"combined with:"]}),Object(a.jsxs)("h5",{children:["Select value for group feature - ",U]}),Object(a.jsxs)("label",{htmlFor:"groupVal",children:["Group value",console.log("dceFeatures and groupFeature in select: "+JSON.stringify(B)+JSON.stringify(U)),console.log("groupValues: "+JSON.stringify(b)),Object(a.jsxs)("select",{name:"groupVal",id:"",className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:b[n],"data-id":n,onChange:z,children:[Object(a.jsx)("option",{value:"",disabled:!0}),B&&Object(a.jsx)("option",{value:B.find((function(e){return e.featureName===U})).featureValue1,children:B.find((function(e){return e.featureName===U})).featureValue1}),B&&Object(a.jsx)("option",{value:B.find((function(e){return e.featureName===U})).featureValue2,children:B.find((function(e){return e.featureName===U})).featureValue2})]})]}),Object(a.jsx)("h5",{children:"Saved features and values"})]})),t.map((function(t,r){console.log("filter is: "+JSON.stringify(t)),e.push(Object(a.jsxs)("div",{className:"my-3",children:[Object(a.jsx)("div",{className:"savedFeatures my-2 mx-3 px-5 py-1 p-3 border rounded",children:t.fName}),Object(a.jsx)("span",{className:"savedFeatures mx-3 px-5 py-1 border rounded",children:t.fValue}),Object(a.jsx)("span",{children:Object(a.jsxs)("button",{onClick:function(e){return function(e,t,a){e.preventDefault();var n=a.toString();console.log("delete filter with id "+t),console.log("delete filter with cIndex "+n);var r=Object(o.a)(c[n]);console.log("tempFilters voor splice: "+JSON.stringify(r));var l=[];c.map((function(e){l.push([])})),r.splice(t,1),console.log("tempFilters na splice: "+JSON.stringify(r)),console.log("emptyChosen na splice: "+JSON.stringify(l)),s(n,r,l,b)}(e,r,n)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]})})]}))})),e.push(Object(a.jsxs)("div",{children:[Object(a.jsxs)("span",{children:[Object(a.jsxs)("form",{children:[console.log("groupFeature: "+U),console.log("dceFeatures: "+JSON.stringify(B)),Object(a.jsxs)("label",{htmlFor:"fNames",className:"col-md-3 col-form-label",children:["Add filter feature",Object(a.jsx)("select",{className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:g,"data-id":n,id:0,onChange:M,children:B&&B.map((function(e,t){console.log("ind is: "+t);var c=e.featureName,n="";return e.featureName===U&&(c="",n="disabled"),Object(a.jsxs)("option",{value:c,disabled:n,children:[c," "]})}))})]})]}),B&&Object(a.jsx)("form",{children:Object(a.jsxs)("label",{htmlFor:"fValue",children:["Filter value",Object(a.jsxs)("select",{name:"fValue",id:"",className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:y,"data-id":n,onChange:Q,children:[Object(a.jsx)("option",{value:"",disabled:!0}),console.log("chosenFeatures: "+JSON.stringify(r)),r[n]&&console.log("chosenFeatures[cIndex][0]: "+JSON.stringify(r[n])),r[n][0]&&Object(a.jsx)("option",{value:B.find((function(e){return e.featureName===r[n][0].fName})).featureValue1,children:B.find((function(e){return e.featureName===r[n][0].fName})).featureValue1}),r[n][0]&&Object(a.jsx)("option",{value:B.find((function(e){return e.featureName===r[n][0].fName})).featureValue2,children:B.find((function(e){return e.featureName===r[n][0].fName})).featureValue2})]})]})})]}),Object(a.jsx)("button",{"data-id":n,className:"btn btn-sm btn-outline-info mb-3",onClick:W,children:"save filter feature and group value"})]}))})),A(e)}),[r,b]),Object(n.useEffect)((function(){console.log("Rerender choose html"),console.log("chosenFeatures in choose html: "+JSON.stringify(r)),E("");var e=[];"(Click on EDIT in Aspect list)"!==t&&e.push(Object(a.jsxs)("div",{children:[Object(a.jsx)("form",{children:Object(a.jsxs)("label",{htmlFor:"fNames",className:"col-md-3 col-form-label",children:["Add filter feature",Object(a.jsxs)("select",{className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:g,"data-id":0,id:r.length-1,onChange:M,children:[Object(a.jsx)("option",{value:"",disabled:!0}),B&&B.map((function(e,t){return console.log("ind is: "+t),Object(a.jsxs)("option",{value:e.featureName,children:[e.featureName," "]})}))]})]})}),B&&Object(a.jsx)("form",{children:Object(a.jsxs)("label",{htmlFor:"fValue",children:["Filter value",Object(a.jsxs)("select",{name:"fValue",id:"",className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:y,"data-id":0,onChange:Q,children:[Object(a.jsx)("option",{value:"",disabled:!0}),console.log("i="+r.length-1),console.log("chosenFeatures: "+JSON.stringify(r)),r[0][0]&&Object(a.jsx)("option",{value:B.find((function(e){return e.featureName===r[0][0].fName})).featureValue1,children:B.find((function(e){return e.featureName===r[0][0].fName})).featureValue1}),r[0][0]&&Object(a.jsx)("option",{value:B.find((function(e){return e.featureName===r[0][0].fName})).featureValue2,children:B.find((function(e){return e.featureName===r[0][0].fName})).featureValue2})]})]})}),Object(a.jsx)("button",{"data-id":"0",className:"btn btn-sm btn-outline-info mb-3",onClick:W,children:"save filter feature"})]})),k(e)}),[r]);var Y=[];return"(Click on EDIT in Aspect list)"!==t&&Y.push(Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:u,children:"add combination feature"})),Object(a.jsxs)("div",{children:[Object(a.jsxs)("h4",{children:["Define aspect for ",t]}),V,0===V.length&&F,function(){},V.length>2&&Y]})}function le(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)([]),l=Object(i.a)(r,2),u=l[0],d=l[1],j=Object(n.useState)([]),b=Object(i.a)(j,2),f=b[0],m=b[1],h=Object(n.useState)([]),O=Object(i.a)(h,2),p=O[0],g=O[1],x=Object(n.useState)([]),v=Object(i.a)(x,2),N=v[0],y=v[1],E=Object(n.useState)(!1),k=Object(i.a)(E,2),D=k[0],V=k[1],A=Object(n.useState)("(Click on EDIT in Aspect list)"),I=Object(i.a)(A,2),L=I[0],P=I[1],R=Object(n.useState)([]),T=Object(i.a)(R,2),q=(T[0],T[1],Object(n.useState)("")),G=Object(i.a)(q,2),B=G[0],U=G[1],_=Object(n.useState)([]),M=Object(i.a)(_,2),Q=M[0],W=(M[1],Object(n.useState)(null)),Y=Object(i.a)(W,2),H=(Y[0],Y[1],Object(n.useContext)(z)),K=(H.uid,Object(S.g)()),X=K.userId,Z=K.dceId,$=Object(S.f)().dceNameEdit;console.log("location data in aspectList: "+JSON.stringify(Object(S.f)())),console.log("user uid in dcelist is: "+JSON.stringify(H.uid));var ee=function(){var e=Object(F.a)(w.a.mark((function e(){var t,c,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList"),e.next=3,t.get();case 3:c=e.sent,a=[],c.docs.forEach((function(e){a.push(Object(C.a)(Object(C.a)({},e.data()),{},{id:e.id}))})),console.log("Aspects data: "+JSON.stringify(a)),s(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){ee()}),[]);var te=function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),ce(t)},ce=function(e){var t=[],c=J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(e);c.get().then((function(a){var n=a.data().aspectName;console.log("docData: "+JSON.stringify(a.data()));var s=[],r=[],l=[];c.collection("Combis").get().then((function(e){e.docs.forEach((function(e){console.log("snap: "+JSON.stringify(e.data().filters)),s.push(e.data().filters),r.push({aspectName:n,combis:{nr:e.data().nr,groupValue:e.data().groupValue,filters:e.data().filters}}),t.push([]),l.push(e.data().groupValue)})),console.log("objCombis: "+JSON.stringify(r)),console.log("emptyChosen: "+JSON.stringify(t)),console.log("tempGValues: "+JSON.stringify(l)),y(l),d(r),g(s),m(t)})),P(n),U(e)}))},ae=function(){var e=Object(F.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(B).collection("Combis").orderBy("nr","asc").get().then((function(e){console.log("data in handleAddCombi: "+JSON.stringify(e.docs));for(var t=0,c=0;c<e.docs.length;c++){if(e.docs[c].data().nr!==t)return console.log("doc nr !== seqNr, seqNr is: "+t+"doc id is: "+e.docs[c].data().nr),void ne(t);console.log("doc nr == seqNr, seqNr is: "+t+"doc id is: "+e.docs[c].data().nr),t+=1,c===e.docs.length-1&&(console.log("Last doc, i===length"),ne(t))}}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(e){J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(B).collection("Combis").doc(e.toString()).set({nr:e,groupValue:"",filters:[]}).then((function(){console.log("combi added"),ce(B)})).catch((function(e){console.log("Error adding combi",e)}))},le=function(e){var t;t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");var c=J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(t);c.collection("Combis").get().then((function(e){e.forEach((function(e){c.collection("Combis").doc(e.id).delete().then((function(){console.log("Combi with ID "+e.id+" deleted")}))}))})).then((function(){console.log("Combis deleted"),c.delete().then((function(){console.log("Documentwith ID"+t+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),t===B&&(U(""),P("(Click on EDIT in Aspect list)"),g([]),m([])),ee()}))},oe=function(){D?V(!1):D||V(!0)};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row my-4",children:[Object(a.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(a.jsxs)("div",{className:" col-auto ",children:[Object(a.jsx)("h4",{children:Object(a.jsxs)("u",{children:["Aspect list for ",$]})}),Object(a.jsx)("ul",{children:c&&c.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(a.jsx)("b",{children:e.aspectName}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-warning",onClick:te,children:Object(a.jsx)("i",{class:"material-icons mat-icon",children:"edit"})}),Object(a.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:le,children:Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})})]})})},t)}))})]}),Object(a.jsx)("div",{className:"row my-4",children:Object(a.jsxs)("div",{className:"col-auto  ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"Create new Aspect"})}),Object(a.jsxs)("div",{children:[" ",Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:oe,children:" new Aspect"})]}),D&&Object(a.jsx)(se,{dceId:Z,showAspectList:ee,showNewAspectForm:oe,aspectNameList:Q})]})})]}),Object(a.jsx)("div",{className:"col scenarioContainer",children:Object(a.jsx)(re,{aspectNameEdit:L,aspectFilters:p,saveFilters:function(e,t,c,a){console.log("params: userId: "+X+" dceId: "+Z+" aspectId: "+B+" cIndex: "+e),console.log("cINdex: "+e+"filters: "+JSON.stringify(t)+" emptyChosen: "+JSON.stringify(c)),J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(B).collection("Combis").doc(e).update({filters:t,groupValue:a[e]}).then((function(){var a=Object(o.a)(p);a[e]=t,g(a),m(c),console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))},chosenFeatures:f,setChosenFeatures:m,handleAddCombi:ae,handleDeleteCombi:function(e,t){J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(B).collection("Combis").doc(t.toString()).delete().then((function(){console.log("Combination successfully deleted!"),ce(B)})).catch((function(e){console.error("Error removing document: ",e)}))},aspectsObjs:u,groupValues:N,setGroupValues:y})})]})})}var oe=function(){return Object(n.useContext)(z)?Object(a.jsx)(S.c,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(S.a,{exact:!0,path:"/",children:Object(a.jsx)(te,{})}),Object(a.jsx)(S.a,{exact:!0,path:"/dces",children:Object(a.jsx)(ne,{})}),Object(a.jsx)(S.a,{exact:!0,path:"/results",children:Object(a.jsx)(ne,{})}),Object(a.jsx)(S.a,{path:"/aspectList/:userId/:dceId",exact:!0,component:function(){return Object(a.jsx)(le,{})}}),Object(a.jsx)(S.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(a.jsx)(T,{})}})]})}):Object(a.jsx)(S.c,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsxs)(S.a,{exact:!0,path:"/signUp",children:[" ",Object(a.jsx)(B,{})]}),Object(a.jsxs)(S.a,{exact:!0,path:"/",children:[" ",Object(a.jsx)(G,{})]}),Object(a.jsxs)(S.a,{exact:!0,path:"/passwordReset",children:[" ",Object(a.jsx)(Y,{})," "]}),Object(a.jsx)(S.a,{exact:!0,path:"/dces",children:Object(a.jsx)(G,{})}),Object(a.jsx)(S.a,{exact:!0,path:"/results",children:Object(a.jsx)(G,{})}),Object(a.jsx)(S.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(a.jsx)(T,{})}})]})})};var ie=Object(S.h)((function(e){var t=Object(n.useContext)(z),c=Object(n.useState)(t),s=Object(i.a)(c,2),r=(s[0],s[1]);return Object(n.useEffect)((function(){r(V.currentUser)})),Object(a.jsx)("div",{className:"navigation",children:Object(a.jsx)("nav",{class:"navbar navbar-expand navbar-dark bg-dark",children:Object(a.jsxs)("div",{class:"container",children:[Object(a.jsx)(q.b,{class:"navbar-brand",to:"/",children:"PEM"}),Object(a.jsx)("div",{children:Object(a.jsxs)("ul",{class:"navbar-nav ml-auto",children:[Object(a.jsx)("li",{class:"nav-item  ".concat("/"===e.location.pathname?"active":""),children:Object(a.jsx)(q.b,{class:"nav-link",to:"/",children:"Develop"})}),Object(a.jsx)("li",{class:"nav-item  ".concat("/dces"===e.location.pathname?"active":""),children:Object(a.jsx)(q.b,{class:"nav-link",to:"/dces",children:"Run/Results"})}),Object(a.jsx)("li",{className:"nav-item",children:Object(a.jsx)(q.b,{to:"/",className:"nav-link",onClick:function(){V.signOut()},children:"Sign out"})})]})})]})})})}));var ue=function(){return Object(n.useContext)(z),Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(ie,{}),Object(a.jsx)(W,{children:Object(a.jsx)(oe,{})})]})})};l.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(ue,{})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.f905575c.chunk.js.map