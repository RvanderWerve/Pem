(this.webpackJsonppem=this.webpackJsonppem||[]).push([[0],{47:function(e,t,c){},63:function(e,t,c){},64:function(e,t,c){},97:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c(1),a=c.n(s),r=c(34),o=c.n(r),i=(c(63),c(47),c(6)),l=c(3),u=(c(64),function(){return Object(n.jsx)("div",{className:"outtro",children:Object(n.jsx)("div",{className:"fixed-action-btn",children:Object(n.jsx)("a",{href:"#modal1",className:" modal-trigger btn-floating red darken-2",children:Object(n.jsx)("i",{className:"material-icons mat-icon",style:{fontSize:"140%"},children:"help_outline"})})})})}),d=c(121),j=c(120),b=c(122),f=c(50),m=c.n(f),O=function(e){var t=e.handleClick,c=e.sc1,a=e.sc2,r=Object(s.useState)({}),o=Object(l.a)(r,2),i=o[0],u=o[1];return Object(s.useEffect)((function(){if(c&&a){var e=c.data.fValues,t=a.data.fValues;u({pref:e,nonPref:t})}}),[c,a]),Object(n.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(n.jsx)("div",{className:"s10 ",children:c&&Object(n.jsxs)("div",{className:"choice-container",children:[Object(n.jsx)("p",{children:c.data.scText}),Object(n.jsx)("img",{className:"swipe-img choice-container",src:c.data.scImg,alt:"Image not loaded"})]})}),c&&Object(n.jsx)("button",{value:"A",onClick:function(){t(i)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},h=function(e){var t=e.handleClick,c=e.sc2,a=e.sc1,r=Object(s.useState)({}),o=Object(l.a)(r,2),i=o[0],u=o[1];return Object(s.useEffect)((function(){if(a&&c){var e=a.data.fValues,t=c.data.fValues;u({pref:t,nonPref:e})}}),[a,c]),Object(n.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(n.jsx)("div",{className:"s10 ",children:c&&Object(n.jsxs)("div",{className:"choice-container",children:[Object(n.jsx)("p",{children:c.data.scText}),Object(n.jsx)("img",{className:"swipe-img choice-container",src:c.data.scImg,alt:"Image not loaded"})]})}),c&&Object(n.jsx)("button",{value:"B",onClick:function(){t(i)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},g=function(e){var t=e.handleClick,c=e.sc1,a=e.sc2,r=Object(s.useState)(0),o=Object(l.a)(r,2),i=o[0],u=o[1],f=Object(s.useState)(0),g=Object(l.a)(f,2),p=g[0],x=g[1],v={tabs:{background:"#fff"},label:{fontSize:"100%"}};return Object(n.jsxs)("div",{className:"swiper-container",children:[Object(n.jsx)(b.a,{position:"static",color:"default",children:Object(n.jsxs)(d.a,{indicatorColor:"primary",textColor:"primary",background:"primary",variant:"fullWidth",value:p,onChange:function(e,t){x(t),u(t)},style:v.tabs,children:[Object(n.jsx)(j.a,{style:v.label,label:"option n\xb01"}),Object(n.jsx)(j.a,{style:v.label,label:"option n\xb02"})]})}),Object(n.jsxs)(m.a,{enableMouseEvents:!0,index:i,onChangeIndex:function(e){u(e),x(e)},children:[Object(n.jsx)("div",{className:"slide",children:Object(n.jsx)("div",{className:"innerslide",children:Object(n.jsx)(O,{handleClick:t,sc1:c,sc2:a})})}),Object(n.jsx)("div",{className:"slide",children:Object(n.jsx)("div",{className:"innerslide",children:Object(n.jsx)(h,{handleClick:t,sc1:c,sc2:a})})})]})]})},p=function(e){var t=e.nrQuestions,c=e.sc1,s=e.sc2;return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{id:"introModal",className:"modal",children:Object(n.jsxs)("div",{className:"modal-content black-text modal-close center",children:[Object(n.jsx)("h4",{children:"Intro"}),Object(n.jsxs)("p",{className:"flow-text",children:["There are ",t," choices to make during this experiment. In each dilemma, choose one from the two options."]}),Object(n.jsxs)("p",{className:"flow-text",children:[Object(n.jsx)("i",{className:"material-icons danger red darken-2 btn-floating btn-sm",style:{color:"#ffff",fontSize:"140%",margin:"15px"},children:"help_outline"}),"shows additional explanation of each dilemma."]})]})}),Object(n.jsx)("div",{id:"modal1","data-id":"modal1",className:"modal",children:Object(n.jsx)("div",{className:"modal-content black-text modal-close center",children:Object(n.jsxs)("div",{className:"flow-text",children:[Object(n.jsx)("h4",{className:"mb-3",children:"Additional explanation:"}),Object(n.jsx)("h6",{children:Object(n.jsx)("u",{children:"Scenario 1:"})}),c&&Object(n.jsx)("p",{className:"flow-text",children:c.data.scExpl}),c&&0===c.data.scExpl.length&&Object(n.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(n.jsx)("h6",{children:Object(n.jsx)("u",{children:"Scenario 2:"})}),s&&Object(n.jsx)("p",{className:"flow-text",children:s.data.scExpl}),s&&0===s.data.scExpl.length&&Object(n.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(n.jsx)("button",{className:"btn btn-sm blue darken-2 waves-effect waves-light z-depth-2",children:"Close"})]})})})]})},x=function(e){var t=e.handleClick,c=(e.qIndex,e.sc1),s=e.sc2;return Object(n.jsxs)("div",{className:"pc-view",children:[Object(n.jsx)("h4",{children:"Make a choice between the 2 options"}),Object(n.jsxs)("div",{className:"pc-container",children:[Object(n.jsx)("div",{className:"option-container",children:Object(n.jsx)(O,{handleClick:t,sc1:c,sc2:s})}),Object(n.jsx)("div",{className:"option-container",children:Object(n.jsx)(h,{handleClick:t,sc2:s,sc1:c})})]})]})},v=c(14),N=function(){return Object(n.jsxs)("div",{className:"my-5",children:[Object(n.jsx)("p",{children:"Thank you for completing this experiment!"}),Object(n.jsxs)("p",{children:["Your contribution might actually trigger a chain of events that could eventually even save lives!!",Object(n.jsx)("br",{})]})]})},S=c(8),y=c.n(S),w=c(12),E=c(13),C=c(30);c(98),c(99),c(90);C.a.initializeApp({apiKey:"AIzaSyDkuqUfQCo8w_7OWogV44gsGLzaE-yEvX4",authDomain:"pem-firestore.firebaseapp.com",projectId:"pem-firestore",storageBucket:"pem-firestore.appspot.com",messagingSenderId:"528017814946",appId:"1:528017814946:web:f8fab7864531498a146efb"});C.a.storage();var J=C.a.firestore(),k=(C.a.firestore.FieldValue.serverTimestamp,C.a.firestore.FieldPath.documentId,C.a.auth()),F=new C.a.auth.GoogleAuthProvider,A=function(){k.signInWithPopup(F)},V=function(){var e=Object(E.a)(y.a.mark((function e(t,c){var n,s,a,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=J.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=16;break}return s=t.email,a=t.displayName,r=t.photoURL,e.prev=8,e.next=11,n.set(Object(w.a)({displayName:a,email:s,photoURL:r},c));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error creating user document",e.t0);case 16:return e.abrupt("return",D(t.uid));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,c){return e.apply(this,arguments)}}(),D=function(){var e=Object(E.a)(y.a.mark((function e(t){var c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,J.doc("users/".concat(t)).get();case 5:return c=e.sent,e.abrupt("return",Object(w.a)({uid:t},c.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),I=function(e,t){var c=Object(s.useState)([]),n=Object(l.a)(c,2),a=n[0],r=n[1];return Object(s.useEffect)((function(){var c=J.collection("users").doc(e).collection("DceList").doc(t).collection("Scenarios").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(w.a)(Object(w.a)({},e.data()),{},{id:e.id}))})),r(t)}));return function(){return c()}}),[]),{scenarios:a}};var L=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)(1),o=Object(l.a)(r,2),d=o[0],j=o[1],b=Object(s.useState)([Object(n.jsx)("span",{class:"dot blue darken-2"})]),f=Object(l.a)(b,2),m=f[0],O=f[1],h=Object(s.useState)([]),S=Object(l.a)(h,2),y=S[0],w=S[1],E=Object(s.useState)(null),C=Object(l.a)(E,2),k=C[0],F=C[1],A=Object(s.useState)(null),V=Object(l.a)(A,2),D=V[0],L=V[1],P=Object(s.useState)(null),R=Object(l.a)(P,2),B=R[0],G=R[1],T=Object(s.useState)(null),M=Object(l.a)(T,2),q=M[0],z=M[1],U=Object(s.useState)(0),_=Object(l.a)(U,2),Q=_[0],W=_[1],Y=Object(s.useState)(!1),H=Object(l.a)(Y,2),K=H[0],X=H[1],Z=Object(s.useState)(!1),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ce=Object(v.f)(),ne=ce.userId,se=ce.dceId,ae=I(ne,se).scenarios,re=Object(s.useRef)(!0),oe=function(e){console.log("result passed from Choices: "+JSON.stringify(e));var t=Object(i.a)(c);t.push(e),a(t),ie(K),d+1>Q&&te(!0),j(d+1),le()},ie=function(e){if(!e){var t=je(),c=t.ScenarioA,n=t.ScenarioB;F(c),L(n),console.log("not grouped: random scenario1: "+JSON.stringify(c)),console.log("not grouped: random scenario2: "+JSON.stringify(n))}if(e){var s=de(),a=s.ScenarioA,r=s.ScenarioB;F(a),L(r),console.log("grouped: random scenario1: "+JSON.stringify(a)),console.log("grouped: random scenario2: "+JSON.stringify(r))}},le=function(){console.log(m);var e=[];(e=Object(i.a)(m)).push(Object(n.jsx)("span",{class:"dot blue darken-2"})),O(e);var t=[];(t=Object(i.a)(y)).pop(),w(t)},ue=function(e){var t=[];null!=B&&(t=Object(i.a)(B));for(var c=-1,n=5*ae.length;n>0;n--){var s=Math.floor(Math.random()*e);if(console.log("tempRndA nr is: "+s),console.log("usedNrsA in for loop: "+JSON.stringify(t)),!t.includes(s)){c=s;break}}return-1!==c&&t.push(c),G(t),c},de=function(){var e=ae.length,t=ue(e),c=ae[t];if(c){console.log("randNrA: "+t+" scenarioA: "+JSON.stringify(c));var n=c.data.altnr;console.log("altnr from getGroupedSc: "+n);var s=ae.find((function(e){return e.data.nr===n}));return console.log("scenario B inside getGroupedscenarios: "+JSON.stringify(s)),{ScenarioA:c,ScenarioB:s}}return te(!0),{ScenarioA:"",ScenarioB:""}},je=function(){var e=function(){var e=[];null!=q&&(e=Object(i.a)(q));var t=ae.length,c=ue(t),n=-1;console.log("usedNrsB: "+JSON.stringify(e)),console.log("maxnr is: "+t);for(var s=10*ae.length;s>0;s--){var a=Math.floor(Math.random()*t);if(console.log("tempRndB nr is: "+a),console.log("usedNrsB in for loop: "+JSON.stringify(e)),c!==a){n=a;break}}return-1!==n&&e.push(n),z(e),{RandomNrA:c,RandomNrB:n}}(),t=e.RandomNrA,c=e.RandomNrB;return{ScenarioA:ae[t],ScenarioB:ae[c]}};return Object(s.useEffect)((function(){J.collection("users").doc(ne).collection("DceList").doc(se).get().then((function(e){console.log("dce nr questions: "+JSON.stringify(e.data().nrQuestions));var t=e.data().nrQuestions,c=e.data().grouped;W(t),X(c),function(e){for(var t=[],c=0;c<e-1;c++)t.push(Object(n.jsx)("span",{class:"dot"}));w(t)}(t),0!==ae.length&&ie(c)}))}),[ae]),Object(s.useEffect)((function(){if(console.log("initial render: "+re+" and intialRender.current: "+re.current),re.current)re.current=!1;else{console.log("dce is finished: save to db");var e=J.collection("users").doc(ne).collection("DceList").doc(se).collection("RawResults");c.map((function(t,c){e.add(t)}))}}),[ee]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(p,{nrQuestions:Q,sc1:k,sc2:D}),!ee&&Object(n.jsx)(g,{handleClick:oe,sc1:k,sc2:D}),!ee&&k&&Object(n.jsx)(x,{handleClick:oe,sc1:k,sc2:D}),ee&&Object(n.jsx)(N,{}),!ee&&Object(n.jsxs)("div",{children:[" ",c&&Object(n.jsxs)("p",{children:["Choicelist: ",JSON.stringify(c)]})]}),!ee&&Object(n.jsx)(u,{}),!ee&&Object(n.jsxs)("div",{className:"footer",children:[m,y]})]})},P=c(15),R=c(33),B=function(){var e=Object(s.useState)(""),t=Object(l.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)(""),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(s.useState)(null),j=Object(l.a)(d,2),b=j[0],f=j[1],m=function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c?a(n):"userPassword"===c&&u(n)};return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign In"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[null!==b&&Object(n.jsx)("div",{className:"text-danger mb-3",children:b}),Object(n.jsxs)("form",{className:"",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your email",id:"userEmail",onChange:function(e){return m(e)}}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsxs)("div",{className:"form-floating ",children:[Object(n.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:i,placeholder:"Your Password",id:"userPassword",onChange:function(e){return m(e)}}),Object(n.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){!function(e,t,c){e.preventDefault(),console.log("signing in w pw n email "+JSON.stringify(t)),k.signInWithEmailAndPassword(t,c).catch((function(e){f("Error signing in with password and email!"),console.error("Error signing in with password and email",e)}))}(e,c,i)},children:"Sign in"})]}),Object(n.jsx)("p",{className:"my-3",children:"or"}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){A()},children:"Sign in with Google"}),Object(n.jsxs)("p",{className:"my-3",children:["Don't have an account?"," ",Object(n.jsx)(R.a,{to:"signUp",className:"text-blue-500 hover:text-blue-600",children:"Sign up here"})," ",Object(n.jsx)("br",{})," ",Object(n.jsx)(R.a,{to:"passwordReset",className:"text-blue-500 hover:text-blue-600",children:"Forgot Password?"})]})]})]})},G=function(){var e=Object(s.useState)(""),t=Object(l.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)(""),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(s.useState)(""),j=Object(l.a)(d,2),b=j[0],f=j[1],m=Object(s.useState)(null),O=Object(l.a)(m,2),h=O[0],g=O[1],p=function(){var e=Object(E.a)(y.a.mark((function e(t,c,n){var s,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,k.createUserWithEmailAndPassword(c,n);case 4:s=e.sent,r=s.user,V(r,{displayName:b}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),g("Error Signing up with email and password");case 12:a(""),u(""),f("");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,c,n){return e.apply(this,arguments)}}(),x=function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c?a(n):"userPassword"===c?u(n):"displayName"===c&&f(n)};return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign Up"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[null!==h&&Object(n.jsx)("div",{className:"text-danger mb-3",children:h}),Object(n.jsxs)("form",{className:"",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"text",className:"form-control ",name:"displayName",value:b,placeholder:"Display name",id:"displayName",onChange:function(e){return x(e)}}),Object(n.jsx)("label",{htmlFor:"displayName",className:"block",children:"Display Name:"})]}),Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your Email",id:"userEmail",onChange:function(e){return x(e)}}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:i,placeholder:"Your Password",id:"userPassword",onChange:function(e){return x(e)}}),Object(n.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){p(e,c,i)},children:"Sign up"})]}),Object(n.jsx)("p",{className:"my-3",children:"or"}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){try{A()}catch(h){console.error("Error signing in with Google",h)}},children:"Sign In with Google"}),Object(n.jsxs)("p",{className:"my-3",children:["Already have an account?"," ",Object(n.jsx)(R.a,{to:"/",className:"text-blue-500 hover:text-blue-600",children:"Sign in here"})," "]})]})]})},T=c(52),M=c(35),q=c(54),z=c(53),U=Object(s.createContext)({user:null}),_=function(e){Object(q.a)(c,e);var t=Object(z.a)(c);function c(){var e;Object(T.a)(this,c);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).state={user:null},e.componentDidMount=Object(E.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:k.onAuthStateChanged(function(){var t=Object(E.a)(y.a.mark((function t(c){var n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V(c);case 2:n=t.sent,e.setState({user:n}),console.log("Logged in, user: "+JSON.stringify(n));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e}return Object(M.a)(c,[{key:"render",value:function(){var e=this.state.user;return Object(n.jsx)(U.Provider,{value:e,children:this.props.children})}}]),c}(s.Component),Q=function(){var e=Object(s.useState)(""),t=Object(l.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)(!1),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(s.useState)(null),j=Object(l.a)(d,2),b=j[0],f=j[1];return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-xl text-center font-bold mb-3",children:"Reset your Password"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[Object(n.jsxs)("form",{action:"",children:[i&&Object(n.jsx)("div",{className:"text-danger mb-3",children:"An email has been sent to you!"}),null!==b&&Object(n.jsx)("div",{className:"text-danger mb-3",children:b}),Object(n.jsxs)("div",{class:"form-floating",children:[Object(n.jsx)("input",{type:"email",name:"userEmail",id:"userEmail",value:c,placeholder:"Input your email",onChange:function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c&&a(n)},className:"form-control"}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info my-3",onClick:function(e){!function(e){e.preventDefault(),k.sendPasswordResetEmail(c).then((function(){u(!0),setTimeout((function(){u(!1)}),3e3)})).catch((function(){f("Error resetting password")}))}(e)},children:"Send me a reset link"})]}),Object(n.jsx)(R.a,{to:"/",className:"my-2 text-blue-700 hover:text-blue-800 text-center block",children:"\u2190 back to sign in page"})]})]})};var W=function(e,t){var c=Object(s.useState)([]),n=Object(l.a)(c,2),a=n[0],r=n[1];return Object(s.useEffect)((function(){if(t){console.log("user en dce id in loadResults: "+e+" "+t);var c=J.collection("users").doc(e).collection("DceList").doc(t).collection("RawResults").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(w.a)(Object(w.a)({},e.data().pref),{},{id:e.id}))})),r(t)}));return function(){return c()}}}),[t]),{results:a}};function Y(e){var t=e.dceId,c=e.dceNameEdit,a=e.dceDetails,r=e.dceFeatures,o=e.user,u=Object(s.useState)([]),d=Object(l.a)(u,2),j=d[0],b=d[1],f=Object(s.useState)([]),m=Object(l.a)(f,2),O=(m[0],m[1],Object(s.useState)([])),h=Object(l.a)(O,2),g=h[0],p=h[1],x=(Object(v.e)(),o.uid);console.log("user and dce id in ResultDce: "+JSON.stringify(o.uid)+" "+t),console.log("dceDetails in ResultDce start: "+JSON.stringify(a));var N=W(x,t).results,S=Object(s.useState)(null),y=Object(l.a)(S,2),w=y[0],E=(y[1],a.details);Object(s.useEffect)((function(){if(t&&E){console.log("DceId in useEffect: "+t);var e=[];J.collection("users").doc(x).collection("DceList").doc(t).collection("AspectList").get().then((function(c){c.forEach((function(c){console.log("Aspects just loaded, in docs.forEach, doc: "+JSON.stringify(c.data())),e.push({aspectName:c.data().aspectName,id:c.id}),J.collection("users").doc(x).collection("DceList").doc(t).collection("AspectList").doc(c.id).collection("Combis").get().then((function(t){console.log("tempAspectObjs at start: "+JSON.stringify(e));var n=[];t.forEach((function(e){console.log("doc.is is: "+c.id);var t=e.data(),s=[],a=[];s.push.apply(s,Object(i.a)(t.filters)),a.push.apply(a,Object(i.a)(t.filters)),console.log("favorFilters is : "+JSON.stringify(s));var o={fName:E.groupFeature,fValue:e.data().groupValue};s.push(o);var l="";r.map((function(t,c){console.log("Feature: "+JSON.stringify(t.featureName)),t.featureName===E.groupFeature&&(console.log("Group feat ===featureName"),t.featureValue1===e.data().groupValue&&(l=t.featureValue2),t.featureValue2===e.data().groupValue&&(l=t.featureValue1))}));var u={fName:E.groupFeature,fValue:l};a.push(u),console.log("tempFilter: "+JSON.stringify(t)),t.favorFilters=s,t.againstFilters=a,console.log("tempFilter: "+JSON.stringify(t)),console.log("groupFeature: "+E.groupFeature+" favorFilters: "+JSON.stringify(s)+"  againstFilters: "+JSON.stringify(a)),n.push(t),console.log("Combis in snap: "+JSON.stringify(n)+JSON.stringify(c.id))})),console.log("doc.is is: "+c.id);var s=[].concat(e),a=e.findIndex((function(e){return e.id===c.id}));console.log("index2: "+JSON.stringify(a)),s[a].combis=n,console.log("ind: "+w),console.log("newtempObjs before setting: "+JSON.stringify(s)),p(s)}))}))}))}else;}),[t]),Object(s.useEffect)((function(){var e=[];console.log("all aspectObj is: "+JSON.stringify(g)),g.forEach((function(t){var c=t.aspectName,s=[],a=[];console.log("aspectObj is: "+JSON.stringify(t)),t.combis&&(console.log("combi if entered"),t.combis.forEach((function(e){console.log("combi: "+JSON.stringify(e));e.nr;N.filter((function(t){var c=!0;return e.favorFilters.forEach((function(e){console.log("forEach favFilter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){console.log(" forEach favor "+JSON.stringify(e)),-1===s.indexOf(e)&&s.push(e)}));N.filter((function(t){var c=!0;return e.againstFilters.forEach((function(e){console.log("forEach againstFilter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){console.log(" forEach against "+JSON.stringify(e)),-1===a.indexOf(e)&&a.push(e),console.log("oddsAgainst: "+JSON.stringify(a))}))})));var r=1;a.length>0&&(r=s.length/a.length);C(r);var o=s.length/(s.length+a.length)*2-1,i=Math.abs(50*o),l=k(o),u=F(o);console.log("oddsFavor: "+JSON.stringify(s)),e.push(Object(n.jsxs)("div",{children:["Aspect: ",c," ",Object(n.jsx)("br",{}),Object(n.jsxs)("div",{className:l,children:[Object(n.jsx)("div",{className:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"}),0===o&&Object(n.jsx)("div",{class:"progress-bar bg-teal",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"}),Object(n.jsx)("div",{className:u,role:"progressbar","aria-valuenow":o,"aria-valuemin":"0","aria-valuemax":"100",style:{width:i+"%"},children:(o>=.1||o<=-.1)&&Object(n.jsxs)("span",{className:"sr-only",children:["\u0394 P = ",o.toFixed(2)]})})]}),o<.1&&o>-.1&&Object(n.jsxs)("div",{children:["\u0394 P = ",o.toFixed(2)]})]})),console.log("resultHtml: "+JSON.stringify(e)),b(e)}))}),[g]);var C=function(e){return 1/(1+Math.pow(Math.E,-e))},k=function(e){var t="progress w-80 mx-auto";return e<0&&(t="progress w-80 mx-auto flex-row-reverse"),console.log("clNames: "+t),t},F=function(e){var t="progress-bar bg-teal progress-bar-striped";return e<0&&(t="progress-bar bg-purple progress-bar-striped"),t};return Object(n.jsxs)("div",{children:[Object(n.jsxs)("h4",{children:["Results for: ",c]}),Object(n.jsx)("div",{className:"mb-3",children:" \u0394 P shows the difference in probability that the aspect is true and the probability that the aspect is not true"}),j,Object(n.jsxs)("div",{class:"progress w-80 mx-auto flex-row-reverse",children:[Object(n.jsx)("div",{class:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"}),Object(n.jsx)("div",{class:"progress-bar bg-success",role:"progressbar",style:{width:"10%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100",children:Object(n.jsx)("span",{className:"sr-only",children:"\u0394P = -0.08"})}),Object(n.jsx)("div",{class:"progress-bar bg-danger",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"})]})]})}function H(){var e=Object(s.useContext)(U),t=Object(s.useState)(e),c=Object(l.a)(t,2),a=c[0],r=c[1];Object(s.useEffect)((function(){r(k.currentUser)}));var o=Object(s.useState)([]),i=Object(l.a)(o,2),u=i[0],d=i[1],j=Object(s.useState)(!1),b=Object(l.a)(j,2),f=(b[0],b[1],Object(s.useState)("(Click on EDIT in DCE list)")),m=Object(l.a)(f,2),O=m[0],h=m[1],g=Object(s.useState)([]),p=Object(l.a)(g,2),x=p[0],N=p[1],S=Object(s.useState)(""),C=Object(l.a)(S,2),F=C[0],A=C[1],V=Object(s.useState)([]),D=Object(l.a)(V,2),I=(D[0],D[1]),L=Object(s.useState)([]),R=Object(l.a)(L,2),B=R[0],G=R[1];console.log("Params at start dces "+JSON.stringify(Object(v.f)()));var T=a.uid;console.log("user uid in dces is: "+JSON.stringify(a.uid));var M=function(){var e=Object(E.a)(y.a.mark((function e(){var t,c,n,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=J.collection("users").doc(T).collection("DceList"),e.next=3,t.get();case 3:c=e.sent,n=[],s=[],c.docs.forEach((function(e){n.push(Object(w.a)(Object(w.a)({},e.data()),{},{id:e.id})),s.push(e.data().name.dceName)})),d(n),I(s);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){M(),console.log("user uid in dces is: "+JSON.stringify(a.uid))}),[a]);var q=function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");J.collection("users").doc(T).collection("DceList").doc(t).get().then((function(e){var c=e.data().name.dceName,n={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};h(c),G(n),N(e.data().features),A(t),console.log("dceDetails onCreate: "+JSON.stringify(n))}))};return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"DCE list"})}),Object(n.jsx)("ul",{children:u&&u.map((function(e,t){return Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(n.jsx)("b",{children:e.name.dceName}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)(P.b,{to:{pathname:"/app/"+T+"/"+e.id},children:Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(n.jsx)("i",{class:"material-icons mat-icon mt-1",children:"play_circle_outline"})})}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",onClick:q,children:Object(n.jsx)("i",{class:"material-icons mat-icon mt-1",children:"poll"})})]})})},t)}))})]}),Object(n.jsx)("div",{className:"row my-4",children:Object(n.jsx)("div",{className:"col-auto  ",children:Object(n.jsx)("div",{})})})]}),Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(Y,{dceDetails:B,dceNameEdit:O,dceId:F,dceFeatures:x,user:a})})]})})}var K=function(){return Object(s.useContext)(U),Object(n.jsxs)(P.a,{children:[Object(n.jsx)(v.a,{path:"signUp",exact:!0,component:function(){return Object(n.jsx)(G,{})}}),Object(n.jsx)(v.a,{path:"/",exact:!0,component:function(){return Object(n.jsx)(B,{})}}),Object(n.jsx)(v.a,{path:"passwordReset",exact:!0,component:function(){return Object(n.jsx)(Q,{})}})]})};var X=function(){return Object(n.jsx)(_,{children:Object(n.jsx)(K,{})})};var Z=Object(v.g)((function(e){var t=Object(s.useContext)(U),c=Object(s.useState)(t),a=Object(l.a)(c,2),r=a[0],o=a[1];return Object(s.useEffect)((function(){o(k.currentUser)})),Object(n.jsx)("div",{className:"navigation",children:Object(n.jsx)("nav",{class:"navbar navbar-expand navbar-dark bg-dark",children:Object(n.jsxs)("div",{class:"container",children:[Object(n.jsx)(P.b,{class:"navbar-brand",to:"/",children:"PEM"}),Object(n.jsx)("div",{children:Object(n.jsxs)("ul",{class:"navbar-nav ml-auto",children:[Object(n.jsx)("li",{class:"nav-item  ".concat("/"===e.location.pathname?"active":""),children:Object(n.jsx)(P.b,{class:"nav-link",to:"/",children:"Develop"})}),Object(n.jsx)("li",{class:"nav-item  ".concat("/dces"===e.location.pathname?"active":""),children:Object(n.jsx)(P.b,{class:"nav-link",to:"/dces",children:"DCE's"})}),Object(n.jsx)("li",{class:"nav-item  ".concat("/results"===e.location.pathname?"active":""),children:Object(n.jsx)(P.b,{class:"nav-link",to:"/results",children:"Results"})}),r&&console.log("user in signout btn is: "+JSON.stringify(r.displayName)),r&&Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)("a",{className:"nav-link",onClick:function(){k.signOut()},children:"Sign out"})})]})})]})})})}));var $=function(){return Object(n.jsx)(_,{children:Object(n.jsx)(K,{})})};function ee(e){var t=e.aspectNameEdit,c=e.aspectFilters,a=e.saveFilters,r=e.chosenFeatures,o=e.setChosenFeatures,u=e.handleAddCombi,d=e.handleDeleteCombi,j=e.aspectsObjs,b=e.groupValues,f=e.setGroupValues,m=Object(s.useState)(1),O=Object(l.a)(m,2),h=(O[0],O[1],Object(s.useState)(null)),g=Object(l.a)(h,2),p=g[0],x=g[1],N=Object(s.useState)(null),S=Object(l.a)(N,2),y=S[0],w=S[1],E=Object(s.useState)([]),C=Object(l.a)(E,2),J=C[0],k=C[1],F=Object(s.useState)([]),A=Object(l.a)(F,2),V=A[0],D=A[1],I=Object(s.useState)([]),L=Object(l.a)(I,2),P=L[0],R=L[1],B=Object(v.f)(),G=B.userId,T=B.dceId,M=Object(v.e)(),q=M.dceFeatures,z=M.groupFeature,U=W(G,T).results;console.log("props from location: "+JSON.stringify(M)),console.log("aspectNameEdit: "+JSON.stringify(t)),console.log("aspecteFilters: "+JSON.stringify(c)),Object(s.useEffect)((function(){var e=[];j.forEach((function(t){var c=t.aspectName,s=[];console.log("aspectObj: "+JSON.stringify(t));var a=t.combis.nr;t.combis.filters.forEach((function(e){U.filter((function(t){return console.log("forEach filter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)})).forEach((function(e){-1===s.indexOf(e)&&s.push(e)}))})),console.log("oddsFavor: "+JSON.stringify(s)),e.push(Object(n.jsxs)("div",{children:["Aspect: ",c,"Nr: ",a,"Length: ",s.length,JSON.stringify(s)]})),console.log("resultHtml: "+JSON.stringify(e)),R(e)}))}),[j]);var _=function(e){e.preventDefault(),x(null),console.log("SetFormValue null");var t=e.target,n=t.value,s=(t.id,e.target.dataset.id);console.log("handleChosen triggered, target:"+JSON.stringify(e.target.dataset)),console.log("value is: "+JSON.stringify(n)),console.log("chosenFeatures before copy: "+JSON.stringify(r)),console.log("aspectFilter before copy: "+JSON.stringify(c));var a=Object(i.a)(r);a[s][0]={fName:n},console.log("chosenList: "+JSON.stringify(a)),o(a)},Q=function(e){e.preventDefault(),x(null),w(null);var t=e.target,c=t.value,n=(t.id,e.target.dataset.id);console.log("handleFValue triggered, cIndex = "+n);var s=Object(i.a)(r);console.log("chosenList: "+JSON.stringify(s)),s[n][0].fValue=c,console.log("chosenList: "+JSON.stringify(s)),o(s)},Y=function(e){e.preventDefault();var t=e.target,c=t.value,n=(t.id,e.target.dataset.id),s=Object(i.a)(b);s[n]=c,f(s),console.log("handleGroup value: "+c),console.log("Group values: "+JSON.stringify(s))},H=function(e){e.preventDefault();var t=e.target.dataset.id;console.log("handleSave data-id: "+JSON.stringify(e.target.dataset.id)),console.log("chosenFeatures at start of handleSave: "+JSON.stringify(r)),console.log("chosenFeatues[cIndex] at start of handleSave: "+JSON.stringify(r[t]));var n=[].concat(Object(i.a)(c[t]),Object(i.a)(r[t])),s=Object(i.a)(r);s[t]=[],console.log("group values: "+JSON.stringify(b)),0===b[t].length?alert("Select a value for the Group feature before saving"):(a(t,n,s,b),console.log("tempList in save: "+JSON.stringify(n)),console.log("tempChosen in save: "+JSON.stringify(s)),x(""),console.log("SetFormValue blanc"),w(""))};Object(s.useEffect)((function(){console.log("chosenFeatures in useEffect: "+JSON.stringify(r)),console.log("aspectFilters in useEffect: "+JSON.stringify(c)),x(""),w("");var e=[];c.map((function(t,s){e.push(Object(n.jsxs)("div",{children:[" ",0!==s&&Object(n.jsxs)("h5",{className:"my-5",children:[Object(n.jsxs)("button",{onClick:function(e){return d(e,s)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(n.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]}),"combined with:"]}),Object(n.jsxs)("h5",{children:["Select value for group feature - ",z]}),Object(n.jsxs)("label",{htmlFor:"groupVal",children:["Group value",console.log("dceFeatures and groupFeature in select: "+JSON.stringify(q)+JSON.stringify(z)),console.log("groupValues: "+JSON.stringify(b)),Object(n.jsxs)("select",{name:"groupVal",id:"",className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:b[s],"data-id":s,onChange:Y,children:[Object(n.jsx)("option",{value:"",disabled:!0}),q&&Object(n.jsx)("option",{value:q.find((function(e){return e.featureName===z})).featureValue1,children:q.find((function(e){return e.featureName===z})).featureValue1}),q&&Object(n.jsx)("option",{value:q.find((function(e){return e.featureName===z})).featureValue2,children:q.find((function(e){return e.featureName===z})).featureValue2})]})]}),Object(n.jsx)("h5",{children:"Saved features and values"})]})),t.map((function(t,r){console.log("filter is: "+JSON.stringify(t)),e.push(Object(n.jsxs)("div",{className:"my-3",children:[Object(n.jsx)("div",{className:"savedFeatures my-2 mx-3 px-5 py-1 p-3 border rounded",children:t.fName}),Object(n.jsx)("span",{className:"savedFeatures mx-3 px-5 py-1 border rounded",children:t.fValue}),Object(n.jsx)("span",{children:Object(n.jsxs)("button",{onClick:function(e){return function(e,t,n){e.preventDefault();var s=n.toString();console.log("delete filter with id "+t),console.log("delete filter with cIndex "+s);var r=Object(i.a)(c[s]);console.log("tempFilters voor splice: "+JSON.stringify(r));var o=[];c.map((function(e){o.push([])})),r.splice(t,1),console.log("tempFilters na splice: "+JSON.stringify(r)),console.log("emptyChosen na splice: "+JSON.stringify(o)),a(s,r,o,b)}(e,r,s)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(n.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]})})]}))})),e.push(Object(n.jsxs)("div",{children:[Object(n.jsxs)("span",{children:[Object(n.jsxs)("form",{children:[console.log("groupFeature: "+z),console.log("dceFeatures: "+JSON.stringify(q)),Object(n.jsxs)("label",{htmlFor:"fNames",className:"col-md-3 col-form-label",children:["Add filter feature",Object(n.jsx)("select",{className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:p,"data-id":s,id:0,onChange:_,children:q&&q.map((function(e,t){console.log("ind is: "+t);var c=e.featureName,s="";return e.featureName===z&&(c="",s="disabled"),Object(n.jsxs)("option",{value:c,disabled:s,children:[c," "]})}))})]})]}),q&&Object(n.jsx)("form",{children:Object(n.jsxs)("label",{htmlFor:"fValue",children:["Filter value",Object(n.jsxs)("select",{name:"fValue",id:"",className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:y,"data-id":s,onChange:Q,children:[Object(n.jsx)("option",{value:"",disabled:!0}),console.log("chosenFeatures: "+JSON.stringify(r)),r[s]&&console.log("chosenFeatures[cIndex][0]: "+JSON.stringify(r[s])),r[s][0]&&Object(n.jsx)("option",{value:q.find((function(e){return e.featureName===r[s][0].fName})).featureValue1,children:q.find((function(e){return e.featureName===r[s][0].fName})).featureValue1}),r[s][0]&&Object(n.jsx)("option",{value:q.find((function(e){return e.featureName===r[s][0].fName})).featureValue2,children:q.find((function(e){return e.featureName===r[s][0].fName})).featureValue2})]})]})})]}),Object(n.jsx)("button",{"data-id":s,className:"btn btn-sm btn-outline-info mb-3",onClick:H,children:"save filter feature and group value"})]}))})),D(e)}),[r,b]),Object(s.useEffect)((function(){console.log("Rerender choose html"),console.log("chosenFeatures in choose html: "+JSON.stringify(r)),w("");var e=[];"(Click on EDIT in Aspect list)"!==t&&e.push(Object(n.jsxs)("div",{children:[Object(n.jsx)("form",{children:Object(n.jsxs)("label",{htmlFor:"fNames",className:"col-md-3 col-form-label",children:["Add filter feature",Object(n.jsxs)("select",{className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:p,"data-id":0,id:r.length-1,onChange:_,children:[Object(n.jsx)("option",{value:"",disabled:!0}),q&&q.map((function(e,t){return console.log("ind is: "+t),Object(n.jsxs)("option",{value:e.featureName,children:[e.featureName," "]})}))]})]})}),q&&Object(n.jsx)("form",{children:Object(n.jsxs)("label",{htmlFor:"fValue",children:["Filter value",Object(n.jsxs)("select",{name:"fValue",id:"",className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:y,"data-id":0,onChange:Q,children:[Object(n.jsx)("option",{value:"",disabled:!0}),console.log("i="+r.length-1),console.log("chosenFeatures: "+JSON.stringify(r)),r[0][0]&&Object(n.jsx)("option",{value:q.find((function(e){return e.featureName===r[0][0].fName})).featureValue1,children:q.find((function(e){return e.featureName===r[0][0].fName})).featureValue1}),r[0][0]&&Object(n.jsx)("option",{value:q.find((function(e){return e.featureName===r[0][0].fName})).featureValue2,children:q.find((function(e){return e.featureName===r[0][0].fName})).featureValue2})]})]})}),Object(n.jsx)("button",{"data-id":"0",className:"btn btn-sm btn-outline-info mb-3",onClick:H,children:"save filter feature"})]})),k(e)}),[r]);var K=[];return"(Click on EDIT in Aspect list)"!==t&&K.push(Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:u,children:"add combination feature"})),Object(n.jsxs)("div",{children:[Object(n.jsxs)("h4",{children:["Define aspect for ",t]}),"Results: ",JSON.stringify(U),"filter results: ",P,"dceFeatures: ",q&&JSON.stringify(q),V,0===V.length&&J,function(){},V.length>2&&K]})}function te(e){var t=e.showAspectList,c=e.showNewAspectForm,a=e.aspectNameList,r=Object(s.useState)([{featureName:null,featureValue1:null,featureValue2:null}]),o=Object(l.a)(r,2),u=(o[0],o[1],Object(s.useState)(["name"])),d=Object(l.a)(u,2),j=d[0],b=d[1],f=Object(v.f)(),m=f.userId,O=f.dceId,h=(Object(s.useContext)(U).uid,function(e){return j[0].aspectName===e});return Object(n.jsx)("div",{children:Object(n.jsxs)("form",{className:"form-inline",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"text",className:"form-control",name:"aspectName",placeholder:"Aspect name",id:"aspectName",required:!0,onChange:function(e){var t=e.target.value,c=Object(i.a)(j);c[0]=t,b(c)}}),Object(n.jsx)("label",{htmlFor:"aspectName",className:"block",children:"Name: "})]}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){if(e.preventDefault(),""!==j[0].aspectName&&!a.some(h)||(alert("Fill in a unique aspect name"),0)){var n=J.collection("users").doc(m).collection("DceList").doc(O).collection("AspectList");n.add({aspectName:j[0]}).then((function(e){console.log("Document written with ID: ",e.id),n.doc(e.id).collection("Combis").doc("0").set({nr:0,groupValue:"",filters:[]})})).catch((function(e){console.error("Error adding document: ",e)})),t(),c()}},children:"Save aspect"})]})})}function ce(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),c=t[0],a=t[1],r=Object(s.useState)([]),o=Object(l.a)(r,2),u=o[0],d=o[1],j=Object(s.useState)([]),b=Object(l.a)(j,2),f=b[0],m=b[1],O=Object(s.useState)([]),h=Object(l.a)(O,2),g=h[0],p=h[1],x=Object(s.useState)([]),N=Object(l.a)(x,2),S=N[0],C=N[1],k=Object(s.useState)(!1),F=Object(l.a)(k,2),A=F[0],V=F[1],D=Object(s.useState)("(Click on EDIT in Aspect list)"),I=Object(l.a)(D,2),L=I[0],P=I[1],R=Object(s.useState)([]),B=Object(l.a)(R,2),G=(B[0],B[1],Object(s.useState)("")),T=Object(l.a)(G,2),M=T[0],q=T[1],z=Object(s.useState)([]),_=Object(l.a)(z,2),Q=_[0],W=(_[1],Object(s.useState)(null)),Y=Object(l.a)(W,2),H=(Y[0],Y[1],Object(s.useContext)(U)),K=(H.uid,Object(v.f)()),X=K.userId,Z=K.dceId,$=Object(v.e)().dceNameEdit;console.log("location data in aspectList: "+JSON.stringify(Object(v.e)())),console.log("user uid in dcelist is: "+JSON.stringify(H.uid));var ce=function(){var e=Object(E.a)(y.a.mark((function e(){var t,c,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList"),e.next=3,t.get();case 3:c=e.sent,n=[],c.docs.forEach((function(e){n.push(Object(w.a)(Object(w.a)({},e.data()),{},{id:e.id}))})),console.log("Aspects data: "+JSON.stringify(n)),a(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){ce()}),[]);var ne=function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),se(t)},se=function(e){var t=[],c=J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(e);c.get().then((function(n){var s=n.data().aspectName;console.log("docData: "+JSON.stringify(n.data()));var a=[],r=[],o=[];c.collection("Combis").get().then((function(e){e.docs.forEach((function(e){console.log("snap: "+JSON.stringify(e.data().filters)),a.push(e.data().filters),r.push({aspectName:s,combis:{nr:e.data().nr,groupValue:e.data().groupValue,filters:e.data().filters}}),t.push([]),o.push(e.data().groupValue)})),console.log("objCombis: "+JSON.stringify(r)),console.log("emptyChosen: "+JSON.stringify(t)),console.log("tempGValues: "+JSON.stringify(o)),C(o),d(r),p(a),m(t)})),P(s),q(e)}))},ae=function(){var e=Object(E.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(M).collection("Combis").orderBy("nr","asc").get().then((function(e){console.log("data in handleAddCombi: "+JSON.stringify(e.docs));for(var t=0,c=0;c<e.docs.length;c++){if(e.docs[c].data().nr!==t)return console.log("doc nr !== seqNr, seqNr is: "+t+"doc id is: "+e.docs[c].data().nr),void re(t);console.log("doc nr == seqNr, seqNr is: "+t+"doc id is: "+e.docs[c].data().nr),t+=1,c===e.docs.length-1&&(console.log("Last doc, i===length"),re(t))}}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(e){J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(M).collection("Combis").doc(e.toString()).set({nr:e,groupValue:"",filters:[]}).then((function(){console.log("combi added"),se(M)})).catch((function(e){console.log("Error adding combi",e)}))},oe=function(e){var t;t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");var c=J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(t);c.collection("Combis").get().then((function(e){e.forEach((function(e){c.collection("Combis").doc(e.id).delete().then((function(){console.log("Combi with ID "+e.id+" deleted")}))}))})).then((function(){console.log("Combis deleted"),c.delete().then((function(){console.log("Documentwith ID"+t+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),t===M&&(q(""),P("(Click on EDIT in Aspect list)"),p([]),m([])),ce()}))},ie=function(){A?V(!1):A||V(!0)};return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsxs)("u",{children:["Aspect list for ",$]})}),Object(n.jsx)("ul",{children:c&&c.map((function(e,t){return Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(n.jsx)("b",{children:e.aspectName}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-warning",onClick:ne,children:Object(n.jsx)("i",{class:"material-icons mat-icon",children:"edit"})}),Object(n.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:oe,children:Object(n.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})})]})})},t)}))})]}),Object(n.jsx)("div",{className:"row my-4",children:Object(n.jsxs)("div",{className:"col-auto  ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Create new Aspect"})}),Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:ie,children:" new Aspect"})]}),A&&Object(n.jsx)(te,{dceId:Z,showAspectList:ce,showNewAspectForm:ie,aspectNameList:Q})]})})]}),Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(ee,{aspectNameEdit:L,aspectFilters:g,saveFilters:function(e,t,c,n){console.log("params: userId: "+X+" dceId: "+Z+" aspectId: "+M+" cIndex: "+e),console.log("cINdex: "+e+"filters: "+JSON.stringify(t)+" emptyChosen: "+JSON.stringify(c)),J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(M).collection("Combis").doc(e).update({filters:t,groupValue:n[e]}).then((function(){var n=Object(i.a)(g);n[e]=t,p(n),m(c),console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))},chosenFeatures:f,setChosenFeatures:m,handleAddCombi:ae,handleDeleteCombi:function(e,t){J.collection("users").doc(X).collection("DceList").doc(Z).collection("AspectList").doc(M).collection("Combis").doc(t.toString()).delete().then((function(){console.log("Combination successfully deleted!"),se(M)})).catch((function(e){console.error("Error removing document: ",e)}))},aspectsObjs:u,groupValues:S,setGroupValues:C})})]})})}var ne=function(){return Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)(P.a,{children:[Object(n.jsx)(Z,{}),Object(n.jsx)(v.a,{path:"/",exact:!0,component:function(){return Object(n.jsx)(X,{})}}),Object(n.jsx)(v.a,{path:"/dces",exact:!0,component:function(){return Object(n.jsx)($,{})}}),Object(n.jsx)(v.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(n.jsx)(L,{})}}),Object(n.jsx)(v.a,{path:"/aspectList/:userId/:dceId",exact:!0,component:function(){return Object(n.jsx)(ce,{})}}),Object(n.jsx)(v.a,{path:"/results",exact:!0,component:function(){return Object(n.jsx)(H,{})}})]})})};o.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(ne,{})}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.441b36e5.chunk.js.map