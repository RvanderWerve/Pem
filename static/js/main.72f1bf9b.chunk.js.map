{"version":3,"sources":["firebase/config.js","providers/UserProvider.jsx","comps/view/main/Nav.js","img/pem50.png","comps/view/participantApp/Fab.js","comps/view/participantApp/Option.js","comps/view/participantApp/MenuTabs.js","comps/view/participantApp/Modals.js","comps/view/participantApp/PcView.js","comps/view/participantApp/StartForm.js","firebase/useFirestoreScenarios.js","comps/controller/useSetAspectObjs.js","comps/view/useGetResultHtml.js","firebase/useFirestoreLoadResults.js","comps/view/ResultDce.js","comps/view/participantApp/ParticipantResults.js","comps/controller/participantApp/DotFunctions.js","comps/controller/participantApp/ScenarioFunctions.js","comps/model/dce.js","comps/model/groupedDce.js","comps/controller/participantApp/App.js","comps/controller/participantApp/useGetGroupedScenarios.js","comps/controller/participantApp/useSaveResult.js","comps/view/main/SignIn.js","comps/view/main/SignUp.js","comps/view/main/PasswordReset.js","firebase/useStorage.js","comps/view/ProgressBar.js","comps/controller/UploadForm.js","comps/view/useScenarioDetailsHtml.js","comps/controller/ScenarioDetails.js","comps/model/scenario.js","comps/controller/ScenarioListPage.js","comps/controller/NewAspect.js","comps/view/List.js","comps/model/ageGender.js","comps/model/combi.js","comps/model/aspect.js","comps/model/filter.js","comps/view/AspectEditPage.js","comps/view/useAspectEditHtml.js","comps/controller/AspectListPage.js","comps/model/useGetDceList.js","comps/view/useNewDceHtml.js","comps/controller/NewDceForm.js","comps/view/DceListPage.js","comps/view/DcePlayListPage.js","comps/model/dceList.js","comps/view/main/Application.js","comps/view/main/MainApp.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","pemStorage","storage","pemFirestore","firestore","pemAuth","FieldValue","serverTimestamp","FieldPath","documentId","auth","provider","GoogleAuthProvider","signInWithGoogle","signInWithPopup","generateUserDocument","user","additionalData","a","userRef","doc","uid","get","exists","email","displayName","photoURL","set","console","error","getUserDocument","userDocument","data","UserContext","createContext","UserProvider","state","componentDidMount","onAuthStateChanged","userAuth","setState","log","this","Provider","value","props","children","Component","withRouter","useContext","useEffect","className","to","src","width","height","alt","location","pathname","onClick","signOut","Fab","href","style","fontSize","Option","handleClick","sc1","sc2","shownSc","ageGender","useState","choiceValue","setChoiceValue","fValues1","fValues","fValues2","cValue","pref","nonPref","scText","scImg","MenuTabs","dceDescr","index","setIndex","setValue","styles","tabs","background","label","AppBar","position","color","Tabs","indicatorColor","textColor","variant","onChange","event","newValue","Tab","enableMouseEvents","onChangeIndex","Modals","id","data-id","scExpl","length","PcView","StartForm","nrQuestions","setStarted","setQNr","handleAGChoice","htmlFor","options","name","option","useFirestoreScenarios","dceId","scenarios","setScenarios","unsub","collection","onSnapshot","snap","documents","forEach","push","JSON","stringify","useSetAspectObjs","userId","currentDce","aspectObjs","setAspectObjs","dceFeatures","features","tempAspectObjs","then","querySnapshot","aspectName","aspectDescr","snapshot","tempFilters","tempFilter","favorFilters","againstFilters","filterList","newFavorFilter","fName","groupFeature","fValue","groupValue","age","ageFilter","gender","genderFilter","newAgainstValue","feature","i","featureName","featureValue1","featureValue2","newAgainstFilter","newTempObjs","findIndex","obj","catch","err","useGetResultHtml","results","resultHtml","setResultHtml","tempResult","aspectObj","oddsFavor","oddsAgainst","combis","combi","filter","result","passesAllFilters","favFilter","hasOwnProperty","favor","indexOf","againstFilter","against","prob","graphProb","Math","abs","clNames","graphReverse","barClasses","getBarClasses","role","aria-valuenow","aria-valuemin","aria-valuemax","toFixed","tempClNames","useFirestoreLoadResult","setResults","ResultDce","nrParticipants","ceil","ParticipantResults","resultList","grouped","getRndNrList","maxNr","usedNrs","nrList","j","randNr","tempRandNr","floor","random","includes","Dce","descr","scList","aspectList","GroupedDce","App","answerList","setAnswerList","setResultList","setAgeGender","done","setDone","todo","setTodo","setSc1","setSc2","qNr","setCurrentDce","setNrQuestions","isGrouped","setIsGrouped","setDceDescr","setDceFeatures","dceDetails","setDceDetails","dceNameEdit","setDceNameEdit","finished","setFinished","started","setError","useParams","scenarioListA","setScenarioListA","scenarioListB","setScenarioListB","randNrList","scListA","nr","scListB","scA","find","altnr","useGetGroupedScenarios","M","AutoInit","tempListA","dones","todos","pop","calcDots","fValuesArray","map","sc","arrayValues","Object","values","containsEmpty","dce","tempGrouped","tempDetails","details","dot","setDots","initialRender","useRef","current","collRef","tempResultList","answer","add","useSaveResult","tempAgeGender","SignIn","setEmail","password","setPassword","onChangeHandler","currentTarget","type","placeholder","preventDefault","signInWithEmailAndPassword","signInWithEmailAndPasswordHandler","SignUp","setDisplayName","createUserWithEmailAndPasswordHandler","createUserWithEmailAndPassword","PasswordReset","emailHasBeenSent","setEmailHasBeenSent","action","class","sendPasswordResetEmail","setTimeout","sendResetEmail","useStorage","file","progress","setProgress","url","setUrl","storageRef","ref","put","on","percentage","bytesTransferred","totalBytes","getDownloadURL","ProgressBar","setFile","scNr","creatUrl","useCallback","UploadForm","types","e","selected","target","files","useScenarioDetailsHtml","currentSc","setCurrentSc","setIsSaved","isSaved","handleChosen","handleSave","handleCreateAlt","handleEntry","scenarioHtml","setScenarioHtml","tempSc","keys","tempHtml","defaultValue","isDisabled","altSc","ScenarioDetails","handleAddScenario","getAltFValues","fValueList","newFeatValue","groupFeat","groupFeatValue","altFValueList","fieldsComplete","featuresComplete","textOrImageComplete","alert","some","saveScenario","scAltIndex","toString","update","scenario","scIndex","assign","altFValues","newId","Scenario","ScenarioListPage","scListHtml","setScListHtml","refreshScListFlag","setRefreshScListFlag","sort","b","seqNr","newScDetails","response2","newSc","tempHtmlList","dummy","window","confirm","scId","altScNr","splice","delete","altScIndex","deleteSc","clipText","navigator","clipboard","writeText","NewAspect","addAspect","setAspectName","setAspectDescr","handleInputA","currentName","nameList","required","rows","descrList","List","refreshListFlag","setCurrentAsp","deleteAspect","listHtml","setListHtml","tempList","aspect","AgeGender","Combi","Aspect","combiList","Filter","AspectEditPage","currentAsp","showAspectsFlag","filterSaved","setFilterSaved","editFunctions","saveFilters","handleAddCombi","handleDeleteCombi","editHtml","handleFName","handleFValue","handleGroupValue","handleAgeGenderValue","handleDelete","handleAddFilter","setEditHtml","helperArray","ageOptions","genderOptions","tempEditHtml","cIndex","c","x","ind","optionHtml","isClearable","useAspectEditHtml","tempCombiList","aspId","aspIndex","asp","tempAspectList","tempAspect","AspectListPage","setShowAspectsFlag","setRefreshListFlag","showNew","setShowNew","findFreeCombiNr","setCombi","Id","showNewAspectForm","aspectRef","combiRef","restOfCombi","dbFilterList","filterObj","newCombiNr","newCombi","aspectId","docs","aspectColl","docRef","newCombiList","newAspect","clearRawResults","useGetDceList","dceList","setDceList","tempDocs","orderBy","aspects","combiObj","useNewDceHtml","inputProps","groupProps","miscProps","newDce","handleInputChange","handleRemoveClick","handleNrQuestionsInput","inputList","setGroupValue","groupChecked","handleCheckbox","handleAddClick","saveDce","dceHtml","setDceHtml","checked","NewDceForm","showNewDceForm","setDceListChanged","setInputList","setGroupChecked","setNewDce","featuresNotNull","item","existsName","list","nrQ","nrString","Number","every","undefined","dceNotNull","addDce","DceListPage","dceListChanged","showScenarioOrAspect","setShowScenarioOrAspect","deleteDce","DcePlayListPage","DceList","names","dceIndex","clearCollection","dceToSave","combiSnapshot","combiDoc","Application","getDceList","exact","path","component","MainApp","Nav","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.72f1bf9b.chunk.js","sourcesContent":["import firebase from 'firebase/app';\r\nimport 'firebase/storage';\r\nimport 'firebase/firestore';\r\nimport 'firebase/auth';\r\n\r\n \r\n // Firebase configuration file\r\n \r\n var firebaseConfig = {\r\n    apiKey: \"AIzaSyDkuqUfQCo8w_7OWogV44gsGLzaE-yEvX4\",\r\n    authDomain: \"pem-firestore.firebaseapp.com\",\r\n    projectId: \"pem-firestore\",\r\n    storageBucket: \"pem-firestore.appspot.com\",\r\n    messagingSenderId: \"528017814946\",\r\n    appId: \"1:528017814946:web:f8fab7864531498a146efb\"\r\n  };\r\n  // Initialize Firebase\r\n  firebase.initializeApp(firebaseConfig);\r\n\r\n //firebase ref variables\r\nconst pemStorage = firebase.storage();\r\nconst pemFirestore = firebase.firestore();\r\nconst timestamp = firebase.firestore.FieldValue.serverTimestamp;\r\nconst pemId = firebase.firestore.FieldPath.documentId;\r\nconst pemAuth = firebase.auth();\r\nconst provider = new firebase.auth.GoogleAuthProvider();\r\n\r\nexport const signInWithGoogle = () => {\r\n  pemAuth.signInWithPopup(provider);\r\n};\r\n\r\n//method for generating user document\r\nexport const generateUserDocument = async (user, additionalData) => {\r\n  if (!user) return;\r\n\r\n  const userRef = pemFirestore.doc(`users/${user.uid}`);\r\n  const snapshot = await userRef.get();\r\n\r\n  if (!snapshot.exists) {\r\n    const { email, displayName, photoURL } = user;\r\n    try {\r\n      await userRef.set({\r\n        displayName,\r\n        email,\r\n        photoURL,\r\n        ...additionalData\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error creating user document\", error);\r\n    }\r\n  }\r\n  return getUserDocument(user.uid);\r\n};\r\n\r\n//method for retrieving user document\r\nconst getUserDocument = async uid => {\r\n  if (!uid) return null;\r\n  try {\r\n    const userDocument = await pemFirestore.doc(`users/${uid}`).get();\r\n\r\n    return {\r\n      uid,\r\n      ...userDocument.data()\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error fetching user\", error);\r\n  }\r\n};\r\n\r\nexport { pemStorage, pemFirestore, timestamp, pemAuth, pemId };","import React, { Component, createContext } from \"react\";\r\nimport { pemAuth, generateUserDocument } from '../firebase/config';\r\n\r\nexport const UserContext = createContext({ user: null });\r\n\r\nclass UserProvider extends Component {//Component to provide username via Context if user is logged in\r\n    state = {\r\n      user: null\r\n    };\r\n  \r\n    //sets user when authenticated\r\n    componentDidMount = async () => {\r\n      pemAuth.onAuthStateChanged(async userAuth => {\r\n        const user = await generateUserDocument(userAuth);\r\n        this.setState({ user });\r\n        console.log(\"User logged in\");\r\n      });\r\n    };\r\n  \r\n    render() {\r\n      const { user } = this.state;\r\n  \r\n      return (\r\n        <UserContext.Provider value={user}>\r\n          {this.props.children}\r\n        </UserContext.Provider>\r\n      );\r\n    }\r\n  }\r\n  \r\n  export default UserProvider;","import  React, { useContext, useEffect } from \"react\";\r\nimport { Link, withRouter } from \"react-router-dom\";\r\nimport {pemAuth} from \"../../../firebase/config\";\r\nimport logo from \"../../../img/pem50.png\"\r\nimport { UserContext } from \"../../../providers/UserProvider\";\r\n\r\n\r\n\r\nfunction Navigation(props) {\r\n     //Nav component with menu items. User name is shown when logged in.\r\n     const user = useContext(UserContext);\r\n\r\n    useEffect(() => {\r\n      let displayName;\r\n      if(user){\r\n      displayName = user.displayName\r\n      }\r\n      else {displayName=''}\r\n    }, [user])\r\n\r\n  return (\r\n    <div className=\"navigation\">\r\n      <nav className=\"navbar navbar-expand navbar-dark bg-dark\">\r\n        <div className=\"container\">\r\n          <Link className=\"navbar-brand\" to=\"/\">\r\n            <img src={logo} width='35px' height='30px' alt=\"PEM logo\" />\r\n          </Link>\r\n          <div>\r\n            <ul className=\"navbar-nav ml-auto\">\r\n              <li key=\"0\"\r\n                className={`nav-item  ${\r\n                  props.location.pathname === \"/\" ? \"active\" : \"\"\r\n                }`}>\r\n                <Link className=\"nav-link\" to=\"/\">\r\n                  Develop\r\n                </Link>\r\n              </li>\r\n              <li key=\"1\"\r\n                className={`nav-item  ${\r\n                  props.location.pathname === \"/dcePlayList\" ? \"active\" : \"\"\r\n                }`}>\r\n                <Link className=\"nav-link\" to=\"/dcePlayList\">\r\n                 Run/Results\r\n                </Link>\r\n              </li>\r\n              {user? <li key=\"2\" className=\"nav-item\">\r\n          <Link to=\"/\" className=\"nav-link\" onClick = {() => {pemAuth.signOut()}}>Sign out ({user.displayName})</Link>\r\n        </li>\r\n        : <li key=\"2\" className=\"nav-item\">\r\n          <Link to=\"/\" className=\"nav-link\" >Sign in</Link>\r\n        </li>}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(Navigation);","export default \"data:image/png;base64,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\"","const Fab = () => {\r\n\t//Fixed action button for additional explanation during dce\r\n    return ( \r\n        <div className=\"outtro\">\r\n\t\t\t<div className=\"fixed-action-btn\">\r\n\t\t\t\t<a href=\"#modal1\" className=\" modal-trigger btn-floating red darken-2\">\r\n\t\t\t\t\t<i className=\"material-icons mat-icon\" style={{fontSize: '140%'}} >help_outline</i></a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n     );\r\n}\r\n \r\nexport default Fab;","import { useState, useEffect } from \"react\";\r\n\r\nconst Option = ({handleClick, sc1, sc2, value, shownSc, ageGender}) => {\r\n//Component that contains option details and feeds back result of choice\r\n\r\nconst [choiceValue, setChoiceValue] = useState({})\r\n//sets choicevalue depending on choice made during experiment\r\n    useEffect(() => {\r\n      if(sc1&&sc2){\r\n      let fValues1 = sc1.fValues;\r\n      let fValues2 = sc2.fValues;\r\n      let cValue = null;\r\n      if(value==='A'){\r\n      cValue = {pref: {...fValues1, ...ageGender}, nonPref: {...fValues2, ...ageGender}}\r\n      }\r\n      if(value==='B'){\r\n        cValue = {pref: {...fValues2, ...ageGender}, nonPref: {...fValues1, ...ageGender}}\r\n      }\r\n      setChoiceValue(cValue);\r\n      }\r\n    }, [sc1, sc2, ageGender, value])\r\n    \r\n    //Shows text and images on the screen\r\n    return ( \r\n        <div className=\"swiper-slide choose-btn\">\r\n\t\t\t\t  <div className=\"s10 \">\r\n            {shownSc&&<div className=\"choice-container\">\r\n            <p>{shownSc.scText}</p>\r\n            <img className = \"swipe-img choice-container\" src={shownSc.scImg} alt=\"\"/>\r\n                  </div>}\r\n           </div>\r\n\t\t\t\t\t{shownSc&&<button value={value} onClick={()=>{handleClick(choiceValue)}} className=\"btn blue darken-2 waves-effect waves-light z-depth-2\">Choose</button>}\r\n        </div>\r\n     );\r\n}\r\n \r\nexport default Option;","import React, {useState} from 'react';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport '../../../index.css';\r\nimport Option from './Option';\r\n\r\n  const MenuTabs = ({handleClick, sc1, sc2, dceDescr, ageGender})=>{\r\n//Component for displaying choices in swipable tabs for smartphones\r\n\r\n    const [index, setIndex] = useState(0);\r\n    const [value, setValue] = useState(0);\r\n    \r\n\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue)\r\n    setIndex(\r\n      newValue,\r\n    );\r\n    };\r\n\r\n  const handleChangeIndex = (index) => {\r\n    setIndex(\r\n      index,\r\n    );\r\n    setValue (index);\r\n  };\r\n\r\n  const styles = {\r\n    tabs: {\r\n      background: '#fff',\r\n      },\r\n    label: {\r\n       fontSize: '100%',\r\n      }}\r\n\r\n    return (\r\n      <div className=\"swiper-container\">\r\n          <AppBar position=\"static\" color=\"default\">\r\n            <Tabs indicatorColor=\"primary\" textColor=\"primary\" background=\"primary\"\r\n              variant=\"fullWidth\" value={value} onChange={handleChange} style={styles.tabs}>\r\n              <Tab style={styles.label} label=\"option n°1\" />\r\n              <Tab style={styles.label} label=\"option n°2\" />\r\n            </Tabs>\r\n          </AppBar>\r\n        <h5 className=\"text-secondary mt-1 mb-0 text-center\">{dceDescr}</h5>\r\n\r\n        <SwipeableViews enableMouseEvents index={index} onChangeIndex={handleChangeIndex}>\r\n          <div className=\"slide\">\r\n            {/* Displays first option  */}\r\n             <div className=\"innerslide\" >\r\n             <Option handleClick={handleClick} sc1={sc1} sc2={sc2} value='A' shownSc={sc1} ageGender={ageGender}/>\r\n             </div> \r\n              </div>\r\n          <div className=\"slide\">\r\n            {/* Displays second option */}\r\n            <div className=\"innerslide\" >\r\n              <Option handleClick={handleClick} sc1={sc1} sc2={sc2} value='B' shownSc={sc2} ageGender={ageGender}/>\r\n             </div> \r\n          </div>\r\n        </SwipeableViews>\r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\nexport default MenuTabs;","\r\nconst Modals = ({sc1, sc2}) => {\r\n//Component for displaying modals\r\n\r\n    return ( \r\n        <div>\r\n            \r\n         {/* //Modal for showing additional explanation during dce */}\r\n            <div id=\"modal1\" data-id=\"modal1\" className=\"modal\">\r\n                <div className=\"modal-content black-text modal-close center\">\r\n                    <div className=\"flow-text\"  >\r\n                        <h4 className=\"mb-3\">Additional explanation:</h4>\r\n                        <h6><u>Scenario 1:</u></h6>\r\n                        {sc1&&<p className=\"flow-text\">{sc1.scExpl}</p>}\r\n                        {sc1&&sc1.scExpl.length===0&&<h5 className=\"\">No additional explanation available</h5>}\r\n                        <h6><u>Scenario 2:</u></h6>\r\n                        {sc2&&<p className=\"flow-text\">{sc2.scExpl}</p>}\r\n                        {sc2&&sc2.scExpl.length===0&&<h5 className=\"\">No additional explanation available</h5>}\r\n\r\n                        <button className=\"btn btn-sm blue darken-2 waves-effect waves-light z-depth-2\">Close</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n     );\r\n}\r\n \r\nexport default Modals;","import Option from './Option';\r\n\r\nconst PcView = ({handleClick, sc1, sc2, dceDescr, ageGender }) => {\r\n    //Component for displaying choices on larger screen like pc, options are next to eachother\r\n\r\n    return ( \r\n        <div className=\"pc-view\">\r\n            <h5 className=\"text-secondary mt-1 mb-1\">{dceDescr}</h5>\r\n            <div className=\"pc-container\">\r\n                {/* Displays first option  */}\r\n                <div className=\"option-container\">\r\n                    <Option handleClick={handleClick} sc1={sc1} sc2={sc2} value='A' shownSc={sc1} ageGender={ageGender}/>\r\n                </div>\r\n                {/* Displays second option */}\r\n                <div className=\"option-container\">\r\n                    <Option handleClick={handleClick} sc2={sc2} sc1={sc1} value='B' shownSc={sc2} ageGender={ageGender}/>\r\n                </div>\r\n             </div>\r\n        </div>\r\n     );\r\n}\r\n \r\nexport default PcView;","import Select from \"react-select\";\r\n\r\nconst StartForm = ({nrQuestions, setStarted, setQNr, handleAGChoice}) => {\r\n//Page component that is shown to the participant at the start of the dce.\r\n//Age and gender are requested. If left empty, the dce will start anyway.\r\n//Values are stored via HandleAGChoice\r\n\r\nconst ageOptions = [{label: \"younger than 25 years\", value: \"younger than 25 years\"},{label: \"25 years or older\", value: \"25 years or older\"}];\r\nconst genderOptions = [{label: \"female\", value: \"female\"},{label: \"male\", value: \"male\"}]\r\n    \r\n     return ( \r\n       <div className=\"my-5\"> \r\n          <div className=\"col resultsContainer mx-3\">\r\n               <h5>Thank you for particpating in this experiment. You will be asked {nrQuestions} questions about your preference.</h5>\r\n               <h5 className=\"text-secondary mb-5\">Please select your gender and age and then start by clicking the button below. </h5>\r\n               \r\n               <div className=\"col-md-6   mx-auto\"> <label htmlFor=\"gender\" className=\"col-form-label\">Gender</label>\r\n                    <Select className=\"mb-2\" options={genderOptions} id=\"gender\" name=\"gender\" onChange={(option, name)=>handleAGChoice(option.value, name.name)}/>\r\n               </div>\r\n               <div className=\"col-md-6   mx-auto\"> <label htmlFor=\"age\" className=\"col-form-label\">Age</label>\r\n                    <Select className=\"mb-4\" options={ageOptions} id=\"age\" name=\"age\" onChange={(option, name)=>handleAGChoice(option.value,  name.name)}/>\r\n               </div>\r\n               <button className=\"btn blue darken-2 \" onClick={()=>{setStarted(true); setQNr(0)}}>Start</button>\r\n          </div>\r\n     </div>\r\n     );\r\n}\r\n \r\nexport default StartForm;","import {  useState, useEffect } from 'react';\r\nimport { pemFirestore } from './config';\r\n\r\n\r\nconst useFirestoreScenarios = (user, dceId) => {//Load scenario's from firestore db and return them as array for the App component (running the dce)\r\n  const [scenarios, setScenarios] = useState([]);\r\n\r\n\r\n  useEffect(() => {//React hook for getting the scenario's from the db when user and dceId are known\r\n    if(user&& dceId){\r\n    const unsub = pemFirestore.collection('users').doc(user).collection('DceList').doc(dceId).collection('Scenarios')\r\n      .onSnapshot(snap => {\r\n        let documents = [];\r\n        snap.forEach(doc => {\r\n          documents.push({...doc.data()});\r\n        });\r\n        setScenarios(documents);\r\n        console.log(\"scenarios just set: \"+JSON.stringify(documents))\r\n      });\r\n    return () => unsub();\r\n    }\r\n    // this is a cleanup function that react will run when\r\n    // a component using the hook unmounts\r\n  }, [user, dceId]);\r\n\r\n  return { scenarios };\r\n}\r\n\r\nexport default useFirestoreScenarios;","import { useState, useEffect} from 'react';\r\nimport { pemFirestore } from \"../../firebase/config\";\r\n\r\nexport default function useSetAspectObjs(userId, dceId, currentDce) {\r\n    // Loads aspects from database and return them as objects with combi's including filters for 'in favor' and 'against'\r\n    const [aspectObjs, setAspectObjs] = useState([]);\r\n    const dceFeatures = currentDce.features;\r\n\r\n    useEffect(() => {//create functional filters after loading aspects from database. Loading from database is still unchanged from old setup before object oriented design.\r\n        if(userId&&dceId&&currentDce){\r\n        let tempAspectObjs = [];\r\n        setAspectObjs(tempAspectObjs);//ensure AspectObjects are empty\r\n        let response = pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('AspectList');\r\n        response.get()\r\n        .then((querySnapshot)=>{\r\n            querySnapshot.forEach((doc)=>{//for each aspect set name and description\r\n                tempAspectObjs.push({aspectName: doc.data().aspectName, aspectDescr: doc.data().aspectDescr, id: doc.id});\r\n                pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('AspectList').doc(doc.id).collection('Combis')\r\n                .get()\r\n                .then((snapshot)=>{\r\n                    let tempFilters = [];\r\n                    snapshot.forEach((snap)=>{//for each combi set in favor and against filters\r\n                        let tempFilter = snap.data();\r\n                        let favorFilters = [];\r\n                        let againstFilters = [];\r\n                        favorFilters.push(...tempFilter.filterList);\r\n                        againstFilters.push(...tempFilter.filterList);\r\n                        let newFavorFilter = {fName: currentDce.groupFeature, fValue: snap.data().groupValue};//include groupfeature as favorfilter\r\n                        if(snap.data().ageGender){\r\n                            if(snap.data().ageGender.age!==\"\"){//if age string is not empty create agefilter\r\n                        let ageFilter = {fName: \"age\", fValue: snap.data().ageGender.age};\r\n                        favorFilters.push(ageFilter);\r\n                        againstFilters.push(ageFilter);\r\n                    }\r\n                    if(snap.data().ageGender.gender!==\"\"){//if gender string is not empty create gender filter\r\n                        let genderFilter = {fName: \"gender\", fValue: snap.data().ageGender.gender};\r\n                        favorFilters.push(genderFilter);\r\n                        againstFilters.push(genderFilter);\r\n                        }}\r\n                        favorFilters.push(newFavorFilter);\r\n                        let newAgainstValue = \"\";//include opposite value of groupfeature as filter in againstfilters\r\n                        dceFeatures.forEach((feature,i) =>{\r\n                        if (feature.featureName===currentDce.groupFeature){\r\n                            if(feature.featureValue1===snap.data().groupValue){\r\n                                newAgainstValue = feature.featureValue2;}\r\n                            if(feature.featureValue2===snap.data().groupValue){\r\n                                newAgainstValue = feature.featureValue1;}\r\n                        }\r\n                        })\r\n                        let newAgainstFilter = {fName: currentDce.groupFeature, fValue: newAgainstValue};\r\n                        againstFilters.push(newAgainstFilter);\r\n                        tempFilter['favorFilters'] = favorFilters;\r\n                        tempFilter['againstFilters'] = againstFilters\r\n                        tempFilters.push(tempFilter);;\r\n                    })\r\n                    let newTempObjs = [...tempAspectObjs]\r\n                        let index = tempAspectObjs.findIndex(obj=>obj.id===doc.id);//find current aspect in list of aspectObjects\r\n                        newTempObjs[index]['combis'] = tempFilters;//set filters to current aspectObject\r\n                        setAspectObjs(newTempObjs);\r\n                        })\r\n            })\r\n         }).catch((err)=>{\r\n            console.log('Error with loading document'+err);\r\n        })\r\n        return\r\n    }},[userId, dceId, currentDce])\r\n\r\n    return {aspectObjs};\r\n}\r\n","import React, { useState, useEffect} from 'react';\r\n\r\nexport default function useGetResultHtml(aspectObjs, results) {\r\n    // Calculate outcome of aspectfilters and return html\r\n \r\n    const [resultHtml, setResultHtml] = useState([]);\r\n\r\n    useEffect(() => {//React hook for creating html to display graphic results of selected dce\r\n        let tempResult = [];\r\n        tempResult.push(\r\n            <div key=\"head\">\r\n           <div key=\"headtext\" className=\"mb-3\"> &Delta; P shows the difference in probability that the aspect is true and the \r\n               probability that the aspect is not true\r\n           </div>\r\n           </div>\r\n        )\r\n        aspectObjs.forEach((aspectObj,i)=>{//For each aspect filter calculate how many results are in favor and against\r\n            let aspectDescr = aspectObj.aspectDescr;\r\n            let oddsFavor = [];\r\n            let oddsAgainst = [];\r\n            if(aspectObj.combis){\r\n            aspectObj.combis.forEach(combi=>{\r\n\r\n                    const checkFValue = (result=>{//check if result has to be counted in favor\r\n                        let passesAllFilters = true;\r\n                        combi.favorFilters.forEach(favFilter=>{\r\n                            if(!(favFilter.fValue===result[favFilter.fName]&&result.hasOwnProperty(favFilter.fName))){\r\n                                passesAllFilters = false;\r\n                            }\r\n                        })\r\n                        return(passesAllFilters)\r\n                    })\r\n                    let tempFavors = results.filter(checkFValue);\r\n                    tempFavors.forEach(favor=>{\r\n                        if(oddsFavor.indexOf(favor)===-1){//add to list if not already in list\r\n                            oddsFavor.push(favor);\r\n                        }\r\n                    })\r\n                               \r\n                    const checkAValue = (result=>{//check if result has to be counted against\r\n                        let passesAllFilters = true;\r\n                        combi.againstFilters.forEach(againstFilter=>{\r\n                            if(!(againstFilter.fValue===result[againstFilter.fName]&&result.hasOwnProperty(againstFilter.fName))){\r\n                                passesAllFilters=false;\r\n                            }\r\n                        })\r\n                        return(passesAllFilters)\r\n                    })\r\n                    let tempAgainst = results.filter(checkAValue);\r\n                    tempAgainst.forEach(against=>{\r\n                        if (oddsAgainst.indexOf(against)===-1){//add to list if not already in list\r\n                            oddsAgainst.push(against);\r\n                        }\r\n                    })\r\n                })\r\n        }\r\n        let prob = 0;\r\n        if (oddsAgainst.length>0||oddsFavor.length>0){\r\n            prob = 2*(oddsFavor.length/(oddsFavor.length+oddsAgainst.length))-1;\r\n        }\r\n        let graphProb = Math.abs(prob*50);// property to set width of bar in graph\r\n        let clNames = graphReverse(prob); // Set className to get reverse direction in case of negative number\r\n        let barClasses = getBarClasses(prob); // Set color of bars depending on positive or negative numbers\r\n\r\n        tempResult.push(//html for bars and text. Bars 'start' from middle by filling first half with empty bar. Small stripe in case of zero value.\r\n            <div key={`graphs ${i}`} className=\"pb-2\">\r\n                <span key={`asp-desc ${i}`} className=\"text-secondary\">{aspectDescr}</span><br/>\r\n                <div key={`clNames ${i}`} className={clNames}>\r\n                <div key={`pg-bar-pt1 ${i}`} className=\"progress-bar bg-light-grey\" role=\"progressbar\" style={{width: 50+\"%\"}} aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                {prob===0&&<div key={`pg-bar-pt2 ${i}`} className=\"progress-bar bg-teal\" role=\"progressbar\" style={{width: 2 +\"px\"}} aria-valuenow=\"30\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>}\r\n                <div key={`pg-bar-pt3 ${i}`} className={barClasses} role=\"progressbar\" aria-valuenow={prob} aria-valuemin=\"0\" aria-valuemax=\"100\" style={{width:graphProb+\"%\"}}>\r\n                {(prob>=0.4||prob<=-0.4)&&<span key={`pg-title ${i}`} className=\"sr-only\">&Delta; P = {prob.toFixed(2)}</span>}\r\n                </div>\r\n                </div>\r\n                {(prob<0.4&&prob>-0.4)&&<div key={`pg-desc ${i}`}>&Delta; P = {prob.toFixed(2)}</div>}\r\n                <span key={`pg-desc2 ${i}`}>(Chosen {(100*prob).toFixed(0)}% {prob<0 ? \"less\": \"more\"} than the opposite.)</span>\r\n\r\n            </div>)\r\n        setResultHtml(tempResult);\r\n        })\r\n        if(aspectObjs.length===0){\r\n            setResultHtml([<div><h5>No aspects defined.</h5></div>])\r\n        }\r\n        return \r\n    }, [aspectObjs, results])//rerender when aspect objects or results change\r\n\r\n\r\n   const graphReverse = (prob)=>{// Set className to get reverse direction in case of negative number\r\n        let tempClNames = \"progress w-80 mx-auto\"\r\n        if (prob<0){\r\n            tempClNames=\"progress w-80 mx-auto flex-row-reverse\"\r\n        }\r\n        return  (tempClNames);\r\n    }\r\n\r\n    const getBarClasses = (prob)=>{// Set color of bars depending on positive or negative numbers\r\n        let barClasses = \"progress-bar bg-teal progress-bar-striped\";\r\n        if (prob<0){\r\n            barClasses = \"progress-bar bg-purple progress-bar-striped\"\r\n        }\r\n        return barClasses;\r\n    }\r\n\r\n\r\n    return {resultHtml};\r\n}\r\n","import {  useState, useEffect } from 'react';\r\nimport { pemFirestore } from './config';\r\n\r\n\r\nconst useFirestoreLoadResult = (user, dceId) => {//Loads the raw results from the database and returns them\r\nconst [results, setResults] = useState([]);\r\n\r\n\r\nuseEffect(() => {\r\n  if(user&&dceId){\r\n    let unsub = pemFirestore.collection('users').doc(user).collection('DceList').doc(dceId).collection('RawResults')\r\n    .onSnapshot(snap => {\r\n        let documents = [];\r\n        snap.forEach(doc => {//cycles through all result docs from the db and adds them to the results array\r\n          documents.push({...doc.data().pref, id: doc.id});\r\n        });\r\n        setResults(documents);\r\n      });\r\n      return () => unsub();\r\n    // this is a cleanup function that react will run when\r\n    // a component using the hook unmounts\r\n  }}, [user, dceId]);\r\n\r\n  return {results} ;\r\n}\r\n\r\nexport default useFirestoreLoadResult;","import React from 'react';\r\nimport useFirestoreLoadResult from '../../firebase/useFirestoreLoadResults';\r\nimport useSetAspectObjs from '../controller/useSetAspectObjs';\r\nimport useGetResultHtml from './useGetResultHtml';\r\n\r\n\r\nexport default function ResultDce({currentDce, dceId, userId}) {\r\n    //Shows results of a DCE. Only available for grouped dce's at present\r\n\r\n    const {results} = useFirestoreLoadResult(userId ,dceId);//load results from database\r\n    const {aspectObjs} = useSetAspectObjs(userId, dceId, currentDce); //load aspects from dB\r\n    const {resultHtml} = useGetResultHtml(aspectObjs, results); //calculate numbers and return html for results\r\n    const nrParticipants = Math.ceil(results.length/currentDce.nrQuestions)\r\n    return (\r\n        <div key=\"main\">\r\n            {!currentDce.id&&<div><h3>Click on <i className=\"material-icons mt-1  btn-outline-danger\">poll</i> in the dce list for results.</h3> <h5>(only available for grouped dce's)</h5></div> }\r\n           {currentDce.id&&<div key=\"title\" className=\"mb-5\"><h3>Total results from all particpants: </h3>\r\n           <div><h6>Number of particpants: {nrParticipants}</h6></div>\r\n            {resultHtml}</div>}\r\n           \r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport useSetAspectObjs from '../../controller/useSetAspectObjs';\r\nimport useGetResultHtml from '../useGetResultHtml';\r\nimport ResultDce from \"../ResultDce\";\r\n\r\n\r\nexport default function ParticipantResults({resultList, currentDce, dceId, userId}) {\r\n    const {aspectObjs} = useSetAspectObjs(userId, dceId, currentDce);\r\n    const {resultHtml} = useGetResultHtml(aspectObjs, resultList);\r\n\r\n    return (\r\n        <div className=\"my-5\"> \r\n            <p>Thank you for completing this experiment!</p>\r\n            {/*only show results if the dce is grouped*/}\r\n            {currentDce.grouped&&<div className=\"col resultsContainer mx-3\"> \r\n                <div className=\"mb-5\"><h3>Your results: </h3>\r\n                {resultHtml}</div>\r\n            </div>}\r\n            {currentDce.grouped&&<div className=\"col resultsContainer mx-3\"> \r\n                <ResultDce  currentDce={currentDce} dceId={dceId} userId={userId} />\r\n            </div>}\r\n\r\n     </div>\r\n    )\r\n}\r\n","//Sets the html for the dots that indicate the questions that have to be answered\r\nconst setDots =  (length)=>{\r\n    let dot = [];\r\n    for(let i=0; i<length;i++){\r\n    dot.push(<span key={`emptydot${i}`} className=\"dot\"></span>)};\r\n  return dot;\r\n  };\r\n\r\n     //calculate nr of dots of questions still to answer\r\n  const calcDots = (done, setDone, todo, setTodo, qNr)=>{\r\n    let dones = [];//indicator dots for number of questions already answered\r\n    dones = [...done];\r\n    dones.push(<span key={`filleddot${qNr}`} className=\"dot blue darken-2\"></span>);\r\n    setDone(dones);\r\n    let todos = [];//indicator dots for questions still to answer\r\n    todos = [...todo];\r\n    todos.pop();\r\n    setTodo(todos);\r\n    return;\r\n}\r\n \r\nexport {setDots, calcDots};","//Various functions related to determining which scenario's will be shown\r\n\r\n//returns list of random nrs that will be used as index nr for the scenario list. maxNr indicates the highest\r\n//that a nr can be. Length represents the amount of entries in the list. Numbers will only be used once in the list.\r\nconst getRndNrList= (maxNr, length)=>{\r\n  let usedNrs = [];\r\n  let nrList = [];\r\n  for(let j=0;j<length;j++){\r\n    let randNr=-1;\r\n    for (let i=maxNr*5; i>0; i--){\r\n        const tempRandNr = Math.floor(Math.random() * maxNr);\r\n        if (!usedNrs.includes(tempRandNr)){\r\n          randNr=tempRandNr;\r\n          break;\r\n          }\r\n      }\r\n    if(randNr!==-1){usedNrs.push(randNr)}  //store nr if it is used\r\n    nrList.push(randNr);\r\n  }\r\n  return nrList\r\n}\r\n\r\n  //get 2 random scenarios, no repeats and A!=B\r\nconst getRandomScenarios = (scenarios, prevRandomA, setPrevRandomA)=>{\r\n    const maxNr = scenarios.length;\r\n    const {RandomNrA, RandomNrB} = GetUnusedRndNrs(maxNr, prevRandomA, setPrevRandomA);\r\n    return ({ScenarioA: scenarios[RandomNrA], ScenarioB: scenarios[RandomNrB]});\r\n    }\r\n\r\n    \r\n// get random nr for the first scenario and store used nrs to avoid repeats\r\nconst GetRandomANr = (maxNr, prevRandomA, setPrevRandomA)=>{\r\n    let usedNrsA = [];\r\n    if (prevRandomA!=null){usedNrsA=[...prevRandomA]}\r\n    let randNrA=-1;\r\n    for (let i=maxNr*5; i>0; i--){\r\n        const tempRandNrA = Math.floor(Math.random() * maxNr);\r\n        if (!usedNrsA.includes(tempRandNrA)){\r\n          randNrA=tempRandNrA;\r\n          break;\r\n          }\r\n      }\r\n    if(randNrA!==-1){usedNrsA.push(randNrA)}  //store A-nr if it is used\r\n    setPrevRandomA(usedNrsA);\r\n    return randNrA;\r\n  }\r\n\r\n//Gets 2 random nrs where A-nr has not been used before in this session and B is different from A\r\n//Used for Dce's without grouped scenario's\r\nconst GetUnusedRndNrs = (maxNr, prevRandomA, setPrevRandomA)=>{\r\n    let randNrA = GetRandomANr(maxNr, prevRandomA, setPrevRandomA);\r\n    let randNrB=-1;\r\n    for (let i=maxNr*10; i>0; i--){\r\n      const tempRandNrB = Math.floor(Math.random() * maxNr);\r\n      if (randNrA!==tempRandNrB){\r\n        randNrB=tempRandNrB;\r\n        break;\r\n      }\r\n    }   \r\n    return {RandomNrA: randNrA, RandomNrB: randNrB};\r\n}\r\n\r\n\r\nexport  {getRandomScenarios, GetRandomANr, getRndNrList} ;\r\n","class Dce {//object representing a discrete choice experiment, \r\n    constructor(id, name, descr, nrQuestions, features, grouped) {\r\n        this.id = id;\r\n        this.name = name;//name of the dce. Must be unique.\r\n        this.descr = descr;//description of this dce. Will be shown to participants\r\n        this.nrQuestions = nrQuestions;//nr of questions that the particpants will have to answer in this dce\r\n        this.features = features;//list of features on which a value has to be defined on each scenario\r\n        this.grouped = grouped;\r\n        this.scList = [];//list of scenario object that make up the dce\r\n        this.aspectList = [];//list of aspects that are used to filter the results\r\n    }\r\n}\r\nexport default Dce","import Dce from \"./dce\";\r\n\r\nclass GroupedDce extends Dce{//object representing a grouped dce. This is a dce where each scenario is paired with one specific other scenario\r\n    constructor(id, name, descr, nrQuestions, features, grouped, groupFeature, uid) {\r\n        super(id, name, descr, nrQuestions,  features, grouped, uid);//takes general params from Dce\r\n        this.groupFeature = groupFeature; //In a groupedDce, one feature is defined as groupFeature. This is the only feature that has a different value in a scenario pair \r\n    }\r\n}\r\nexport default GroupedDce","import Fab from '../../view/participantApp/Fab';\nimport MenuTabs from '../../view/participantApp/MenuTabs';\nimport Modals from '../../view/participantApp/Modals';\nimport M from 'materialize-css/dist/js/materialize.min.js';\nimport PcView from '../../view/participantApp/PcView';\nimport { useState, useEffect } from \"react\";\nimport { useParams} from \"react-router-dom\";\nimport StartForm from '../../view/participantApp/StartForm';\nimport { pemFirestore } from '../../../firebase/config';\nimport useFirestoreScenarios from '../../../firebase/useFirestoreScenarios';\nimport ParticipantResults from '../../view/participantApp/ParticipantResults';\nimport { setDots, calcDots } from './DotFunctions';\nimport useGetGroupedScenarios from './useGetGroupedScenarios'\nimport useSaveResult from './useSaveResult';\nimport Dce from '../../model/dce';\nimport GroupedDce from '../../model/groupedDce';\n\nfunction App() {//central component for running of a dce.\n\n  const [answerList, setAnswerList] =useState([]);\n  const [resultList, setResultList] = useState([]);\n  const [ageGender, setAgeGender] = useState({age: \"\", gender: \"\"})\n  const [done,setDone] = useState([]);\n  const [todo, setTodo] = useState([]);\n  const [sc1, setSc1] = useState(null);\n  const [sc2, setSc2] = useState(null);\n  const [qNr, setQNr] = useState(null);\n  const [currentDce, setCurrentDce] = useState(null)\n  const [nrQuestions, setNrQuestions] = useState(0);\n  const [isGrouped, setIsGrouped] = useState(null);\n  const [dceDescr, setDceDescr] = useState(null);\n  const [dceFeatures, setDceFeatures] = useState([]);\n  const [dceDetails, setDceDetails] = useState(null)\n  const [dceNameEdit, setDceNameEdit] = useState('');\n  const [finished, setFinished] = useState(false);\n  const [started, setStarted] = useState(false);\n  const [error, setError] = useState(\"\");\n  const {userId, dceId } = useParams();\n  const {scenarios} = useFirestoreScenarios(userId, dceId); // load scenario's from database\n  const {scenarioListA, scenarioListB} = useGetGroupedScenarios(scenarios, nrQuestions, isGrouped );\n\n\nuseEffect(() => {\n  //initialize materialize - css library\n  M.AutoInit();\n});\n\nuseEffect(()=>{//creates two random lists with scenario's to show. \n  if(scenarioListB&&scenarioListA){\n  setSc1(scenarioListA[qNr]);//the qNr (question nr) determines which scenario is shown as sc1 and sc2 \n  setSc2(scenarioListB[qNr]);\n  }\n},[scenarioListA, scenarioListB, qNr])\n\n//Handle click from age and gender select in startform\nconst handleAGChoice = (value, id) =>{\n  let tempAgeGender = ageGender;\n  tempAgeGender[id] = value;\n  setAgeGender(tempAgeGender);\n}\n\n// handle click from choose button\n  const handleClick = (choiceValue) => {\n    if(choiceValue){\n    let tempListA =[...answerList];\n    tempListA.push(choiceValue);\n    setAnswerList(tempListA);\n    }//if choiceValue ==0, next scenario's are selected and answers are not recorded.\n    // SettingScenarios(isGrouped);\n    if(qNr+2>nrQuestions){\n      setFinished(true)}     //finishes if nr of questions as defined in Dce is reached\n    setQNr(qNr=>qNr+1);\n    calcDots(done, setDone, todo, setTodo, qNr); //takes care of indicator dots below the scenario's\n   }\n\n\n//load dce details from database\n//execute at startup and upon change of scenarios\nuseEffect(()=>{\n  if(scenarios&&userId&&dceId){ //only query dB if id's are known\n    setError(\"\");\n    setAnswerList([]);\n    let fValuesArray = scenarios.map(sc=>sc[\"fValues\"]);\n    let arrayValues =  fValuesArray.map(value=>Object.values(value)[0]);\n    console.log(\"arrayValues: \"+JSON.stringify(arrayValues));\n    let containsEmpty = arrayValues.includes(\"\");\n    console.log(\"fValuesArray: \"+JSON.stringify(fValuesArray));\n    console.log(\"containsEmpty: \"+containsEmpty)\n    if(containsEmpty){//check if all scenario's are complete, else set error\n      setError(\"All scenario's must have data entered and saved - please contact the researcher.\")\n      return;                         \n    } else if(!containsEmpty){\n        let response = pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId);\n        response.get()\n        .then(doc=>{//for grouped scenario's the nr of scenario's must be at least twice the nr of questions. For ungrouped the minimum nr scenario's ==nrQuestions with minimum of 2\n          if((doc.data().grouped&&scenarios.length<2*doc.data().nrQuestions)||(!doc.data().grouped&&(scenarios.length<doc.data().nrQuestions||scenarios.length<2))){\n            setError(\"The scenario's are incomplete - please contact the researcher.\");\n          }else{setError(\"\");\n\n            let tempGrouped = doc.data().grouped;\n            let dce;\n                if(doc.data().grouped){//create a dce object or GroupedDce object if applicable\n                dce = new GroupedDce(  doc.id, doc.data().name, doc.data().descr, doc.data().nrQuestions, doc.data().features, doc.data().grouped, doc.data().groupFeature );\n                } else {\n                    dce = new Dce(doc.id, doc.data().name, doc.data().descr, doc.data().nrQuestions, doc.data().features, doc.data().grouped)\n                }\n            setCurrentDce(dce);//set current dce with loaded dce and set other variables\n            setDceFeatures(doc.data().features);\n            const tempDetails = {details: {grouped: doc.data().grouped, groupFeature: doc.data().groupFeature, nrQuestions: doc.data().nrQuestions}}\n            setDceDetails(tempDetails);\n            setDceDescr(doc.data().descr);\n            setDceNameEdit(doc.data().name);\n            setNrQuestions(doc.data().nrQuestions);\n            setIsGrouped(tempGrouped);\n            setTodo(setDots(doc.data().nrQuestions))\n            }\n        }).catch((error) => {\n            console.error(\"Error loading document: \", error);\n          })}\n  }},[scenarios, userId, dceId]);\n\n//save results when finished \n useSaveResult(finished, answerList, userId, dceId, setResultList); \n\n// Show in the browser. Startform before begin, MenuTabs for mobile, PcView for pc, \n// done and todo are progress indicator. Show ParticpantResult when finished.\n  return (\n    <div>\n      <Modals sc1={sc1} sc2={sc2}/>\n      {!finished&&!started&&<StartForm nrQuestions={nrQuestions} setStarted={setStarted} setQNr={setQNr} handleAGChoice={handleAGChoice}/>}\n      {!finished &&started&&!error && <MenuTabs handleClick = {handleClick} sc1={sc1} sc2={sc2} dceDescr={dceDescr} ageGender={ageGender}/>} \n      {!finished &&started&&!error && sc1&&sc2&& <PcView handleClick = {handleClick} sc1={sc1} sc2={sc2} dceDescr={dceDescr} ageGender={ageGender}/>}\n      {!finished &&started&&!error&&<Fab />}\n      {!finished &&started&&!error&& <div className=\"footer\">\n         {done}\n         {todo}\n      </div>}\n      {finished &&started&&!error&&userId&&dceId&& <ParticipantResults resultList={resultList} currentDce={currentDce} dceDetails={dceDetails} dceNameEdit = {dceNameEdit} dceId={dceId} dceFeatures={dceFeatures} userId={userId}/>}\n      {error&&<div className=\"text-danger mt-5\"><h4>Error: {error}</h4></div>}\n    </div>\n  )\n}\n\nexport default App;\n","import { useEffect, useState } from \"react\";\r\nimport { getRndNrList} from './ScenarioFunctions'\r\n\r\n   //Get 2 scenarios that are only differing in the group feature. ScenarioA is random, ScenarioB is the pair of A\r\nexport default function useGetGroupedScenarios  (scenarios, nrQuestions, isGrouped){\r\n  const [scenarioListA, setScenarioListA] = useState(null)\r\n  const [scenarioListB, setScenarioListB] = useState(null)\r\n\r\n    useEffect(()=>{//React hook that returns a list of nrs used for scenario A plus a list of nrs used for scenario B. These are the pairs of A\r\n        console.log(\"entering useeffect in getScenarios, nrQ en grouped:\"+nrQuestions+isGrouped)\r\n        if (scenarios&&nrQuestions&&isGrouped!==null&&scenarios.length>0){\r\n            const maxNr = scenarios.length;\r\n            console.log(\"maxNr: \"+maxNr)\r\n      let randNrList = getRndNrList(maxNr, nrQuestions);\r\n      let scListA = [];\r\n      console.log(\"scenarios: \"+JSON.stringify(scenarios))\r\n      randNrList.forEach(nr=>{\r\n        scListA.push(scenarios[nr]);//set the correct nrs to the A list\r\n        })\r\n      let scListB = [];\r\n      if(isGrouped){\r\n          console.log(\"scListA: \"+JSON.stringify(scListA))\r\n          scListA.forEach(scA=>{\r\n              scListB.push(scenarios.find(({id})=>(id===scA.altnr)))//set the B list to match the A list \r\n          })\r\n      }\r\n      if(!isGrouped){\r\n          getRndNrList(maxNr, nrQuestions).forEach(nr=>{scListB.push(scenarios[nr])})//if not grouped, the B list is random too\r\n      }  \r\n      setScenarioListA(scListA);\r\n      setScenarioListB(scListB);\r\n        }\r\n    },[scenarios, nrQuestions, isGrouped ])\r\n    \r\n    return( {scenarioListA,  scenarioListB});  \r\n  }","import {useRef, useEffect } from 'react'\r\nimport { pemFirestore } from '../../../firebase/config';\r\n\r\nexport default function useSaveResult(finished, answerList, userId, dceId, setResultList) {\r\n\r\n    const initialRender = useRef(true);\r\n\r\n//Save results to database when experiment is finished\r\nuseEffect(() => {\r\n    if (initialRender.current) {\r\n      initialRender.current = false;   // ensure this effect does not run on startup\r\n    } else {\r\n            let collRef = pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('RawResults')\r\n            let tempResultList = [];\r\n            answerList.forEach((answer,i)=> {collRef.add(answer)   //save each result as separate entry to firstore db for total result\r\n                .then(()=>{\r\n                    console.log(\"answer added to results collection\")\r\n                    tempResultList.push(answer.pref,i);\r\n                })\r\n                });\r\n            setResultList(tempResultList);  //save this dce result as a list for personal result presentation\r\n        }\r\n    }, [finished])\r\n  \r\n\r\n    return \r\n }\r\n","import React, {useState} from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { signInWithGoogle } from \"../../../firebase/config\";\r\nimport { pemAuth } from \"../../../firebase/config\";\r\n\r\nconst SignIn = () => {//Sign in page. Provides methodes for signing in with email or google\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [error, setError] = useState(null);\r\n    const signInWithEmailAndPasswordHandler = \r\n            (event,email, password) => {\r\n                event.preventDefault();\r\n                pemAuth.signInWithEmailAndPassword(email, password)\r\n                .catch(error => {\r\n                    setError(\"Error signing in with password and email!\");\r\n                      console.error(\"Error signing in with password and email\", error);\r\n                    });\r\n    };\r\n\r\n      const onChangeHandler = (event) => {\r\n          const {name, value} = event.currentTarget;\r\n\r\n          if(name === 'userEmail') {\r\n              setEmail(value);\r\n          }\r\n          else if(name === 'userPassword'){\r\n            setPassword(value);\r\n          }\r\n      };\r\n\r\n  return (\r\n    <div className=\"row justify-content-center\">\r\n      <h1 className=\"text-3xl mb-2 text-center font-bold\">Sign In</h1>\r\n      <div className=\"col-sm-7\">\r\n        {error !== null && <div className = \"text-danger mb-3\">{error}</div>}\r\n        <form className=\"\">\r\n        <div className=\"form-floating\">\r\n           <input\r\n            type=\"email\"\r\n            className=\"form-control\"\r\n            name=\"userEmail\"\r\n            value = {email}\r\n            placeholder=\"Your email\"\r\n            id=\"userEmail\"\r\n            onChange = {(event) => onChangeHandler(event)}\r\n          />\r\n          <label htmlFor=\"userEmail\" className=\"block\">\r\n            Email:\r\n          </label>\r\n          </div>\r\n\r\n          <div className=\"form-floating \">\r\n          <input\r\n            type=\"password\"\r\n            className=\"form-control\"\r\n            name=\"userPassword\"\r\n            value = {password}\r\n            placeholder=\"Your Password\"\r\n            id=\"userPassword\"\r\n            onChange = {(event) => onChangeHandler(event)}\r\n          />\r\n             <label htmlFor=\"userPassword\" className=\"block\">\r\n            Password:\r\n          </label>\r\n          </div>\r\n          <button className=\"btn btn-outline-info\" onClick = {(event) => {signInWithEmailAndPasswordHandler(event, email, password)}}>\r\n            Sign in\r\n          </button>\r\n        </form>\r\n        <p className=\"my-3\">or</p>\r\n        <button\r\n          className=\"btn btn-outline-info\" onClick={() => {\r\n            signInWithGoogle();\r\n          }}>\r\n          Sign in with Google\r\n        </button>\r\n        <p className=\"my-3\">\r\n          Don't have an account?{\" \"}\r\n          <Link to=\"/signUp\" className=\"text-blue-500 hover:text-blue-600\">\r\n            Sign up here\r\n          </Link>{\" \"}\r\n          <br />{\" \"}\r\n          <Link to = \"passwordReset\" className=\"text-blue-500 hover:text-blue-600\">\r\n            Forgot Password?\r\n          </Link>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default SignIn;","import React, { useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { pemAuth, signInWithGoogle, generateUserDocument } from \"../../../firebase/config\";\r\n\r\nconst SignUp = () => { //Sign up page. Register either via mail address or Google account\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [displayName, setDisplayName] = useState(\"\");\r\n  const [error, setError] = useState(null);\r\n\r\n  const createUserWithEmailAndPasswordHandler =async (event, email, password) => {\r\n    event.preventDefault();\r\n    try{\r\n        const {user} = await pemAuth.createUserWithEmailAndPassword(email, password);\r\n        generateUserDocument(user, {displayName});\r\n      }\r\n      catch(error){\r\n        setError('Error Signing up with email and password');\r\n      }\r\n    setEmail(\"\");\r\n    setPassword(\"\");\r\n    setDisplayName(\"\");\r\n  };\r\n  const onChangeHandler = event => {\r\n    const { name, value } = event.currentTarget;\r\n    if (name === \"userEmail\") {\r\n      setEmail(value);\r\n    } else if (name === \"userPassword\") {\r\n      setPassword(value);\r\n    } else if (name === \"displayName\") {\r\n      setDisplayName(value);\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"row justify-content-center\">\r\n      <h1 className=\"text-3xl mb-2 text-center font-bold\">Sign Up</h1>\r\n      <div className=\"col-sm-7\">\r\n        {error !== null && (\r\n          <div className=\"text-danger mb-3\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        <form className=\"\">\r\n        <div className=\"form-floating\">     \r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control \"\r\n            name=\"displayName\"\r\n            value={displayName}\r\n            placeholder=\"Display name\"\r\n            id=\"displayName\"\r\n            onChange={event => onChangeHandler(event)}\r\n          />\r\n           <label htmlFor=\"displayName\" className=\"block\">\r\n            Display Name:\r\n          </label>\r\n        </div>\r\n        <div className=\"form-floating\">     \r\n           <input\r\n            type=\"email\"\r\n            className=\"form-control\"\r\n            name=\"userEmail\"\r\n            value={email}\r\n            placeholder=\"Your Email\"\r\n            id=\"userEmail\"\r\n            onChange={event => onChangeHandler(event)}\r\n          />\r\n           <label htmlFor=\"userEmail\" className=\"block\">\r\n            Email:\r\n          </label>\r\n          </div>\r\n          <div className=\"form-floating\">     \r\n          <input\r\n            type=\"password\"\r\n            className=\"form-control\"\r\n            name=\"userPassword\"\r\n            value={password}\r\n            placeholder=\"Your Password\"\r\n            id=\"userPassword\"\r\n            onChange={event => onChangeHandler(event)}\r\n          />\r\n          <label htmlFor=\"userPassword\" className=\"block\">\r\n            Password:\r\n          </label>\r\n          </div>\r\n          <button\r\n            className=\"btn btn-outline-info\"\r\n            onClick={event => {\r\n              createUserWithEmailAndPasswordHandler(event, email, password);\r\n            }}\r\n          >\r\n            Sign up\r\n          </button>\r\n        </form>\r\n        <p className=\"my-3\">or</p>\r\n        <button\r\n          className=\"btn btn-outline-info\"\r\n          onClick={() => {\r\n            try {\r\n              signInWithGoogle();\r\n            } catch (error) {\r\n              console.error(\"Error signing in with Google\", error);\r\n            }\r\n        }}\r\n        >\r\n          Sign In with Google\r\n        </button>\r\n        <p className=\"my-3\">\r\n          Already have an account?{\" \"}\r\n          <Link to=\"/\" className=\"text-blue-500 hover:text-blue-600\">\r\n            Sign in here\r\n          </Link>{\" \"}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default SignUp;","import React, { useState } from \"react\";\r\nimport { pemAuth } from \"../../../firebase/config\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst PasswordReset = () => {//Component for reseting password\r\n  const [email, setEmail] = useState(\"\");\r\n  const [emailHasBeenSent, setEmailHasBeenSent] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const onChangeHandler = event => {\r\n    const { name, value } = event.currentTarget;\r\n\r\n    if (name === \"userEmail\") {\r\n      setEmail(value);\r\n    }\r\n  };\r\n\r\n  //sends reset email request\r\n  const sendResetEmail = event => {\r\n    event.preventDefault();\r\n    pemAuth\r\n      .sendPasswordResetEmail(email)\r\n      .then(() => {\r\n          setEmailHasBeenSent(true);\r\n        setTimeout(() => {setEmailHasBeenSent(false)}, 3000);\r\n      })\r\n      .catch(() => {\r\n        setError(\"Error resetting password\");\r\n      });\r\n  };\r\n  return (\r\n    <div className=\"row justify-content-center\">\r\n      <h1 className=\"text-xl text-center font-bold mb-3\">\r\n        Reset your Password\r\n      </h1>\r\n      <div className=\"col-sm-7\">\r\n        <form action=\"\">\r\n          {emailHasBeenSent && (\r\n            <div className=\"text-danger mb-3\">\r\n              An email has been sent to you!\r\n            </div>\r\n          )}\r\n          {error !== null && (\r\n            <div className=\"text-danger mb-3\">\r\n              {error}\r\n            </div>\r\n          )}\r\n                  <div class=\"form-floating\">\r\n          \r\n          <input\r\n            type=\"email\"\r\n            name=\"userEmail\"\r\n            id=\"userEmail\"\r\n            value={email}\r\n            placeholder=\"Input your email\"\r\n            onChange={onChangeHandler}\r\n            className=\"form-control\"\r\n          />\r\n          <label htmlFor=\"userEmail\" className=\"block\">\r\n            Email:\r\n          </label>\r\n          </div>\r\n          <button\r\n            className=\"btn btn-outline-info my-3\"\r\n            onClick={event => {\r\n              sendResetEmail(event);\r\n            }}\r\n          >\r\n            Send me a reset link\r\n          </button>\r\n        </form>\r\n\r\n        <Link\r\n          to=\"/\"\r\n          className=\"my-2 text-blue-700 hover:text-blue-800 text-center block\"\r\n        >\r\n          &larr; back to sign in page\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PasswordReset;","import { useState, useEffect } from 'react';\r\nimport { pemStorage } from './config';\r\n\r\n\r\nconst useStorage = (file ) => {//Connect to firebase storage for storing images\r\n  const [progress, setProgress] = useState(0);\r\n  const [error, setError] = useState(null);\r\n  const [url, setUrl] = useState(null);\r\n\r\n\r\n  useEffect(() => {//React hook for storing a file and returning its url. Sets progress indicator while loading\r\n    const storageRef = pemStorage.ref(file.name);\r\n    storageRef.put(file).on('state_changed', (snap) => {\r\n      let percentage = (snap.bytesTransferred / snap.totalBytes) * 100;\r\n      setProgress(percentage);\r\n    }, (err) => {\r\n      setError(err);\r\n    }, async () => {\r\n      const url = await storageRef.getDownloadURL();\r\n      setUrl(url);\r\n    });\r\n  }, [file]);//triggers upon file\r\n\r\n  return { progress, url, error };\r\n}\r\n\r\nexport default useStorage;","import React, { useCallback, useEffect } from 'react';\r\nimport useStorage from '../../firebase/useStorage';\r\n\r\n//Component for showing progressbar when uploading images in a scenario\r\nconst ProgressBar = ({ file, setFile, dceId, scNr, setUrl }) => {\r\n  const { progress, url } = useStorage(file, dceId, scNr);\r\n\r\n// useCallback to enable use of proper dependencies\r\nconst creatUrl = \r\nuseCallback ((url)=>{\r\n  setUrl(url);\r\n},[setUrl])\r\n\r\n\r\n  //set file and url when url (from storage) changes \r\n  useEffect(() => {\r\n    if (url) {\r\n      setFile(null);\r\n      creatUrl(url);\r\n    }\r\n  }, [url, setFile, creatUrl]);\r\n\r\n\r\n    //Html to show in browser\r\n  return (\r\n    <div className=\"progress-bar\"\r\n      style={{ width: progress + '%' }}\r\n    ></div>\r\n  );\r\n} \r\n\r\nexport default ProgressBar;","import React, { useState } from 'react';\r\nimport ProgressBar from '../view/ProgressBar';\r\n\r\nconst UploadForm = ({ dceId, scNr, setUrl }) => { //Component for uploading image\r\n  const [file, setFile] = useState(null);\r\n  const [error, setError] = useState(null);\r\n\r\n  const types = ['image/png', 'image/jpeg'];\r\n\r\n  //handle selected file\r\n  const handleChange = (e) => {\r\n    let selected = e.target.files[0];\r\n    if (selected && types.includes(selected.type)) {//ensure file type is png or jpeg\r\n      setFile(selected);\r\n      setError('');\r\n    } else {\r\n      setFile(null);\r\n      setError('Please select an image file (png or jpg)');\r\n    }\r\n  };\r\n\r\n  //Html to show in browser. Show progressbar while loading\r\n  return (\r\n    <div>\r\n      <label>\r\n        <input type=\"file\" style={{height: 0, width: 0}} onChange={handleChange} />\r\n        <span className=\"btn btn-sm btn-outline-info mb-3\">Upload image</span>\r\n      </label>\r\n      <div className=\"output\">\r\n        { error && <div className=\"error\">{ error }</div>}\r\n        { file && <div>{ file.name }</div> }\r\n        { file && <ProgressBar file={file} setFile={setFile} dceId={dceId} scNr={scNr} setUrl={setUrl}/> }\r\n      </div>\r\n    </div>\r\n      );\r\n}\r\n\r\nexport default UploadForm;","import Select from \"react-select\";\r\nimport { useEffect, useState } from \"react\";\r\nimport UploadForm from \"../controller/UploadForm\";\r\n\r\n\r\nconst useScenarioDetailsHtml = (currentDce, dceId, currentSc, setCurrentSc, setIsSaved, isSaved ,  handleChosen, handleSave, handleCreateAlt, handleEntry) => {\r\n   // creates html for formsfields and buttons for the NewScenario component\r\nconst scNr = currentSc.id;\r\nconst [scenarioHtml, setScenarioHtml] = useState([]);\r\n\r\n// set url for the image and save to chosenList\r\nconst setUrl = (url)=>{\r\n    const tempSc = {...currentSc};\r\n    tempSc[\"scImg\"]=url;\r\n    setCurrentSc(tempSc);\r\n    setIsSaved(false)\r\n}\r\n\r\nuseEffect(()=>{//React hook for creating html for displaying scenario details and form field for changes\r\n    console.log(\"useScDtl triggered\")\r\nif(Object.keys(currentSc).length>0){\r\n    let tempHtml = [];\r\n    tempHtml.push(<div key={`scDtls ${currentSc.id}`}>\r\n        {currentSc.id&&<div>\r\n        {currentDce&&currentDce.grouped&&<h5>Paired with scenario nr: {currentSc.altnr}</h5>}\r\n        <div key=\"form-row\" className=\"form-row\" > \r\n        <h6>Features</h6>\r\n        <div className=\"row\">\r\n            {console.log(\"inside features, fValues are:..\"+JSON.stringify(currentSc.fValues))}\r\n      {currentSc.fValues&&currentDce.features&&currentDce.features.map((feature,i) =>{\r\n      let options =[{label: feature.featureValue1, value: feature.featureValue1},\r\n        {label: feature.featureValue2, value: feature.featureValue2}];\r\n            return (\r\n           <div key={i} className=\"col-md-4  mb-3\"> <label htmlFor={i} className=\"col-form-label\">{feature.featureName}</label>\r\n            <Select options={options} key={currentSc.id+i} placeholder={currentSc.fValues[feature.featureName]||\"Select..\"} defaultValue={currentSc.fValues[feature.featureName]} isDisabled={currentSc.altSc} \r\n             onChange={(option)=>handleChosen(option.value, feature.featureName)} id={i}/>\r\n            </div>\r\n            )\r\n        })}\r\n        </div>\r\n        </div>\r\n        <form id=\"textForm\">\r\n        <div>\r\n        <h6>Scenario text</h6>\r\n        <textarea className=\"form-control form-control-sm mb-3\" name=\"scText\" value={currentSc.scText} placeholder=\"Enter scenario text\" id=\"scText\" onChange={e=>handleEntry(e)}></textarea>\r\n         </div>\r\n                               \r\n         <div>\r\n             <h6>Scenario explanation</h6>\r\n             <textarea className=\"form-control form-control-sm mb-3\" type=\"text\" name=\"scExpl\" value={currentSc.scExpl} placeholder=\"Enter additional explanatory text\" id=\"scExpl\" onChange={e=>handleEntry(e)}></textarea>\r\n\r\n         </div>\r\n         <h6>Scenario image link</h6>\r\n               <UploadForm dceId={dceId} scNr={scNr} setUrl={setUrl} />\r\n               {currentSc.scImg&&<img src={currentSc.scImg} className='scImage' alt=\"scenario\"/>}\r\n               {currentDce&&currentDce.grouped&&!currentSc.altnr&&<input className=\"btn  btn-outline-success my-3\" type=\"button\" onClick={e=>handleCreateAlt(e)} value=\"Save & Create pair\"></input>}\r\n               {(currentSc.altnr||!currentDce.grouped)&&<input type=\"button\" className=\"btn  btn-outline-success my-3\" onClick={(e)=>handleSave(e)} value=\"Save\"></input>}\r\n               </form>\r\n               {isSaved&&<div>Scenario has been saved</div>}\r\n         </div>\r\n         }\r\n         </div>\r\n        )\r\n        setScenarioHtml(tempHtml);\r\n         return   \r\n}    \r\n        },[currentDce, currentSc, isSaved])\r\n        \r\n        return {scenarioHtml}\r\n            \r\n        }\r\n        \r\n\r\n \r\nexport default useScenarioDetailsHtml;","import React, { useContext } from \"react\";\r\nimport { UserContext } from \"../../providers/UserProvider\";\r\nimport { pemFirestore } from \"../../firebase/config\";\r\nimport useScenarioDetailsHtml from \"../view/useScenarioDetailsHtml\";\r\n\r\nexport default function ScenarioDetails({currentDce, dceId, currentSc, setCurrentSc, handleAddScenario, setIsSaved, isSaved}) {\r\n//Component for adding a new scenario\r\n\r\n    const user = useContext(UserContext);\r\n    const uid = user.uid;\r\n\r\n\r\n    //Handles choices from dropdown fValues\r\n    const handleChosen = (value, name)=>{\r\n        const tempSc = {...currentSc};\r\n        tempSc.fValues[name]=value;\r\n        setCurrentSc(tempSc);\r\n        setIsSaved(false);\r\n    }\r\n\r\n    //Handles entries from input fields\r\n    const handleEntry = (e)=>{\r\n        e.preventDefault();\r\n        const {name, value} = e.target;\r\n        const tempSc = {...currentSc};\r\n        tempSc[name]=value;\r\n        setCurrentSc(tempSc);\r\n        setIsSaved(false);\r\n    }\r\n\r\n//Gets features for the other scenario in a pair\r\nconst getAltFValues = (fValueList) =>{\r\n    const groupFeat = currentDce.groupFeature;\r\n    const groupFeatValue = fValueList[groupFeat];\r\n    let newFeatValue;\r\n    currentDce.features.forEach((feature) =>{\r\n        if (feature.featureName===groupFeat){//for the alternative values we need the other value of the dichotomous groupFeature\r\n            if(feature.featureValue1===groupFeatValue){\r\n                newFeatValue = feature.featureValue2;}\r\n            if(feature.featureValue2===groupFeatValue){\r\n                newFeatValue = feature.featureValue1;}\r\n        }\r\n    })\r\n    let altFValueList = {...fValueList};//other feature values remain the same\r\n    altFValueList[groupFeat] = newFeatValue;//groupFeature is replaced with alternative value\r\n    return altFValueList\r\n}\r\n\r\n\r\n//Saves via handleSave and creates the alternative scenario in case of grouped features\r\nconst handleCreateAlt = (e)=>{\r\n    if(fieldsComplete()){\r\n        console.log(\"fValues of currentSc: \"+JSON.stringify(currentSc.fValues))\r\n        console.log(\"currentSc.id: \"+currentSc.id)\r\n        let altFValues = getAltFValues(currentSc.fValues);\r\n        console.log(\"altFValues after get: \"+JSON.stringify(altFValues))\r\n    handleAddScenario(altFValues, currentSc.id)//adds a new scenario with alternative fValues. 2nd param will be used for the altnr field in the new scenario\r\n    .then((newId)=>{\r\n        currentSc[\"altnr\"] = newId;//the id of new scenario will be added to the current scenario before saving it\r\n        saveScenario(currentSc);\r\n    })\r\n    }\r\n}\r\n\r\n//Checks if all required field have an entry\r\nconst fieldsComplete = ()=>{\r\n    let textOrImageComplete = false;\r\n    let featuresComplete = false;\r\n    if (currentSc[\"scText\"].length!==0 || currentSc[\"scImg\"].length!==0){\r\n        textOrImageComplete=true}\r\n    else{\r\n    alert(\"Fill in the Scenario Text or upload a Scenario Image, or do both\") \r\n    }\r\n    featuresComplete= !currentDce.features.some(feature=>{\r\n        if(currentSc[\"fValues\"][feature.featureName].length===0){\r\n            alert(\"Select a value for every feature in the scenario\");\r\n             \r\n        } return (currentSc[\"fValues\"][feature.featureName].length===0);\r\n    })\r\nreturn textOrImageComplete&&featuresComplete;    \r\n}\r\n\r\n //Checks if all required field have an entry and saves to Firestore if ok.\r\n //Else alert with error message\r\nconst handleSave = async (e)=>{\r\ne.preventDefault();\r\nif(fieldsComplete()){\r\n    saveScenario(currentSc);\r\n    const altnr = currentSc[\"altnr\"];\r\n    console.log(\"altnr is: \"+altnr)\r\n    console.log(\"fValues i currentSc: \"+JSON.stringify(currentSc[\"fValues\"]))\r\n    const altFValueList = getAltFValues(currentSc[\"fValues\"]);\r\n    console.log(\"altFValuesList in handlesave: \"+JSON.stringify(altFValueList))\r\n    if (altnr){ // if these is an altnr, there is a pair that needs to be updated, fValues only\r\n        let scAltIndex = currentDce.scList.findIndex(sc=>sc.id===altnr);\r\n        console.log(\"altIndex is: \"+scAltIndex)\r\n        console.log(\"altSc is: \"+JSON.stringify(currentDce.scList[scAltIndex]))\r\n        currentDce.scList[scAltIndex][\"fValues\"] = altFValueList; //update fValueList in paired scenario in scList\r\n        let response = pemFirestore.collection('users').doc(uid).collection('DceList').doc(dceId).collection('Scenarios');\r\n            response.doc(altnr.toString()).update({\r\n                \"fValues\": altFValueList\r\n            });//update fValueList in paired scenario in database\r\n    }\r\nsetIsSaved(true);\r\n}\r\n}\r\n\r\n//saves scenario to the list and database\r\nconst saveScenario = (scenario)=>{\r\n    let scIndex = currentDce.scList.findIndex(sc=>sc.id===scenario.id);//find the index of the current sc in the list\r\n    console.log(\"scIndex is: \"+scIndex);\r\n    currentDce.scList[scIndex] = scenario; //update scList with current scenario (save scenario)\r\n    let response = pemFirestore.collection('users').doc(uid).collection('DceList').doc(dceId).collection('Scenarios');\r\n    response.doc(currentSc.id.toString()).set(Object.assign({},scenario));//save scenario to database\r\n}\r\n\r\n\r\n//gets html for this page\r\nconst {scenarioHtml} = useScenarioDetailsHtml( currentDce, dceId, currentSc, setCurrentSc, setIsSaved, isSaved,  handleChosen, handleSave, handleCreateAlt, handleEntry );\r\n\r\n//Html to show in browser\r\n    return (\r\n        <div key=\"1\">\r\n         {scenarioHtml}\r\n        </div>\r\n    )\r\n}\r\n","    class Scenario {//object representing a scenario. \r\n    constructor(id, scText, scExpl, scImg, fValues, altSc, altnr){\r\n        this.id = id;\r\n        this.scText = scText;//text that is displayed as part of a scenario. Either a scText or a scImg must be entered before running a dce.\r\n        this.scExpl = scExpl;//text that serves as addition explanation in a scenario\r\n        this.scImg = scImg;//textfield representing a link to an uploaded image.\r\n        this.fValues = fValues;//list of feature values. All features of the dce must have a value here before dce can be run.\r\n        this.altSc = altSc;//boolean representing whether this scenario is the first one of a pair, or the alternative (the second) scenario\r\n        this.altnr = altnr; //number that matches the id of the scenario to which it is paired\r\n    }\r\n}\r\nexport default Scenario","import React, { useContext, useState, useEffect } from \"react\";\r\nimport { UserContext } from \"../../providers/UserProvider\";\r\nimport { pemFirestore } from \"../../firebase/config\";\r\nimport ScenarioDetails from \"./ScenarioDetails\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Scenario from \"../model/scenario\";\r\n\r\n\r\nexport default function ScenarioListPage({currentDce, dceId, currentSc, setCurrentSc}) {//Creates list of scenario's incl frame for details\r\n\r\n    const user = useContext(UserContext);\r\n    const uid = user.uid;\r\n    const [isSaved, setIsSaved] = useState(false);\r\n    const [scListHtml, setScListHtml] = useState([]);\r\n    const [refreshScListFlag, setRefreshScListFlag] = useState('');\r\n\r\n\r\n\r\n    // //show scenario list when dceId is changed\r\n    // useEffect(() => {\r\n    //         setChosen([{}]);\r\n    //         setScNr(null);\r\n    //         setIsSaved(false)\r\n    //   }, [dceId])\r\n\r\n// Adds scenario with id which is the first available unique number \r\n// Features are taken from dce\r\n    const handleAddScenario = async( altFValues, altnr) =>{\r\n        if(dceId){\r\n            let fValues ={};\r\n            currentDce.features.forEach(feature=>{\r\n                fValues[feature.featureName]=\"\";\r\n            })\r\n        console.log(\"list before sort: \"+JSON.stringify(currentDce.scList))\r\n        currentDce.scList.sort(function(a, b){return (a.id-b.id)});//first sort list so no nr will be missed\r\n        console.log(\"list after sort: \"+JSON.stringify(currentDce.scList))\r\n        let seqNr=1; // set seqNr to 1 and check if it is available, otherwise raise by 1 and repeat\r\n        currentDce.scList.forEach(sc => {\r\n            if(sc.id!==seqNr){\r\n                return;\r\n            }\r\n            else {\r\n                seqNr +=1;\r\n            }\r\n            });\r\n            let altSc = false;\r\n            if (altnr){altSc = true; fValues= {...altFValues}} // if altnr was specified, the new sc will be the pair of this alt sc\r\n            console.log(\"altFValues: \"+JSON.stringify(altFValues))\r\n            let newScDetails = {id: seqNr, altnr: altnr, altSc: altSc, fValues, scText: \"\", scImg: \"\", scExpl: \"\"}\r\n            let response2 = pemFirestore.collection('users').doc(uid).collection('DceList').doc(dceId).collection('Scenarios');\r\n            console.log(\"newScDetails: \"+JSON.stringify(newScDetails));\r\n            response2.doc(seqNr.toString()).set(newScDetails);\r\n            let newSc = new Scenario(seqNr, \"\", \"\", \"\", fValues, altSc, altnr||null);//create new scenario object with empty values, including altnr if available\r\n            console.log(\"newSc: \"+JSON.stringify(newSc));\r\n            currentDce.scList.push(newSc);\r\n            currentDce.scList.sort(function(a, b){return (a.id-b.id)});//sort list again so new sc is ordered too\r\n            setIsSaved(false);\r\n            setRefreshScListFlag(\"added\"+seqNr)\r\n            setCurrentSc(newSc);//show the new scenario\r\n      return newSc.id;\r\n    }\r\n}\r\n\r\n//delete scenario from database and refresh list\r\nconst deleteSc = (sc) => {\r\n    let scId = sc.id;\r\n    console.log(\"scId to be deleted: \"+JSON.stringify(scId))\r\n    let scIndex = currentDce.scList.findIndex(sc=>sc.id===scId);\r\n    let altScNr = currentDce.scList[scIndex].altnr//define altnr if available\r\n    console.log(\"scIndx \"+scIndex)\r\n    currentDce.scList.splice(scIndex, 1); //delete scenario from scList\r\n    console.log(\"scList: \"+JSON.stringify(currentDce.scList))\r\n    pemFirestore.collection('users').doc(uid).collection('DceList').doc(dceId).collection('Scenarios').doc(scId.toString()).delete()//delete from db\r\n    .then(() => {\r\n        console.log(\"Scenario with ID \"+scId+ \"  successfully deleted!\");\r\n        if (scId===currentSc.id){ //if deleted sc was shown on screen, clear it\r\n            setCurrentSc({dummy: currentSc.id});\r\n        }\r\n        setIsSaved(false);\r\n        setRefreshScListFlag(\"deleted\"+scId)\r\n    }).catch((error) => {\r\n        console.error(\"Error removing document: \", error);\r\n    });\r\n    if (altScNr){ // if there is a pair scenario coupled to this scenario (altScNr), delete that too\r\n        let altScIndex = currentDce.scList.findIndex(sc=>sc.id===altScNr);\r\n        console.log(\"altScIndex: \"+altScIndex)\r\n        altScIndex>-1&&currentDce.scList.splice(altScIndex, 1); //delete pair scenario from scList\r\n        pemFirestore.collection('users').doc(uid).collection('DceList').doc(dceId).collection('Scenarios').doc(altScNr.toString()).delete().then(() => {\r\n            console.log(\"Alt scenario with ID \"+altScNr.toString()+ \"  successfully deleted!\");\r\n        }).catch((error) => {\r\n            console.error(\"Error removing document: \", error);\r\n        });}\r\n}\r\n\r\nuseEffect(()=>{//react hook for creating html to display scenario list. \r\n    let tempHtmlList = [];\r\n    currentDce.scList && currentDce.scList.forEach((sc,i)=>{\r\n        tempHtmlList.push(\r\n            <div  key={i} className=\"\">\r\n            <h5 className=\"mt-3\"><li className=\"listRuler mb-1\" data-id={sc.id}><button className=\"btn btn-sm btn-outline-info\" onClick={()=>{setCurrentSc({dummy:\"clear\"+i});setCurrentSc(sc); setIsSaved(false)}}>{sc.id}</button>\r\n            <hr className=\"ruler\"/> \r\n            <button className=\"btn  btn-outline-warning btn-sm mx-2\" onClick={()=>{setCurrentSc({dummy:\"clear\"+i});setCurrentSc(sc); setIsSaved(false)}} > <i className=\"material-icons mat-icon\">edit</i></button>\r\n            <hr className=\"rulerSm\"/>\r\n            <button className=\"btn  btn-outline-success btn-sm mx-2\" onClick={() => { if (window.confirm('Are you sure you wish to delete this scenario?'))deleteSc(sc) }} > <i className=\"material-icons mat-icon\">delete_forever</i></button></li></h5>\r\n            </div>\r\n        )\r\n        })\r\n        setScListHtml(tempHtmlList)    \r\n\r\n},[refreshScListFlag, currentSc])//Re-rendered upon change of flag and current sc\r\n\r\n\r\n    //html to show in browser including the header and framework for the details\r\n    return (\r\n        <div>\r\n            <h4><u>Details</u> for <b> {currentDce&&currentDce.name}{!currentDce.name&&<span> - Select a dce</span>}</b>{currentSc.id&&<span> - Scenario nr. {currentSc.id}</span>}{!currentSc.id&&<span> - Select a scenario nr.</span>}</h4>\r\n            <div className=\"\">\r\n            <h6>{currentDce&&currentDce.id&&<span> <Link to={{pathname:\"/app/\"+uid+\"/\"+ currentDce.id}}>\r\n                    <button className=\"btn btn-sm btn-outline-info mx-1\" ><i className=\"material-icons mat-icon mt-1\">play_circle_outline</i></button>\r\n                    </Link></span>}\r\n                    {currentDce&&currentDce.id&&<span> Play this DCE</span>} {currentDce&&currentDce.id&&<span> <hr className=\"ruler detailsRuler\"/> <button className=\"btn btn-sm btn-outline-info\" onClick={() => {let clipText = window.location.href+\"app/\"+uid+\"/\"+ currentDce.id; navigator.clipboard.writeText(clipText)}}>Copy DCE link </button></span>} </h6></div>\r\n           <div className=\"pb-4\"><h6> {currentDce&&currentDce.grouped&&<span>Group feature: {currentDce&&currentDce.groupFeature}</span>} {<span> <hr className=\"ruler detailsRuler\"/> Questions in DCE: {currentDce&&currentDce.nrQuestions}</span>}</h6>\r\n           </div>\r\n            <div className=\"row\">\r\n   <div className=\"scenarioList col col-6 col-md-3 col-sm-5\">\r\n    <h5>Scenario's</h5>\r\n    <ul>\r\n    <li key=\"header\" className=\"listRuler mb-1\">Nr.  <hr className=\"ruler\"/> Edit <hr className=\"rulerSm\"/>&nbsp;Delete </li>\r\n           {scListHtml}\r\n           {currentDce&&<li className=\"mb-2\"><button className=\"btn btn-sm btn-outline-info\" onClick={()=>{handleAddScenario(null, null)}} >Add scenario</button></li>}\r\n    </ul>\r\n    </div>\r\n    \r\n    <div className=\"col\">\r\n        <ScenarioDetails currentDce={currentDce} dceId={dceId} currentSc={currentSc} setCurrentSc={setCurrentSc}  handleAddScenario={handleAddScenario} setIsSaved={setIsSaved} isSaved={isSaved}/>\r\n    </div>\r\n    </div>\r\n        </div>\r\n    )\r\n}\r\n","import React, { useState } from \"react\";\r\n\r\n\r\nexport default function NewAspect({addAspect}) {\r\n  //component with form for creating new aspect\r\n\r\n    const [aspectName, setAspectName] = useState(['name']);\r\n    const [aspectDescr, setAspectDescr] = useState(['descr']);\r\n\r\n \r\n  //Saves aspect with name and description\r\n    const saveAspect = (e)=>{\r\n        e.preventDefault();\r\n        addAspect( aspectName[0], aspectDescr[0]);        \r\n  }\r\n\r\n    // sets new name\r\n    const handleNameInputChange = (e) => {\r\n      const nameList = handleInputA(e, aspectName)\r\n        setAspectName(nameList);\r\n    }\r\n\r\n    // sets new description \r\n    const handleDescrInputChange = (e) => {\r\n      const descrList = handleInputA(e, aspectDescr);\r\n      setAspectDescr(descrList);\r\n  }\r\n\r\n  //common method for changing name and description\r\n  const handleInputA = (e, currentName) => {\r\n    const name = e.target.value;\r\n    const nameList = [...currentName];\r\n    nameList[0]=name;\r\n    return ( \r\n        nameList\r\n     );\r\n}\r\n \r\n  //html to show in browser. Form for entering name and description\r\n  return (\r\n        <div>\r\n            <form className=\"form-inline\">\r\n                <div className=\"my-2\">\r\n                    <label htmlFor=\"aspectName\" className=\"block\">Name: </label>\r\n                    <input type=\"text\" className=\"form-control mb-2\" name=\"aspectName\"  placeholder=\"Aspect name\" id=\"aspectName\" \r\n                    required onChange={handleNameInputChange}></input>\r\n                    </div>\r\n                    <div className=\"my-2\">\r\n                    <label htmlFor=\"aspectDescr\" className=\"block\">Description: </label>\r\n                    <textarea type=\"text\" rows=\"3\" className=\"form-control mb-2\" name=\"aspectDescr\"  placeholder=\"Description\" id=\"aspectDescr\" \r\n                    required onChange={handleDescrInputChange}></textarea>\r\n                    </div>\r\n      <button className=\"btn btn-sm btn-outline-success\" onClick={saveAspect} >Save aspect</button>\r\n          </form>\r\n        </div>\r\n    )\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nexport default function List({currentDce, refreshListFlag, setCurrentAsp, deleteAspect}) {\r\nconst [listHtml, setListHtml] = useState([]);\r\n\r\n    useEffect(()=>{//React hook for generating the html for displaying the list of aspects\r\n        let tempList = [];\r\n        currentDce.aspectList&& currentDce.aspectList.forEach((aspect, i)=>{\r\ntempList.push(<div key={`aspectList ${i}`} className=\"\">\r\n<h6 className=\"mt-3\">\r\n    <li  key={i} className=\"listRuler mb-1\"  data-id={aspect.id}> <b>{aspect.name}</b>\r\n        <hr className=\"ruler\"/> \r\n        <button className=\"btn btn-sm btn-outline-warning\" onClick={()=>{setCurrentAsp({dummy:\"clear\"+i});setCurrentAsp(aspect)}}><i className=\"material-icons mat-icon\">edit</i></button>\r\n        <hr className=\"rulerSm\"/>\r\n        <button className=\"btn  btn-outline-success btn-sm mx-2\" onClick={()=>{deleteAspect(aspect)}}><i className=\"material-icons mat-icon\">delete_forever</i></button>\r\n    </li>\r\n</h6>\r\n</div>\r\n)\r\n        })\r\n setListHtml(tempList);\r\n    },[currentDce, refreshListFlag])//gets re-rendered when flag is changed\r\n\r\n    //Component for displaying aspect list\r\n    return (\r\n        <div>\r\n            <div className=\" col-auto \">\r\n                <h4><u>Aspect list</u></h4>\r\n                <ul>\r\n                    {listHtml}\r\n                </ul>\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n}\r\n","class AgeGender {//object representing age and gender of participant that can be entered at start of dce\r\n    constructor(age, gender){\r\n        this.age = age;\r\n        this.gender = gender;\r\n    }\r\n}\r\nexport default AgeGender","class Combi {//object representing a combination of filters. Filters exist of list of filters and the groupvalue\r\n    constructor(nr, groupValue, filterList){\r\n        this.nr = nr;\r\n        this.groupValue = groupValue;\r\n        this.filterList = filterList;//List of filter objects. Combining more filters in this list will narrow the result.\r\n    }\r\n}\r\nexport default Combi","class Aspect {//object representing an aspect. An aspect is used as a filterfunction on the results.\r\n    constructor(id, name, descr, ageGender, combiList) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.descr = descr;\r\n        this.ageGender = ageGender;//filtering can also be done on age and gender of the participants via the ageGender object\r\n        this.combiList = combiList;//the combiList is a list(array) of filters that are combined with eachother (results added)\r\n    }\r\n}\r\nexport default Aspect","class Filter {//object representing a filter with a name and value\r\n    constructor(fName, fValue){\r\n        this.fName = fName;\r\n        this.fValue = fValue;\r\n    }\r\n}\r\nexport default Filter","import React from 'react';\r\nimport useAspectEditHtml from './useAspectEditHtml';\r\nimport Filter from '../model/filter'\r\n\r\nexport default function AspectEditPage({currentDce, currentAsp, showAspectsFlag, setCurrentDce, setCurrentAsp, filterSaved, setFilterSaved, editFunctions }) {\r\n//Component for editing an aspect \r\n\r\n    const {saveFilters, handleAddCombi, handleDeleteCombi} = editFunctions\r\n\r\n   \r\n    //Handles feature name input from form\r\n    const handleFName = (fName, cIndex, index)=>{\r\n        const tempCombiList = [...currentAsp.combiList];\r\n        tempCombiList[cIndex].filterList[index][\"fName\"]= fName;\r\n        setCurrentAsp(currentAsp=>({...currentAsp, combiList: tempCombiList}));\r\n        setFilterSaved(false);\r\n    }\r\n\r\n    //Handles feature value input from form\r\n    const handleFValue = (fValue, cIndex, index) =>{\r\n        const tempCombiList = [...currentAsp.combiList];\r\n        tempCombiList[cIndex].filterList[index][\"fValue\"]= fValue;\r\n        setCurrentAsp(currentAsp=>({...currentAsp, combiList: tempCombiList}));\r\n        setFilterSaved(false);\r\n    }\r\n    \r\n    //Handles value for selected group feature in form\r\n    const handleGroupValue = (value, cIndex)=>{\r\n        const tempCombiList = [...currentAsp.combiList];\r\n        tempCombiList[cIndex].groupValue=value;\r\n        setCurrentAsp(currentAsp=>({...currentAsp, combiList: tempCombiList}));\r\n        setFilterSaved(false);\r\n        }\r\n \r\n        //handles age and gender values as selected\r\n        const handleAgeGenderValue = (name, value, aspId) =>{\r\n            let aspIndex = currentDce.aspectList.findIndex(asp=>asp.id===aspId);\r\n            const tempAspectList = [...currentDce.aspectList];\r\n            const tempAspect = {...tempAspectList[aspIndex]};\r\n            const tempAgeGender = {...tempAspect.ageGender};\r\n            tempAgeGender[name] = value;\r\n            tempAspect.ageGender=tempAgeGender;\r\n            tempAspectList[aspIndex]=tempAspect;\r\n            setCurrentDce(currentDce=>({...currentDce, aspectList: tempAspectList}));\r\n            setCurrentAsp(currentAsp=>({...currentAsp, ageGender: tempAgeGender}))\r\n            setFilterSaved(false);\r\n        }\r\n\r\n   \r\n//Deletes a filter from the current aspect\r\n    const handleDelete = (e, index, cIndex)=>{\r\n        e.preventDefault();\r\n        const tempCombiList = [...currentAsp.combiList];\r\n        tempCombiList[cIndex].filterList.splice(index, 1);\r\n        setCurrentAsp(currentAsp=>({...currentAsp, combiList: tempCombiList}));\r\n        setFilterSaved(false);\r\n      }\r\n\r\n//Adds a new empty filter to the currently loaded aspect\r\n    const handleAddFilter = (e, cIndex)=>{\r\n        e.preventDefault();\r\n        const tempCombiList = [...currentAsp.combiList];\r\n        tempCombiList[cIndex].filterList.push(new Filter(\"\",\"\"));\r\n        setCurrentAsp(currentAsp=>({...currentAsp, combiList: tempCombiList}));\r\n        setFilterSaved(false);\r\n    }\r\n\r\n//Loads html for displaying aspects and editing forms\r\n    const {editHtml} = useAspectEditHtml(currentDce, currentAsp, showAspectsFlag, handleFName, handleFValue, handleGroupValue, handleAgeGenderValue, handleDelete, handleAddFilter, handleAddCombi, handleDeleteCombi, saveFilters);  \r\n\r\n//Button for adding a combination filter\r\nlet addCombiButton = [];\r\n   if(!currentAsp.dummy&&!Object.keys(currentAsp).length===0){//only add if an aspect is loaded as current \r\n       addCombiButton.push(\r\n        <button className=\"btn btn-sm btn-outline-info my-4\" onClick={handleAddCombi}>add combination feature</button>\r\n        )\r\n}\r\n\r\n//returns html to the browser, including name and descr of aspect. Alternative text if name is unavailable\r\n    return (\r\n        <div>\r\n            <h4 className=\"mb-1\">Define aspect for <b>{currentAsp.name||\"(Select an aspect..)\"}</b></h4>\r\n            <h6 className=\"text-secondary pb-3\">Description: {currentAsp.descr}</h6>     \r\n              {!currentAsp.dummy&&editHtml}\r\n              {filterSaved&&<h6>Filters saved</h6>}\r\n        </div>\r\n    )\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport Select from \"react-select\";\r\n\r\n\r\nexport default function useAspectEditHtml(currentDce, currentAsp, showAspectsFlag, handleFName, handleFValue, handleGroupValue, handleAgeGenderValue, handleDelete, handleAddFilter, handleAddCombi, handleDeleteCombi, saveFilters) {\r\n//create html for aspect edit screen\r\n\r\n    const [editHtml, setEditHtml] = useState([]);\r\n    const helperArray = [{}];\r\n    const ageOptions = [{label: \"younger than 25 years\", value: \"younger than 25 years\"},{label: \"25 years or older\", value: \"25 years or older\"}];\r\n    const genderOptions = [{label: \"female\", value: \"female\"},{label: \"male\", value: \"male\"}];\r\n    const dceFeatures = currentDce.features;\r\n   \r\nuseEffect(() => {\r\n    let tempEditHtml =[];\r\n    currentAsp.combiList&& currentAsp.combiList.forEach((combi, cIndex)=>{\r\n        console.log(\"combi in forEach: \"+JSON.stringify(combi))\r\n        tempEditHtml.push( //add following html for each combi\r\n           <div key={cIndex+currentAsp.id} id={cIndex}> {(cIndex!==0)&&(<h5 className=\"my-5\">\r\n           <button onClick={(e)=>handleDeleteCombi(e,cIndex)} className=\"btn  btn-outline-success btn-sm mx-2\"  > <i className=\"material-icons mat-icon\">delete_forever</i></button>\r\n           combined with: \r\n           </h5>\r\n           )}\r\n           <h5>Select value for group feature - {currentDce.groupFeature}</h5>\r\n\r\n           <label htmlFor=\"groupVal\">Group value</label>\r\n<div className=\"selectInputs mb-3\">\r\n           {currentDce.features&&helperArray.map((c,i)=>{return (<Select key={`${currentAsp.id}-grValue- ${cIndex}`} options={[{label: currentDce.features.find(x=>x.featureName===currentDce.groupFeature).featureValue1, value: currentDce.features.find(x=>x.featureName===currentDce.groupFeature).featureValue1},\r\n{label: currentDce.features.find(x=>x.featureName===currentDce.groupFeature).featureValue2, value: currentDce.features.find(x=>x.featureName===currentDce.groupFeature).featureValue2}]} placeholder={combi.groupValue|| \"Select...\"} onChange={(option) => handleGroupValue(option.value, cIndex)} />\r\n)})}   \r\n</div>\r\n          <h5>Filter features and values</h5>\r\n\r\n           </div>\r\n        )\r\n        combi.filterList&&combi.filterList.length>0&&combi.filterList.forEach((filter, index)=>{\r\n        tempEditHtml.push(\r\n        <div key={`${currentAsp.id}-feature- ${cIndex} ${index}`} id={index} className=\"selectInputs my-3\">\r\n            <span>\r\n            <Select key={`${currentAsp.id}-fName- ${cIndex}`} options={dceFeatures&&dceFeatures.map((feature,ind) =>{\r\n                          let optionHtml = feature.featureName;\r\n                          let isDisabled = false;\r\n                          if (feature.featureName===currentDce.groupFeature){\r\n                              isDisabled = true\r\n                          }\r\n                          return (\r\n                              {label: optionHtml, value: optionHtml, isDisabled: isDisabled}\r\n                          )\r\n                      })}\r\n                      id=\"fNames\"\r\n                      placeholder={filter.fName}\r\n                      onChange={(option) =>{console.log(\"option.value +cIndex in onChange: \"+JSON.stringify(option.value)+cIndex); handleFName(option.value, cIndex, index)}}  \r\n                      />\r\n                      </span>\r\n                       <span className=\"selectInputs pb-3\">\r\n                        {filter.fName&&<Select options={[{label: dceFeatures.find(x=>x.featureName===filter[\"fName\"]).featureValue1, value: dceFeatures.find(x=>x.featureName===filter[\"fName\"]).featureValue1},\r\n                        {label: dceFeatures.find(x=>x.featureName===filter[\"fName\"]).featureValue2, value: dceFeatures.find(x=>x.featureName===filter[\"fName\"]).featureValue2}]} \r\n                        placeholder={filter.fValue||\"Enter filter value\"} onChange={(option) => handleFValue(option.value, cIndex, index)}/>}\r\n                    </span>\r\n\r\n            <span>\r\n               <button onClick={(e)=>handleDelete(e,index, cIndex)} className=\"btn  btn-outline-success btn-sm mx-2\"  > <i className=\"material-icons mat-icon\">delete_forever</i></button>\r\n               </span>\r\n          </div>\r\n    ) // end of editHtml pt1\r\n}) // end of filter \r\n\r\ntempEditHtml.push( //html for adding filter form\r\n    <div key={\"addFilterButton\"+cIndex}>\r\n        <span>\r\n               <button onClick={(e)=>handleAddFilter(e, cIndex)} className=\"btn  btn-outline-success btn-sm mx-2\"  > Add filter feature</button>\r\n               </span>\r\n         \r\n              </div>\r\n              ) // end of editHtml pt2\r\n}) // end of combi\r\ntempEditHtml.push( //html for adding filter form\r\n    <div key={`filterform +${currentAsp.id}`}>\r\n                {(!currentAsp.dummy&&Object.keys(currentAsp).length>0)&&<button className=\"btn btn-sm btn-outline-info my-4\" onClick={handleAddCombi}>add combination feature</button>}\r\n        <span>\r\n              {dceFeatures&&<form>\r\n                           \r\n                    <div key=\"agSelectForm\" className=\"selectInputs pb-3\">\r\n                    {currentAsp.ageGender&&<label htmlFor='ageFilter' className=\"\">Optional filters for age and gender of participants </label>}\r\n                        {currentAsp.ageGender&&<Select options={ageOptions} key=\"ageFilter\" isClearable id=\"ageFilter\" name=\"age\" placeholder={currentAsp.ageGender.age|| \"Select age filter ...\"} onChange={(option, name)=>{let value; if(option==null){value=\"\"}else{value=option.value};handleAgeGenderValue(name.name, value, currentAsp.id)}}/>}\r\n                        {currentAsp.ageGender&&<Select options={genderOptions} key=\"genderFilter\" isClearable id=\"genderFilter\" name=\"gender\" placeholder={currentAsp.ageGender.gender|| \"Select gender filter ...\"} onChange={(option, name)=>{let value; if(option==null){value=\"\"}else{value=option.value};handleAgeGenderValue(name.name, value,currentAsp.id)}}/>}\r\n                    </div>\r\n            </form>}\r\n        </span>\r\n\r\n        {(!currentAsp.dummy&&Object.keys(currentAsp).length>0)&&<button  className=\"btn btn-sm btn-outline-info mb-3\" onClick={saveFilters}>save all filters </button>}\r\n    </div>\r\n) // end of aspect\r\n\r\n    setEditHtml(tempEditHtml);\r\n    return\r\n    \r\n}, [currentAsp, currentDce, showAspectsFlag])\r\n   \r\n\r\n    return {editHtml}\r\n    \r\n}\r\n","import React, {useContext, useState } from \"react\";\r\nimport { pemFirestore } from \"../../firebase/config\";\r\nimport { UserContext } from \"../../providers/UserProvider\";\r\nimport NewAspect from \"./NewAspect\";\r\nimport List from \"../view/List\";\r\nimport AgeGender from \"../model/ageGender\";\r\nimport Combi from \"../model/combi\";\r\nimport Aspect from \"../model/aspect\";\r\nimport AspectEditPage from \"../view/AspectEditPage\";\r\n\r\n\r\nexport default function AspectListPage({currentDce, dceId, currentAsp, setCurrentDce, setCurrentAsp}) {\r\n    //Main component for displaying the list of aspects. It includes functionality for adding, deleting, modifying and saving.\r\n    const user = useContext(UserContext);\r\n    const userId = user.uid;\r\n    const [showAspectsFlag, setShowAspectsFlag] = useState('');\r\n    const [refreshListFlag, setRefreshListFlag] = useState('');\r\n    const [filterSaved, setFilterSaved] = useState(false)\r\n    const [showNew, setShowNew] = useState(false);\r\n\r\n\r\n//Saves all filters of all aspects of this dce to the database\r\nconst saveFilters = ()=>{\r\n    const aspectRef = pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('AspectList');\r\n   console.log(\"aspectList in SaveFilters: \"+JSON.stringify(currentDce.aspectList))\r\n    currentDce.aspectList.length>0&& currentDce.aspectList.forEach(aspect=>{//for each aspect save the various parts\r\n        aspectRef.doc(aspect.id).update({ageGender: {age: aspect.ageGender.age, gender: aspect.ageGender.gender}});\r\n        let combiRef = aspectRef.doc(aspect.id).collection('Combis');\r\n       aspect.combiList.length>0&&(aspect.combiList.forEach(combi=>{//for each combi save all filters\r\n            const {filterList, ...restOfCombi} = combi;\r\n            let dbFilterList = [];\r\n            filterList.forEach(filter=>{\r\n                let filterObj = {fName: filter.fName, fValue: filter.fValue};\r\n                dbFilterList.push(filterObj);\r\n            })\r\n            restOfCombi.filterList = dbFilterList;\r\n            console.log(\"restOfCombi is:\"+JSON.stringify(restOfCombi))\r\n            combiRef.doc(combi.nr.toString()).set(Object.assign({}, restOfCombi))\r\n            .then(()=>{\r\n                console.log('combi saved with nr '+combi.nr);\r\n                setFilterSaved(true);//indicator for showing that aspects have been stored to database\r\n            })\r\n            .catch((error)=>{\r\n                console.log('Error saving combi', error);\r\n            })\r\n        }))\r\n    })\r\n}\r\n\r\n\r\n\r\nconst handleAddCombi = ()=>{//adds new combi to the combilist and saves to db\r\n    let newCombiNr = findFreeCombiNr();//finds first available nr as combi id, so deleted nrs can be re-used\r\n    let newCombi = new Combi(newCombiNr, \"\", []);\r\n    currentAsp.combiList.push(newCombi);//adds the new empty combi to the combilist\r\n    setCombi(newCombi);//store to db\r\n    setShowAspectsFlag(\"combi added\"+newCombiNr);//set flag to refresh combilist \r\n}\r\n\r\nconst findFreeCombiNr = ()=>{//finds first available nr as combi id from the combilist, so deleted nrs can be re-used\r\n    let seqNr=0;\r\n    currentAsp.combiList.sort((a,b)=>a.nr-b.nr).forEach(combi=>{\r\n        if(combi.nr!==seqNr){//if seqNr is free, use it\r\n            return seqNr;\r\n        }\r\n        else  {\r\n            seqNr +=1;//try next nr\r\n           }\r\n    })\r\n    return seqNr;\r\n}\r\n\r\n//Saves combi to database for current aspect\r\nconst setCombi = (combi)=>{ \r\n    console.log(\"user en dce en aspect ids: \"+userId+dceId+currentAsp.Id)\r\n    console.log(\"combi nr: \"+combi.nr)\r\n    pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('AspectList').doc(currentAsp.id).collection('Combis').doc(combi.nr.toString())\r\n    .set(Object.assign({}, combi))\r\n    .then(()=>{\r\n        console.log('combi added with nr '+combi.nr);\r\n    })\r\n    .catch((error)=>{\r\n        console.log('Error adding combi', error);\r\n    })\r\n}\r\n\r\n//Deletes a filter combination from the list and database\r\nconst handleDeleteCombi = (e, cIndex)=>{\r\n    pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('AspectList').doc(currentAsp.id).collection('Combis').doc(cIndex.toString())\r\n    .delete().then(() => {\r\n        console.log(\"Combination successfully deleted!\");\r\n        currentAsp.combiList.splice(cIndex, 1);//only delete from list after successful deleting from db\r\n        setShowAspectsFlag(\"combi deleted\"+cIndex);//set flag to refresh combilist - required new content to be seen as change.\r\n    }).catch((error) => {\r\n        console.error(\"Error removing document: \", error);\r\n    });        \r\n}\r\n\r\n//delete a aspect from database and list\r\nconst deleteAspect = (aspect) => {\r\n    let aspectId =aspect.id;\r\n    let aspIndex = currentDce.aspectList.findIndex(asp=>asp.id===aspectId);\r\n    let aspectRef = pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('AspectList').doc(aspectId);\r\n    aspectRef.collection('Combis').get()\r\n    .then((docs)=>{\r\n        docs.forEach(doc=>{\r\n            aspectRef.collection('Combis').doc(doc.id).delete()//delete all subcollections in database first\r\n            .then(()=>{console.log('Combi with ID '+doc.id+ ' deleted')})\r\n        })\r\n    })\r\n    .then(()=>{\r\n        aspectRef.delete()\r\n    .then(() => {\r\n        currentDce.aspectList.splice(aspIndex, 1); //delete scenario from scList after db delete is successful\r\n        console.log(\"Document with ID\"+aspectId+ \"  successfully deleted!\");\r\n        setRefreshListFlag(\"set flag \"+aspectId);//set flag to refresh aspect list\r\n    }).catch((error) => {\r\n        console.error(\"Error removing document: \", error);\r\n    });\r\n    if(currentAsp.id===aspectId){ //if aspectdetails of deleted aspect were shown on screen,  replace with dummy\r\n        setCurrentAsp({dummy: currentAsp.id})    \r\n    }\r\n  })\r\n}\r\n\r\nconst addAspect = (name, descr)=>{//adds aspect to the aspect list and database\r\n    let aspectColl = pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId).collection('AspectList');\r\n    aspectColl.add( {aspectName: name, aspectDescr: descr, ageGender: {age:\"\", gender:\"\"}})\r\n    .then((docRef)=>{\r\n          console.log(\"Document written with ID: \", docRef.id);\r\n          aspectColl.doc(docRef.id).collection('Combis').doc('0').set({nr: 0, groupValue: \"\", filterList: []});\r\n          let newCombiList = [new Combi(0, \"\", [])];//new combi object with id:0 as it will be the first combi in the new aspect\r\n          let ageGender = new AgeGender(\"\",  \"\");\r\n          let newAspect = new Aspect(docRef.id, name, descr, ageGender, newCombiList);//create new aspect object with new combi and ageGender objects\r\n          currentDce.aspectList.push(newAspect);\r\n          setCurrentAsp(newAspect);\r\n          setRefreshListFlag(\"new aspect saved id \"+docRef.id);//set new content to flag to refresh aspect list\r\n    })\r\n    .catch((error) => {\r\n        console.error(\"Error adding document: \", error);\r\n    });\r\n    showNewAspectForm();\r\n}\r\n\r\n//toggle to show or hide form for new aspect\r\n  const showNewAspectForm = ()=>{\r\n      if(showNew){setShowNew(false)}\r\n      else if(!showNew){setShowNew(true)}\r\n  }\r\n\r\n//clears all raw results for this dce\r\nconst clearRawResults = (dceId) =>{\r\nconsole.log(\"clear results activitated\")\r\nconst ref = pemFirestore.collection('users').doc(userId).collection('DceList').doc(dceId.toString()).collection('RawResults')\r\n        ref.onSnapshot((snapshot) => {\r\n          snapshot.docs.forEach((doc) => {\r\n            ref.doc(doc.id).delete()\r\n          })\r\n        })\r\n        return (alert(\"All results for this DCE have been deleted.\"))\r\n}\r\n\r\n  const editFunctions = {saveFilters, handleAddCombi, handleDeleteCombi};//combine some functions needed for edit page\r\n\r\n  //html to show in browser. <List> returns list of aspect. <NewAspect> is component with form for creating new aspect\r\n  // <AspectEditPage> provides component for editing the aspect and displaying its details\r\n    return (\r\n    <div>   \r\n        <div className=\"row my-4\">\r\n            <div className=\"listContainer col col-12 col-sm-3\">\r\n                <List currentDce={currentDce} refreshListFlag={refreshListFlag} setCurrentAsp={setCurrentAsp} deleteAspect={deleteAspect} />\r\n                <div className=\"row my-4\">\r\n                     <div className=\"col-auto  \">\r\n                        <h4><u>Create new Aspect</u></h4>\r\n                        <div> <button className=\"btn btn-sm btn-outline-info\" onClick={showNewAspectForm}> new Aspect</button>\r\n                        </div>\r\n                        {showNew&&<NewAspect dceId={dceId} addAspect={addAspect} setRefreshListFlag={setRefreshListFlag} showNewAspectForm={showNewAspectForm} />}\r\n                     </div>\r\n                     <div className=\"col-auto my-4 \">\r\n                        <h4><u>Clear recorded results for this dce</u></h4>\r\n                        <div> <button className=\"btn btn-sm btn-outline-danger\" onClick={() => { if (window.confirm('You are about to DELETE all results recorded for this dce so far!! Click Ok to continue.')){clearRawResults(currentDce.id)}}}> <b>CLEAR</b></button>\r\n                        </div>\r\n                     </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"col scenarioContainer\">\r\n                <AspectEditPage currentDce={currentDce} currentAsp={currentAsp} showAspectsFlag={showAspectsFlag} setCurrentDce={setCurrentDce} setCurrentAsp={setCurrentAsp} filterSaved={filterSaved} setFilterSaved={setFilterSaved} editFunctions={editFunctions}  />\r\n            </div>\r\n        </div>\r\n    </div>  \r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { pemFirestore } from \"../../firebase/config\";\r\nimport Dce from './dce';\r\nimport GroupedDce from './groupedDce';\r\nimport Scenario from './scenario';\r\nimport Aspect from './aspect';\r\nimport Combi from './combi';\r\nimport AgeGender from './ageGender';\r\n\r\n\r\nconst useGetDceList = (uid) => {\r\n        //React hook that returns a list of Dce objects.\r\n\r\n    const [dceList, setDceList] = useState([]);\r\n    \r\n\r\n        useEffect(()=>{//React hook that loads the list of Dce objects from db and adds it to the dceList . It is triggered by a change in the uid\r\n        pemFirestore.collection('users').doc(uid).collection('DceList').get()\r\n            .then((data)=>{\r\n            let tempDocs = [];\r\n            data.docs.forEach(doc => {\r\n                let dce;\r\n                if(doc.data().grouped){// if this dce is a 'groupedDce' create appropriate type, else create general dce\r\n                dce = new GroupedDce(  doc.id, doc.data().name, doc.data().descr, doc.data().nrQuestions, doc.data().features, doc.data().grouped, doc.data().groupFeature );\r\n                } else {\r\n                    dce = new Dce(doc.id, doc.data().name, doc.data().descr, doc.data().nrQuestions, doc.data().features, doc.data().grouped)\r\n                }\r\n                tempDocs.push(dce)//add this to the list\r\n              });\r\n            setDceList(tempDocs) ;//store dce list after all dce's are added\r\n        }).catch((err)=>{\r\n            console.log('Error with loading dce'+err);\r\n        })\r\n    },[uid])\r\n\r\n\r\n    useEffect(() => { //React hook that loads the list of Scenario objects for each dce from db and adds it to the dce . It is triggered by a change in the dceList\r\n        dceList.forEach(dce=>{\r\n            pemFirestore.collection('users').doc(uid).collection('DceList').doc(dce.id).collection('Scenarios').orderBy('id')\r\n            .get()\r\n            .then((docs)=>{\r\n            let tempDocs = [];\r\n                docs.forEach(doc => {//create a scenario object for each database entry\r\n                    let sc = new Scenario(doc.data().id, doc.data().scText, doc.data().scExpl, doc.data().scImg, doc.data().fValues, doc.data().altSc, doc.data().altnr )\r\n                    tempDocs.push(sc);//add scenario to the temp list.\r\n                });\r\n            dce.scList=tempDocs ;//store the temp list to the dce when complete\r\n            }).catch((err)=>{\r\n                console.log('Error with loading scenario document'+err);\r\n            })\r\n        })\r\n    }, [dceList])\r\n\r\n\r\n    useEffect(() => { //React hook that loads the list of Aspect objects for each dce from db and adds it to the dce . It is triggered by a change in the dceList\r\n        //For each aspect, all combi's are loaded and objects are created. \r\n        dceList.forEach(dce=>{\r\n        pemFirestore.collection('users').doc(uid).collection('DceList').doc(dce.id).collection('AspectList')\r\n        .get()\r\n        .then((aspects)=>{\r\n            let tempAspectList = [];\r\n            aspects.forEach(aspect => {//load combi's for each aspect\r\n                const aspectRef = pemFirestore.collection('users').doc(uid).collection('DceList').doc(dce.id).collection('AspectList').doc(aspect.id);\r\n                     let combiList = [];\r\n                     aspectRef.collection('Combis').get()\r\n                    .then((combis)=>{\r\n                        combis.forEach(combi=>{                              \r\n                        let combiObj = new Combi(combi.data().nr,combi.data().groupValue, combi.data().filterList);\r\n                        combiList.push(combiObj);//add combi to the list of combi's\r\n                         })\r\n                         aspect.data().ageGender&& console.log(\"ageGender: \"+JSON.stringify(aspect.data().ageGender.age))                  \r\n                         let ageGender = new AgeGender(\"\",  \"\");//create empty ageGender variable and fill it with data when data was available in db\r\n                         aspect.data().ageGender&& ( ageGender = new AgeGender(aspect.data().ageGender.age, aspect.data().ageGender.gender));\r\n\r\n                let aspectObj = new Aspect(aspect.id, aspect.data().aspectName, aspect.data().aspectDescr, ageGender, combiList)\r\n                tempAspectList.push(aspectObj);//add aspect to the list\r\n                 });\r\n            dce.aspectList=tempAspectList ;//store aspects in the list\r\n                })\r\n        }).catch((err)=>{\r\n            console.log('Error with loading aspect document'+err);\r\n        }) \r\n        })\r\n    }, [dceList]);\r\n\r\n    return dceList\r\n}\r\n\r\n \r\n\r\nexport default useGetDceList;","import React, { useEffect, useState } from 'react'\r\nimport Select from 'react-select'\r\n\r\nconst useNewDceHtml =( inputProps, groupProps, miscProps, newDce )=> {\r\n   // creates html for formsfields and buttons for the NewDce component\r\nconst {handleEntry, handleInputChange, handleRemoveClick, handleNrQuestionsInput, inputList} = inputProps;\r\nconst {setGroupValue, groupChecked, groupValue, handleCheckbox} = groupProps;\r\nconst {handleAddClick,  saveDce,  nrQuestions} = miscProps;\r\nconst [dceHtml, setDceHtml] = useState([]);\r\n\r\n \r\nuseEffect(()=>{//React hook for creating html for new dce\r\nlet tempHtml = [];\r\n  const options = inputList&&inputList.map((x, i)=>{\r\n    return {label: x.featureName, value: x.featureName}\r\n  })\r\ntempHtml.push(\r\n        <div key=\"i\">\r\n            <form className=\"form-inline\" key=\"form\">\r\n                <div key=\"formdiv\">\r\n                <label htmlFor=\"dceName\" className=\"block\">Name: </label>\r\n                    <input type=\"text\" className=\"form-control mb-2\" name=\"name\"  placeholder=\"DCE name\" id=\"dceName\" key=\"dceName\"\r\n                     onChange={(e)=>handleEntry(e)}></input>\r\n                    </div>\r\n                <div key=\"formdiv2\">\r\n                <label htmlFor=\"descr\" className=\"block\">Description: </label>\r\n                    <textarea type=\"text\" className=\"form-control mb-2\" name=\"descr\" rows=\"3\"  placeholder=\"This text will be displayed in the DCE\" id=\"descr\" key=\"descr\"\r\n                     onChange={(e)=>handleEntry(e)}></textarea>\r\n                    </div>\r\n                  \r\n                {inputList&&inputList.map((x, i) => {\r\n        return (\r\n          <div className=\"row\" key={\"topdiv\"+i}>\r\n              <div className=\"\">\r\n              <label htmlFor={i+\"Fname\"} className=\"\">Feature name: </label>\r\n            <input\r\n            className=\"form-control mb-2\"\r\n              name=\"featureName\"\r\n              required\r\n              id={i +\"Fname\"}\r\n   placeholder=\"Enter feature name\"\r\n              value={x.featureName}\r\n              onChange={e => handleInputChange(e, i)}\r\n            />             \r\n            </div>\r\n           \r\n              <div >\r\n              <label htmlFor={i+\"fV1\"} className=\"\">Feature value 1: </label>\r\n            <input\r\n            className=\"form-control mb-2\"\r\n              name=\"featureValue1\"\r\n              required\r\n              id={i+\"fV1\"}\r\n              key={i+\"fV1\"}\r\n              placeholder=\"Enter value\"\r\n              value={x.featureValue1}\r\n              onChange={e => handleInputChange(e, i)}\r\n            />             \r\n            </div>\r\n              <div >\r\n              <label htmlFor={i+\"fV2\"} className=\"\">Feature value 2: </label>\r\n            <input\r\n            className=\"form-control mb-2\"\r\n              name=\"featureValue2\"\r\n              required\r\n              id={i+\"fV2\"}\r\n              key={i+\"fV2\"}\r\n              placeholder=\"Enter value\"\r\n              value={x.featureValue2}\r\n              onChange={e => handleInputChange(e, i)}\r\n            />             \r\n            </div>\r\n            <div className=\"col col-xs-1\">\r\n            {inputList.length !== 1 && <button\r\n                className=\"btn btn-sm btn-outline-success mb-2\"\r\n                onClick={(e) => handleRemoveClick(e, i)}><i className=\"material-icons mat-icon\">delete_forever</i></button>}\r\n              </div>\r\n              <div>\r\n              {inputList.length - 1 === i && <button className=\"btn btn-sm btn-outline-info mb-2\" onClick={(e)=>handleAddClick(e)}>Add another feature</button>}</div>\r\n           </div>\r\n        );\r\n      })}\r\n      <div>\r\n        <label htmlFor=\"nrChoices\">Nr of questions in DCE</label>\r\n        <input type=\"number\" className=\"col col-xs-1 form-control mb-2\" id=\"nrChoices\" name=\"nrQuestions\"  onChange={(e)=>handleNrQuestionsInput(e)} />\r\n      </div>\r\n      <div key=\"chkbox\">\r\n        <input type=\"checkbox\" name=\"grouped\" id=\"chkGrp\" checked={groupChecked} onChange={handleCheckbox}></input>\r\n        <label htmlFor=\"grouped\" className=\"\">Group by feature </label>\r\n      </div>\r\n      \r\n      <div>\r\n        {groupChecked&&\r\n        <><label className=\"col-xs-6 col-form-label pb-0\" id=\"gr-label\" htmlFor=\"GrFeat\">\r\n            Group feature\r\n          </label>\r\n          <Select className=\"form form-select-sm col-xs-6 mb-2\" id=\"GrFeat\" value={options.label} options={options} onChange={(option) => setGroupValue(option.value)} /></>\r\n          \r\n             }\r\n      </div>\r\n      <button className=\"btn btn-sm btn-outline-success\" onClick={(e)=>saveDce(e)} >Save DCE</button>\r\n          </form>\r\n\r\n        </div>\r\n)\r\nsetDceHtml(tempHtml);\r\n return       \r\n},[inputList, groupValue, nrQuestions, groupChecked, newDce])\r\n\r\nreturn {dceHtml}\r\n    \r\n}\r\nexport default useNewDceHtml;","import React, { useContext, useState } from \"react\";\r\nimport { UserContext } from \"../../providers/UserProvider\";\r\nimport useNewDceHtml from \"../view/useNewDceHtml\";\r\nimport Dce from '../model/dce';\r\nimport GroupedDce from '../model/groupedDce';\r\n\r\nexport default function NewDceForm({showNewDceForm, dceList, setDceListChanged }) {\r\n  //component for creating a new dce including features and general details\r\n\r\n    const [inputList, setInputList] = useState([{ featureName: null, featureValue1: null, featureValue2: null }]);\r\n    const [groupChecked, setGroupChecked] = useState(false);\r\n    const [groupValue, setGroupValue] = useState(null);\r\n    const [nrQuestions, setNrQuestions] = useState(0);\r\n    const [newDce, setNewDce] = useState({descr: \"\"})\r\n    const user = useContext(UserContext);\r\n    const uid = user.uid;\r\n\r\n    //Check if feature names and values are all filled in before save\r\n  const featuresNotNull = (item)=>{\r\nif(item.featureName==null||item.featureName===\"\"){\r\nalert(\"Please fill in all feature names\");\r\nreturn false;\r\n}\r\nif(item.featureValue1==null||item.featureValue1===\"\"||item.featureValue2==null||item.featureValue2===\"\"){\r\n  alert(\"Please fill in all feature values\");\r\n  return false;\r\n}\r\nreturn true;\r\n  }\r\n\r\n//helper for dceNotNull check\r\n  const existsName = (name => newDce.name===name);\r\n\r\n//Check if dce name and number of questions are all filled in before save. Also check if dce name is unique\r\n  const dceNotNull = ()=>{\r\n    let name=newDce.name;\r\n    console.log(\"field not null check, dceName: \"+name)\r\n    if(name===undefined||name===\"\" || (dceList.list.length>0 &&dceList.nameList().some(existsName))){\r\n      alert(\"Fill in a unique DCE name\");\r\n      return false;\r\n    }\r\n    if(newDce.nrQuestions<=0||!newDce.nrQuestions){\r\n      alert(\"Fill in the number of questions (higher than 0) the participant has to answer in the DCE\");\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  //Check if groupValue is not null \r\n  const groupValueNotNull = ()=>{\r\n    if (groupChecked&&groupValue===null){\r\n      alert(\"Please select a value for the group feature\");\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  //Save dce if all fields are filled in\r\n    const saveDce = (e)=>{\r\n        e.preventDefault();\r\n        if(inputList.every(featuresNotNull)&&dceNotNull()&&groupValueNotNull()){\r\n          let dce;\r\n                if(groupChecked){\r\n                dce = new GroupedDce( null, newDce.name, newDce.descr, newDce.nrQuestions, inputList, groupChecked, groupValue, uid);\r\n                } else {\r\n                    dce = new Dce( null, newDce.name, newDce.descr, newDce.nrQuestions, inputList, groupChecked, uid)\r\n                }\r\n            dceList.list&&dceList.addDce(dce)//method that adds the newly created dce to the dceList and database\r\n            .then(dceId=>{setDceListChanged(dceId);//flag to refresh dce list on screen\r\n              console.log(\"return dceId: \"+dceId);\r\n              });\r\n\r\n            showNewDceForm();\r\n        }\r\n    }\r\n\r\n \r\n    \r\n        //Handles entries from input fields\r\n    const handleEntry = (e)=>{\r\n      e.preventDefault();\r\n      const {name, value} = e.target;\r\n      setNewDce(newDce=>({...newDce, [name]: value}));\r\n  }\r\n\r\n    // handle nr questions input change\r\n    const handleNrQuestionsInput = (e) =>{\r\n      e.preventDefault();\r\n      let nrQuestions = 'nrQuestions'\r\n      const nrString = e.target.value;\r\n      let nrQ = 0;\r\n      nrQ = Number(nrString);//converts input to nr\r\n      setNrQuestions(nrQ);//sets nr questions for this dce\r\n      setNewDce(newDce=>({...newDce, [nrQuestions]: nrQ}));//adds nr questions to the new dce\r\n    }\r\n\r\n     // handle feature input change\r\n  const handleInputChange = (e, index) => {\r\n    e.preventDefault();\r\n    const { name, value } = e.target;\r\n    const list = [...inputList];\r\n    list[index][name] = value;\r\n    setInputList(list);\r\n  };\r\n \r\n  // deletes feature in the new dce form\r\n  const handleRemoveClick = (e, index) => {\r\n    e.preventDefault();\r\n    const list = [...inputList];\r\n    list.splice(index, 1);\r\n    setInputList(list);\r\n  };\r\n \r\n  // Adds another feature in the form\r\n  const handleAddClick = (e) => {\r\n    e.preventDefault();\r\n    setInputList([...inputList, { featureName: null , featureValue1: null, featureValue2: null}]);\r\n  }\r\n\r\n  // checkbox for group feature.Inverts value\r\n  const handleCheckbox = ()=>{\r\n   setGroupChecked(!groupChecked);\r\n  }\r\n\r\n  //combine some of the properties that are required for getting the html\r\n  const inputProps =  {handleEntry, handleInputChange, handleRemoveClick, handleNrQuestionsInput, inputList};\r\n  const groupProps = {setGroupValue, groupChecked, groupValue, handleCheckbox};\r\n  const miscProps = {handleAddClick,  saveDce,  nrQuestions};\r\n\r\n  //gets html for this page\r\nconst {dceHtml} = useNewDceHtml(inputProps, groupProps, miscProps, newDce);\r\n\r\n  //html to show in browser\r\n  return (\r\n        <div>\r\n          {dceHtml}\r\n        </div>\r\n    )\r\n}\r\n","import React, {useEffect, useContext, useState } from \"react\";\r\nimport { UserContext } from \"../../providers/UserProvider\";\r\nimport ScenarioListPage from \"../controller/ScenarioListPage\";\r\nimport AspectListPage from \"../controller/AspectListPage\";\r\nimport useGetDceList from \"../model/useGetDceList\";\r\nimport NewDceForm from \"../controller/NewDceForm\";\r\n\r\n\r\nexport default function DceListPage({dceList}) { //Shows list of dce's with icons and framework for editing, configuring aspects and delete, and creating a new dce.\r\n    \r\n    const [showNew, setShowNew] = useState(false);\r\n    const [dceListChanged, setDceListChanged] = useState('');\r\n    const user = useContext(UserContext);\r\n    const uid = user.uid;\r\n    const [currentDce, setCurrentDce] = useState({});\r\n    const [currentSc, setCurrentSc] = useState({});\r\n    const [currentAsp, setCurrentAsp] = useState({});\r\n    const [showScenarioOrAspect, setShowScenarioOrAspect] = useState(true)\r\n    dceList.list = useGetDceList(uid);//loads the list of dce's\r\n    const [listHtml, setListHtml] = useState([])\r\n\r\nuseEffect(() => {//React hook that provides html for the list. Re-rendered when list is changed\r\n    let tempHtmlList = [];\r\n    dceList.list.length>0 && dceList.list.forEach((dce, i)=>{\r\n        tempHtmlList.push(\r\n            <div key={i} className=\"\">\r\n                <h5 className=\"mt-3\"><li  className=\"listRuler mb-1\"  data-id={dce.id}> <b>{dce.name}</b>\r\n                <hr className=\"ruler\"/> \r\n                <button className=\"btn btn-sm btn-outline-warning mx-1\" onClick={()=>{setCurrentDce(dce);setCurrentSc({dummy: dce.id+currentSc.id});setShowScenarioOrAspect(true)}}><i className=\"material-icons mat-icon mt-1\">edit</i></button>\r\n                <hr className=\"rulerSm\"/>\r\n                {dce.grouped&&<button className=\"btn btn-sm btn-outline-danger mx-1\" ><i className=\"material-icons mat-icon mt-1\" onClick={()=>{setCurrentDce(dce);setCurrentAsp({dummy: dce.id+currentAsp.id});setShowScenarioOrAspect(false)}}>settings</i></button>}\r\n                <hr className=\"rulerSm\"/>\r\n                <button className=\"btn  btn-outline-success btn-sm mx-1\" onClick={() => { if (window.confirm('Are you sure you wish to delete this DCE?')){ dceList.deleteDce(dce); setDceListChanged(dce.id); setCurrentDce({dummy: dce.id}); setCurrentSc({dummy:\"sc deleted\"}); setCurrentAsp({dummy: 'asp deleted'}) }} }><i className=\"material-icons mat-icon mt-1\">delete_forever</i></button>\r\n                </li></h5>\r\n            </div>\r\n    )\r\n    })\r\nsetListHtml(tempHtmlList)    \r\n    \r\n}, [dceList.list, dceListChanged])\r\n\r\n\r\n// shows or hide form for new DCE\r\nconst showNewDceForm = ()=>{\r\n    setShowNew(!showNew);\r\n   }\r\n\r\n  //html to show in browser where either the aspectlist or the scenariolist is shown\r\n    return (\r\n    <div>\r\n        <div className=\"row my-4\">\r\n            <div className=\"listContainer col col-12 col-sm-3\">\r\n             <div className=\" col-auto \">\r\n             <h4><u>DCE list</u></h4>\r\n             <ul>\r\n                 {listHtml}\r\n            </ul>\r\n            </div>\r\n                <div className=\"row my-4\">\r\n                    <div className=\"col-auto  \">\r\n                        <h4><u>Create new DCE</u></h4>\r\n                        <div> <button className=\"btn btn-sm btn-outline-info\" onClick={showNewDceForm}> new DCE</button>\r\n                        </div>\r\n                    {dceList.list && showNew&&<NewDceForm showNewDceForm={showNewDceForm} dceList={dceList} setDceListChanged={setDceListChanged}/>}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n{showScenarioOrAspect&&\r\n                <div className=\"col scenarioContainer\">\r\n                    <ScenarioListPage currentDce={currentDce} dceId={currentDce.id} currentSc={currentSc} setCurrentSc={setCurrentSc}/>\r\n                </div>}\r\n                {!showScenarioOrAspect&&\r\n                <div className=\"col scenarioContainer\">\r\n                    <AspectListPage currentDce={currentDce} dceId={currentDce.id} currentAsp={currentAsp} setCurrentDce={setCurrentDce} setCurrentAsp={setCurrentAsp}/>\r\n                </div>}\r\n\r\n        </div>\r\n\r\n    </div>\r\n    )\r\n}\r\n","import React, { useContext, useState } from \"react\";\r\nimport { UserContext } from \"../../providers/UserProvider\";\r\nimport { Link } from \"react-router-dom\";\r\nimport ResultDce from \"./ResultDce\";\r\nimport useGetDceList from \"../model/useGetDceList\";\r\n\r\n export default function DcePlayListPage({dceList}) { // Shows list of dce's with icons for running them or see results (for grouped dce's)\r\n      \r\n    const user = useContext(UserContext);\r\n    const uid = user.uid;\r\n    const [currentDce, setCurrentDce] = useState({});\r\n    dceList.list = useGetDceList(uid);//loads the list of dce's\r\n\r\n\r\n  //html to show in browser\r\n    return (\r\n             <div>\r\n        <div className=\"row my-4\">\r\n            <div className=\"listContainer col col-12 col-sm-3\">\r\n           <div className=\" col-auto \">\r\n            <h4><u>DCE list</u></h4>\r\n            <ul>\r\n            {dceList.list && dceList.list.map((dce, i)=>{\r\n                return(\r\n                    <div key={i} className=\"\">\r\n                        <h5 className=\"mt-3\"><li className=\"listRuler mb-1\"  data-id={dce.id}> <b>{dce.name}</b>\r\n                            <hr className=\"ruler\"/> \r\n                            <Link to={{pathname:\"/app/\"+uid+\"/\"+ dce.id}}>\r\n                            <button className=\"btn btn-sm btn-outline-info mx-1\" ><i className=\"material-icons mat-icon mt-1\">play_circle_outline</i></button>\r\n                            </Link>\r\n                            {dce.grouped&&<button className=\"btn btn-sm btn-outline-danger mx-1\" onClick={()=>{setCurrentDce(dce)}}><i className=\"material-icons mat-icon mt-1\">poll</i></button>} \r\n                        </li></h5>\r\n                    </div>\r\n                )\r\n                })\r\n            }\r\n        </ul>\r\n</div>\r\n                    <div className=\"row my-4\">\r\n                        <div className=\"col-auto  \">\r\n                            <div> \r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n</div>\r\n\r\n<div className=\"col scenarioContainer\">\r\n    <ResultDce  currentDce={currentDce} dceId={currentDce.id} userId={uid} />\r\n</div>\r\n</div>\r\n\r\n</div>\r\n    )\r\n}\r\n","import { pemFirestore } from \"../../firebase/config\";\r\n\r\nclass DceList {//Object representing a list of dce's. All dce's from a user will be created from this object\r\n    constructor(user) {\r\n        this.uid=user.uid;\r\n        this.list = [];\r\n        this.nameList=function(){//Namelist used to check if a new dce name is unique\r\n            let names = [];\r\n           this.list.forEach(dce=>names.push(dce.name));\r\n           return names;\r\n            }\r\n\r\n        this.deleteDce = (dce) =>{//Function for deleting a dce from the list and the database\r\n            let dceId = dce.id;\r\n            let dceIndex = this.list.findIndex(dce=>dce.id===dceId);\r\n            this.list.splice(dceIndex, 1); //delete dce from dceList\r\n            this.clearCollection(dceId, 'Scenarios'); //clear scenarios from db\r\n            this.clearCollection(dceId, 'AspectList'); //clear aspects from db\r\n            this.clearCollection(dceId, 'RawResults'); //clear results from db\r\n            pemFirestore.collection('users').doc(this.uid).collection('DceList').doc(dceId.toString()).delete()\r\n            .then(() => { console.log(\"Document with ID\"+dceId+ \"  successfully deleted!\");\r\n                        })\r\n            .catch((error) => { console.error(\"Error removing document: \", error); });\r\n        }\r\n    \r\n        this.addDce = async (dce) =>{//Function for adding a dce to the list and the database\r\n            this.list.push(dce);\r\n            const {id, scList, ...dceToSave} = dce;//seperate the id (which is null as database creates id and scList from the part that has to be saved to db)\r\n            let dceColl = pemFirestore.collection('users').doc(this.uid).collection('DceList');\r\n            dceColl.add(Object.assign({},dceToSave))\r\n            .then((docRef)=>{\r\n                  console.log(\"Document written with ID: \", docRef.id);\r\n                  dce.id = docRef.id;//set the id of the dce in the list after it's received from the database\r\n                  return docRef.id//return the id as received from the database\r\n            })\r\n            .catch((error) => {\r\n                console.error(\"Error adding document: \", error);\r\n            });\r\n            return dce.name //returns the dce name\r\n        }\r\n\r\n    this.clearCollection = (dceId, collection) =>{//helper function to delete subcollections in firebase. These are not deleted automatically\r\n      console.log(\"path is: \"+collection)  \r\n      const ref = pemFirestore.collection('users').doc(this.uid).collection('DceList').doc(dceId.toString()).collection(collection)\r\n        ref.onSnapshot((snapshot) => {\r\n          snapshot.docs.forEach((doc) => {\r\n            if(collection==='AspectList'){//if AspectList collection is deleted, also delete Combis collection\r\n              ref.doc(doc.id).collection('Combis').onSnapshot((combiSnapshot)=>{\r\n                combiSnapshot.docs.forEach((combiDoc)=>{\r\n                  ref.doc(doc.id).collection('Combis').doc(combiDoc.id).delete()\r\n                  .then(()=>{console.log(\"Combi deleted with id \"+combiDoc.id)})\r\n                })\r\n              })\r\n            }\r\n            ref.doc(doc.id).delete()\r\n            .then(()=>{\r\n              console.log(\"Document deleted with id \"+doc.id+ \" from collection \"+collection)\r\n            })\r\n          })\r\n        })\r\n      }\r\n    } \r\n}\r\nexport default DceList","import React, {useEffect, useState, useContext } from \"react\";\r\nimport { HashRouter as Router, Route, Switch } from \"react-router-dom\";\r\nimport App from \"../../controller/participantApp/App\";\r\nimport SignIn from \"./SignIn\";\r\nimport SignUp from \"./SignUp\";\r\nimport { UserContext } from \"../../../providers/UserProvider\";\r\nimport PasswordReset from \"./PasswordReset\";\r\nimport DceListPage from \"../DceListPage\";\r\nimport DcePlayListPage from \"../DcePlayListPage\";\r\nimport DceList from \"../../model/dceList\";\r\n\r\nfunction Application() {//loads user and routes to pages depending on user, or to signIn pages when not logged in\r\n  const user = useContext(UserContext);\r\n  const [dceList, setDceList] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if(user){\r\n      console.log(\"user is logged in: \"+JSON.stringify(user))\r\n    let getDceList = new DceList(user);//creates new dceList object for this user\r\n    setDceList(getDceList);\r\n    }\r\n  }, [user])\r\n\r\n  //dce can be run without logging in. Other dce pages only available for logged in users\r\n  return (\r\n        user ?\r\n        <Switch>\r\n          <Router>\r\n            <Route exact path=\"/\" ><DceListPage dceList={dceList}/></Route>\r\n            <Route exact path=\"/dcePlayList\" ><DcePlayListPage dceList={dceList}/></Route>\r\n            <Route path=\"/app/:userId/:dceId\" exact component={()=> <App/>} />\r\n        </Router>\r\n      </Switch>\r\n      :\r\n      <Switch>\r\n        <Router>\r\n          <Route exact path=\"/signUp\" > <SignUp/></Route>\r\n          <Route exact path=\"/\" > <SignIn  /></Route>\r\n          <Route exact path=\"/passwordReset\" > <PasswordReset /> </Route>\r\n          <Route exact path=\"/dcePlayList\" ><SignIn /></Route>\r\n          <Route path=\"/app/:userId/:dceId\" exact component={()=> <App/>} />\r\n\r\n        </Router>\r\n      </Switch>\r\n  );\r\n}\r\nexport default Application;","import React  from \"react\";\r\nimport { HashRouter as Router } from \"react-router-dom\";\r\nimport Nav from \"./Nav\";\r\nimport UserProvider from \"../../../providers/UserProvider\";\r\nimport Application from \"./Application\";\r\n\r\n\r\n\r\nfunction MainApp() {//Main module with Nav header and application wrapped in UserProvider component\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Router>\r\n        <UserProvider>\r\n          <Nav />\r\n          <Application/>\r\n        </UserProvider>\r\n      </Router>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MainApp;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/bootstrap.css';\nimport './css/materialize.css';\nimport './index.css';\nimport MainApp from './comps/view/main/MainApp';\n\n//main page that triggers all react files and imports css\nReactDOM.render(\n  <React.StrictMode>\n    <MainApp />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}