(this.webpackJsonppem=this.webpackJsonppem||[]).push([[0],{108:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a(1),s=a.n(n),r=a(33),l=a.n(r),i=(a(64),a(65),a(48),a(11)),o=a(9),u=a(4),d=a(15),j=a(8),b=a.n(j),m=a(10),h=a(17),f=a(36);a(109),a(110),a(68);f.a.initializeApp({apiKey:"AIzaSyDkuqUfQCo8w_7OWogV44gsGLzaE-yEvX4",authDomain:"pem-firestore.firebaseapp.com",projectId:"pem-firestore",storageBucket:"pem-firestore.appspot.com",messagingSenderId:"528017814946",appId:"1:528017814946:web:f8fab7864531498a146efb"});var O=f.a.storage(),p=f.a.firestore(),x=(f.a.firestore.FieldValue.serverTimestamp,f.a.firestore.FieldPath.documentId,f.a.auth()),v=new f.a.auth.GoogleAuthProvider,g=function(){x.signInWithPopup(v)},N=function(){var e=Object(h.a)(b.a.mark((function e(t,a){var c,n,s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return c=p.doc("users/".concat(t.uid)),e.next=5,c.get();case 5:if(e.sent.exists){e.next=16;break}return n=t.email,s=t.displayName,r=t.photoURL,e.prev=8,e.next=11,c.set(Object(m.a)({displayName:s,email:n,photoURL:r},a));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error creating user document",e.t0);case 16:return e.abrupt("return",S(t.uid));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,a){return e.apply(this,arguments)}}(),S=function(){var e=Object(h.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,p.doc("users/".concat(t)).get();case 5:return a=e.sent,e.abrupt("return",Object(m.a)({uid:t},a.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),C=a(28),E=a(21),w=a(29),y=a(55),D=Object(n.createContext)({user:null}),A=function(e){Object(w.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(C.a)(this,a);for(var c=arguments.length,n=new Array(c),s=0;s<c;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={user:null},e.componentDidMount=Object(h.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:x.onAuthStateChanged(function(){var t=Object(h.a)(b.a.mark((function t(a){var c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(a);case 2:c=t.sent,e.setState({user:c}),console.log("User logged in");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e}return Object(E.a)(a,[{key:"render",value:function(){var e=this.state.user;return Object(c.jsx)(D.Provider,{value:e,children:this.props.children})}}]),a}(n.Component);var k=Object(d.i)((function(e){var t,a=Object(n.useContext)(D),s=Object(n.useState)(""),r=Object(u.a)(s,2),l=(r[0],r[1]);return Object(n.useEffect)((function(){var e;a?(e=a.displayName,l(e)):e=""}),[a]),Object(c.jsx)("div",{className:"navigation",children:Object(c.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-dark",children:Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)(i.b,{className:"navbar-brand",to:"/",children:Object(c.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAW1SURBVGhD7ZpbaBxVGMe/mb0k2dy1uVWTJpV4KVJTL01D1baK4IMWwar1QcEqQlGDTxaxpQ++GX0q1JciCGKpFZpSEQxqQRtj0UqMF6RJ2wSJaZum2Wyz2WZv4/efPWd2Zndmd5oL3YX84LCzcz3/c77bHEYhsH+/2tbc/aym0W5SlI28p1zfX6hoWlgjZYBU5eDYrppe7rOmQERrc/eHfPht4j2pM4sFLalpykdjr9XuUdoOTT2nER0pPhESFqOoO1TdnIpWBFBUJZl8S9ViEfhEUQMNquIPFLZjuwAaVLFd9KwIKTRWhBQaSuuhq5wPiXwsyata0wmnTYol8St2OGB3rR2RePpGpV6FMq+YT2iOz/LyM3wZz0jwyVHuHzCE7HmojF66p0TfKYGIUFSj4ekE9Z6LUt9YlKIJcdDE3o0B2nm3X/yzB53c8kWIZmMa+blT3+6opltKrR1799QcnTgfFf+svPNgGb28ztq/YyNR2vfTnL5tmBZuXu5TLK2mRKGWSpUeb/HRgW3ldOzpKmqtMi4x8Huyr7VrBrwZsDm+qckrTrCCiXhijS/rfDxXkt0rwfR1ja5yM0/1uls99OmTlVTlt45kJrgmzrOZ2fLR2ejNMjdQH1B5AE29tsFRSM+ZCHUeDtL24yH6eyptT5ihNzpKxT973v95jjYfmbG0bUdDFDb5iB0t3NlGmxy9fpVH95FcOB5mP9dH8S8W8ebJWd1fJE+t9evT7USI/eDyXNLSJiNJ/Z65QNDYUJ898o/c5hNbzuTRmWJ0JknnZ9KzsppHrb0m91TfCBPh9Ch1NVk7jZnY2pzaB5Od4gGxw5UQDOS5oDVctdcunZC+sZjhi5tX+yx+Ul+mUiP7CBifTdLZ6UUIAZG42BDkc/gbIcymiLAMmtkHG0x+8kCD1/CP0xfjVMmR1A7XQjLxLJ0O3Td+n0yNFDp9X116trfenja1X1hIBYddOxYsxByWF0sFz+6P4+kp3yKc28O96xS5Bc8buhKnMvtU414IRs3MXI5QCrND7JetNiODZxLgcmXwclz3RXA/mxNo4mubhJkF5zW6wAEns0yRuBbSIBxOcolDqhN7OwPU/0K10T5+rEIcsQd11zAHk3kxOKgeIG59ndcI879BKB9GBWKHKyEoBcxRCjllaNKm6BLAf2DrssFEclHKt8aIDwdTg1PCN7iTn3eX6ZmD7EOKopA3vcuCKyEdPDK1pmgxxDeVUcYOJFIUl7KZk6kd0mxPjcdSG8y9nM3bqlMH8KR+9iGs9XgdFnxyCsG04oY9j5ZbFoyODttXqBJUpB2fBY32yjez4og98hUAoy5ZW+3RZwVc4wr8LFfgOMuponAU0r2hlAZ2VtPx7VV6fSWBrX45PC/+2RPlEIN3D9lQwudChnLcWxaX7TWqLgaMsP/gPgsSgmiBiGO+EOFv93dhfqERO5YIOduouEdDKd/r4gwvTU5GNAer0nEUgkGEbcMX/riSoPf65+j5r67pBeBSIzuIZw6KIGJOuD+IHJNDh7OQnl8j9DCX312HZ/RS/vN/5tlExMElxtzB0xNphwcwKViCzkJmZIbDIUY/V3RaDlBPmct9VMboSz4chdws0PGLJvM9cynuqhwqOCGIWn+a3kgHJtIhORfLIqSKK9S6suwmy/F89I7M08l/Y/Q9N5iaG5ZFyL5NARp4sSar3SHyQj6+vhCjXX2z9Cq3//hlyg3LIgS5B+Ezs+XKA4vFEAKHQqKTTTOK6vxkXuvUzNEIq4TmY67IeI45CFiWTM21PsoMN2tRAKW1myXT66Yl0TLTkikSYb4yBuB8XCeJ88jIlU9DSLGzLD5yM1gRUmisCCk0VA7uYbFdvLAGVf/KpsiBBrzLHuRNt7m18NC0hJJMHFDxvRM+FSpKMSyC0/0Ho6+vOpHK96xkzSfBZ/CVDVd2RfPhGWYCIkhRtP8BHVdn5YjM5rcAAAAASUVORK5CYII=",width:"35px",height:"30px",alt:"PEM logo"})}),Object(c.jsx)("div",{children:Object(c.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(c.jsx)("li",{className:"nav-item  ".concat("/"===e.location.pathname?"active":""),children:Object(c.jsx)(i.b,{className:"nav-link",to:"/",children:"Develop"})},"0"),Object(c.jsx)("li",{className:"nav-item  ".concat("/dces"===e.location.pathname?"active":""),children:Object(c.jsx)(i.b,{className:"nav-link",to:"/dces",children:"Run/Results"})},"1"),a?Object(c.jsx)("li",{className:"nav-item",children:Object(c.jsxs)(i.b,{to:"/",className:"nav-link",onClick:function(){x.signOut()},children:["Sign out (",a.displayName,")"]})},"2"):Object(c.jsx)("li",{className:"nav-item",children:Object(c.jsx)(i.b,(t={to:"/",className:"nav-link"},Object(o.a)(t,"to","/"),Object(o.a)(t,"children","Sign in"),t))},"2")]})})]})})})})),F=a(6),I=function(){return Object(c.jsx)("div",{className:"outtro",children:Object(c.jsx)("div",{className:"fixed-action-btn",children:Object(c.jsx)("a",{href:"#modal1",className:" modal-trigger btn-floating red darken-2",children:Object(c.jsx)("i",{className:"material-icons mat-icon",style:{fontSize:"140%"},children:"help_outline"})})})})},V=a(132),L=a(131),G=a(133),P=a(53),R=a.n(P),B=function(e){var t=e.handleClick,a=e.sc1,s=e.sc2,r=e.value,l=e.shownSc,i=e.ageGender,o=Object(n.useState)({}),d=Object(u.a)(o,2),j=d[0],b=d[1];return Object(n.useEffect)((function(){if(a&&s){var e=a.data.fValues,t=s.data.fValues,c=null;"A"===r&&(c={pref:Object(m.a)(Object(m.a)({},e),i),nonPref:Object(m.a)(Object(m.a)({},t),i)}),"B"===r&&(c={pref:Object(m.a)(Object(m.a)({},t),i),nonPref:Object(m.a)(Object(m.a)({},e),i)}),b(c)}}),[a,s,i,r]),Object(c.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(c.jsx)("div",{className:"s10 ",children:l&&Object(c.jsxs)("div",{className:"choice-container",children:[Object(c.jsx)("p",{children:l.data.scText}),Object(c.jsx)("img",{className:"swipe-img choice-container",src:l.data.scImg,alt:""})]})}),l&&Object(c.jsx)("button",{value:r,onClick:function(){t(j)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},T=function(e){var t=e.handleClick,a=e.sc1,s=e.sc2,r=e.dceDescr,l=e.ageGender,i=Object(n.useState)(0),o=Object(u.a)(i,2),d=o[0],j=o[1],b=Object(n.useState)(0),m=Object(u.a)(b,2),h=m[0],f=m[1],O={tabs:{background:"#fff"},label:{fontSize:"100%"}};return Object(c.jsxs)("div",{className:"swiper-container",children:[Object(c.jsx)(G.a,{position:"static",color:"default",children:Object(c.jsxs)(V.a,{indicatorColor:"primary",textColor:"primary",background:"primary",variant:"fullWidth",value:h,onChange:function(e,t){f(t),j(t)},style:O.tabs,children:[Object(c.jsx)(L.a,{style:O.label,label:"option n\xb01"}),Object(c.jsx)(L.a,{style:O.label,label:"option n\xb02"})]})}),Object(c.jsx)("h5",{className:"text-secondary mt-1 mb-0 text-center",children:r}),Object(c.jsxs)(R.a,{enableMouseEvents:!0,index:d,onChangeIndex:function(e){j(e),f(e)},children:[Object(c.jsx)("div",{className:"slide",children:Object(c.jsx)("div",{className:"innerslide",children:Object(c.jsx)(B,{handleClick:t,sc1:a,sc2:s,value:"A",shownSc:a,ageGender:l})})}),Object(c.jsx)("div",{className:"slide",children:Object(c.jsx)("div",{className:"innerslide",children:Object(c.jsx)(B,{handleClick:t,sc1:a,sc2:s,value:"B",shownSc:s,ageGender:l})})})]})]})},U=function(e){var t=e.sc1,a=e.sc2;return Object(c.jsx)("div",{children:Object(c.jsx)("div",{id:"modal1","data-id":"modal1",className:"modal",children:Object(c.jsx)("div",{className:"modal-content black-text modal-close center",children:Object(c.jsxs)("div",{className:"flow-text",children:[Object(c.jsx)("h4",{className:"mb-3",children:"Additional explanation:"}),Object(c.jsx)("h6",{children:Object(c.jsx)("u",{children:"Scenario 1:"})}),t&&Object(c.jsx)("p",{className:"flow-text",children:t.data.scExpl}),t&&0===t.data.scExpl.length&&Object(c.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(c.jsx)("h6",{children:Object(c.jsx)("u",{children:"Scenario 2:"})}),a&&Object(c.jsx)("p",{className:"flow-text",children:a.data.scExpl}),a&&0===a.data.scExpl.length&&Object(c.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(c.jsx)("button",{className:"btn btn-sm blue darken-2 waves-effect waves-light z-depth-2",children:"Close"})]})})})})},K=a(54),M=a.n(K),Q=function(e){var t=e.handleClick,a=e.sc1,n=e.sc2,s=e.dceDescr,r=e.ageGender;return Object(c.jsxs)("div",{className:"pc-view",children:[Object(c.jsx)("h5",{className:"text-secondary mt-1 mb-1",children:s}),Object(c.jsxs)("div",{className:"pc-container",children:[Object(c.jsx)("div",{className:"option-container",children:Object(c.jsx)(B,{handleClick:t,sc1:a,sc2:n,value:"A",shownSc:a,ageGender:r})}),Object(c.jsx)("div",{className:"option-container",children:Object(c.jsx)(B,{handleClick:t,sc2:n,sc1:a,value:"B",shownSc:n,ageGender:r})})]})]})},H=a(24),z=function(e){var t=e.nrQuestions,a=e.setStarted,n=e.handleAGChoice;return Object(c.jsx)("div",{className:"my-5",children:Object(c.jsxs)("div",{className:"col resultsContainer mx-3",children:[Object(c.jsxs)("h5",{children:["Thank you for particpating in this experiment. You will be asked ",t," questions about your preference."]}),Object(c.jsx)("h5",{className:"text-secondary mb-5",children:"Please select your gender and age and then start by clicking the button below. "}),Object(c.jsxs)("div",{className:"col-md-4   mx-auto",children:[" ",Object(c.jsx)("label",{htmlFor:"gender",className:"col-form-label",children:"Gender"}),Object(c.jsx)(H.a,{className:"mb-2",options:[{label:"female",value:"female"},{label:"male",value:"male"}],id:"gender",name:"gender",onChange:function(e,t){return n(e.value,t.name)}})]}),Object(c.jsxs)("div",{className:"col-md-4   mx-auto",children:[" ",Object(c.jsx)("label",{htmlFor:"age",className:"col-form-label",children:"Age"}),Object(c.jsx)(H.a,{className:"mb-4",options:[{label:"younger than 25 years",value:"young"},{label:"25 years or older",value:"old"}],id:"age",name:"age",onChange:function(e,t){return n(e.value,t.name)}})]}),Object(c.jsx)("button",{className:"btn blue darken-2 ",onClick:a,children:"Start"})]})})},q=function(e,t){var a=Object(n.useState)([]),c=Object(u.a)(a,2),s=c[0],r=c[1];return Object(n.useEffect)((function(){if(e&&t){var a=p.collection("users").doc(e).collection("DceList").doc(t).collection("Scenarios").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(m.a)(Object(m.a)({},e.data()),{},{id:e.id}))})),r(t)}));return function(){return a()}}}),[e,t]),{scenarios:s}};function Y(e,t,a,c){var s=Object(n.useState)([]),r=Object(u.a)(s,2),l=r[0],i=r[1];return Object(n.useEffect)((function(){if(e&&t&&a&&c){var n=[];return i(n),void p.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").get().then((function(s){s.forEach((function(s){n.push({aspectName:s.data().aspectName,aspectDescr:s.data().aspectDescr,id:s.id}),p.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").doc(s.id).collection("Combis").get().then((function(e){var t=[];e.forEach((function(e){var n=e.data(),s=[],r=[];s.push.apply(s,Object(F.a)(n.filters)),r.push.apply(r,Object(F.a)(n.filters));var l={fName:a.groupFeature,fValue:e.data().groupValue};if(e.data().ageGender){if(""!==e.data().ageGender.age){var i={fName:"age",fValue:e.data().ageGender.age};s.push(i),r.push(i)}if(""!==e.data().ageGender.gender){var o={fName:"gender",fValue:e.data().ageGender.gender};s.push(o),r.push(o)}}s.push(l);var u="";c.forEach((function(t,c){t.featureName===a.groupFeature&&(t.featureValue1===e.data().groupValue&&(u=t.featureValue2),t.featureValue2===e.data().groupValue&&(u=t.featureValue1))}));var d={fName:a.groupFeature,fValue:u};r.push(d),n.favorFilters=s,n.againstFilters=r,t.push(n)}));var r=[].concat(n);r[n.findIndex((function(e){return e.id===s.id}))].combis=t,i(r)}))}))})).catch((function(e){console.log("Error with loading document"+e)}))}}),[e,t,a,c]),{aspectObjs:l}}function Z(e,t){var a=Object(n.useState)([]),s=Object(u.a)(a,2),r=s[0],l=s[1];Object(n.useEffect)((function(){var a=[];a.push(Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"mb-3",children:" \u0394 P shows the difference in probability that the aspect is true and the probability that the aspect is not true"},"headtext")},"head")),e.forEach((function(e,n){var s=e.aspectDescr,r=[],u=[];e.combis&&e.combis.forEach((function(e){t.filter((function(t){var a=!0;return e.favorFilters.forEach((function(e){e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(a=!1)})),a})).forEach((function(e){-1===r.indexOf(e)&&r.push(e)}));t.filter((function(t){var a=!0;return e.againstFilters.forEach((function(e){e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(a=!1)})),a})).forEach((function(e){-1===u.indexOf(e)&&u.push(e)}))}));var d=0;(u.length>0||r.length>0)&&(d=r.length/(r.length+u.length)*2-1);var j=Math.abs(50*d),b=i(d),m=o(d);a.push(Object(c.jsxs)("div",{className:"pb-2",children:[Object(c.jsx)("span",{className:"text-secondary",children:s},"asp-desc ".concat(n)),Object(c.jsx)("br",{}),Object(c.jsxs)("div",{className:b,children:[Object(c.jsx)("div",{className:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"},"pg-bar-pt1 ".concat(n)),0===d&&Object(c.jsx)("div",{class:"progress-bar bg-teal",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"},"pg-bar-pt2 ".concat(n)),Object(c.jsx)("div",{className:m,role:"progressbar","aria-valuenow":d,"aria-valuemin":"0","aria-valuemax":"100",style:{width:j+"%"},children:(d>=.2||d<=-.2)&&Object(c.jsxs)("span",{className:"sr-only",children:["\u0394 P = ",d.toFixed(2)]},"pg-title ".concat(n))},"pg-bar-pt3 ".concat(n))]},"clNames ".concat(n)),d<.2&&d>-.2&&Object(c.jsxs)("div",{children:["\u0394 P = ",d.toFixed(2)]},"pg-desc ".concat(n)),Object(c.jsxs)("span",{children:["(Chosen ",(100*d).toFixed(0),"% ",d<0?"less":"more"," than the opposite.)"]},"pg-desc2 ".concat(n))]},"graphs ".concat(n))),l(a)})),0===e.length&&l([Object(c.jsx)("div",{children:Object(c.jsx)("h5",{children:"No aspects defined."})})])}),[e,t]);var i=function(e){var t="progress w-80 mx-auto";return e<0&&(t="progress w-80 mx-auto flex-row-reverse"),t},o=function(e){var t="progress-bar bg-teal progress-bar-striped";return e<0&&(t="progress-bar bg-purple progress-bar-striped"),t};return{resultHtml:r}}var W=function(e,t){var a=Object(n.useState)([]),c=Object(u.a)(a,2),s=c[0],r=c[1];return Object(n.useEffect)((function(){if(e&&t){var a=p.collection("users").doc(e).collection("DceList").doc(t).collection("RawResults").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(m.a)(Object(m.a)({},e.data().pref),{},{id:e.id}))})),r(t)}));return function(){return a()}}}),[e,t]),{results:s}};function X(e){var t=e.dceId,a=e.dceDetails,n=e.dceFeatures,s=e.userId,r=W(s,t).results,l=Z(Y(s,t,a.details,n).aspectObjs,r).resultHtml;return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{className:"mb-5",children:[Object(c.jsx)("h3",{children:"Total results from all particpants: "}),l]},"title")},"main")}function J(e){var t=e.resultList,a=e.dceDetails,n=(e.dceNameEdit,e.dceId),s=e.dceFeatures,r=e.userId,l=a.details,i=l.grouped,o=Z(Y(r,n,l,s).aspectObjs,t).resultHtml;return Object(c.jsxs)("div",{className:"my-5",children:[Object(c.jsx)("p",{children:"Thank you for completing this experiment!"}),i&&Object(c.jsxs)("div",{className:"col resultsContainer mx-3",children:[Object(c.jsxs)("div",{className:"mb-5",children:[Object(c.jsx)("h3",{children:"Your results: "}),o]}),Object(c.jsx)(X,{dceDetails:a,dceId:n,dceFeatures:s,userId:r})]})]})}var _=function(e,t,a){var c=[];null!=t&&(c=Object(F.a)(t));for(var n=-1,s=5*e;s>0;s--){var r=Math.floor(Math.random()*e);if(!c.includes(r)){n=r;break}}return-1!==n&&c.push(n),a(c),n},$=function(e,t,a){for(var c=_(e,t,a),n=-1,s=10*e;s>0;s--){var r=Math.floor(Math.random()*e);if(console.log("rndA is "+c+" rndB is "+r),c!==r){n=r;break}}return{RandomNrA:c,RandomNrB:n}};var ee=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)([]),l=Object(u.a)(r,2),i=l[0],o=l[1],j=Object(n.useState)({age:"",gender:""}),b=Object(u.a)(j,2),m=b[0],h=b[1],f=Object(n.useState)(1),O=Object(u.a)(f,2),x=O[0],v=O[1],g=Object(n.useState)([Object(c.jsx)("span",{className:"dot blue darken-2"},"1st done")]),N=Object(u.a)(g,2),S=N[0],C=N[1],E=Object(n.useState)([]),w=Object(u.a)(E,2),y=w[0],D=w[1],A=Object(n.useState)(null),k=Object(u.a)(A,2),V=k[0],L=k[1],G=Object(n.useState)(null),P=Object(u.a)(G,2),R=P[0],B=P[1],K=Object(n.useState)(0),H=Object(u.a)(K,2),Y=H[0],Z=H[1],W=Object(n.useState)(!1),X=Object(u.a)(W,2),ee=X[0],te=X[1],ae=Object(n.useState)(null),ce=Object(u.a)(ae,2),ne=ce[0],se=ce[1],re=Object(n.useState)([]),le=Object(u.a)(re,2),ie=le[0],oe=le[1],ue=Object(n.useState)(null),de=Object(u.a)(ue,2),je=de[0],be=de[1],me=Object(n.useState)(""),he=Object(u.a)(me,2),fe=he[0],Oe=he[1],pe=Object(n.useState)(!1),xe=Object(u.a)(pe,2),ve=xe[0],ge=xe[1],Ne=Object(n.useState)(!1),Se=Object(u.a)(Ne,2),Ce=Se[0],Ee=Se[1],we=Object(n.useState)(""),ye=Object(u.a)(we,2),De=ye[0],Ae=ye[1],ke=Object(d.h)(),Fe=ke.userId,Ie=ke.dceId,Ve=q(Fe,Ie).scenarios,Le=Object(n.useState)(null),Ge=Object(u.a)(Le,2),Pe=Ge[0],Re=Ge[1];Object(n.useEffect)((function(){M.a.AutoInit()}));var Be=function(e){if(e){var t=Object(F.a)(a);t.push(e),s(t)}Te(ee),x+1>Y&&ge(!0),v(x+1),function(e,t,a,n,s){var r=[];(r=Object(F.a)(e)).push(Object(c.jsx)("span",{className:"dot blue darken-2"},"filleddot".concat(s))),t(r);var l=[];(l=Object(F.a)(a)).pop(),n(l)}(S,C,y,D,x)},Te=function(e){if(!e){var t=function(e,t,a){var c=e.length,n=$(c,t,a),s=n.RandomNrA,r=n.RandomNrB;return{ScenarioA:e[s],ScenarioB:e[r]}}(Ve,Pe,Re),a=t.ScenarioA,c=t.ScenarioB;L(a),B(c)}if(e){var n=function(e,t,a,c){var n=e.length,s=e[_(n,a,c)];if(s){var r=s.data.altnr;return{ScenarioA:s,ScenarioB:e.find((function(e){return e.data.nr===r}))}}return t(!0),{ScenarioA:"",ScenarioB:""}}(Ve,ge,Pe,Re),s=n.ScenarioA,r=n.ScenarioB;r?(L(s),B(r)):Be(null)}};return Object(n.useEffect)((function(){if(Ve&&Fe&&Ie){Ae(""),s([]);var e=Ve.map((function(e){return e.data.fValues})).map((function(e){return Object.values(e)})).find((function(e){return""===e[0]}));if(e)return void Ae("All scenario's must have data entered and saved - please contact the researcher.");e||p.collection("users").doc(Fe).collection("DceList").doc(Ie).get().then((function(e){if(e.data().grouped&&Ve.length<2*e.data().nrQuestions||!e.data().grouped&&(Ve.length<e.data().nrQuestions||Ve.length<2))Ae("The scenario's are incomplete - please contact the researcher.");else{Ae("");var t=e.data().grouped;oe(e.data().features);var a={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};be(a),se(e.data().descr.dceDescr),Oe(e.data().name.dceName),Z(e.data().nrQuestions),te(t),D(function(e){for(var t=[],a=0;a<e-1;a++)t.push(Object(c.jsx)("span",{className:"dot"},"emptydot".concat(a)));return t}(e.data().nrQuestions)),0!==Ve.length&&Te(t)}})).catch((function(e){console.error("Error loading document: ",e)}))}}),[Ve,Fe,Ie]),function(e,t,a,c,s){var r=Object(n.useRef)(!0);Object(n.useEffect)((function(){if(r.current)r.current=!1;else{var e=p.collection("users").doc(a).collection("DceList").doc(c).collection("RawResults"),n=[];t.forEach((function(t,a){e.add(t),n.push(t.pref,a)})),s(n)}}),[e])}(ve,a,Fe,Ie,o),Object(c.jsxs)("div",{children:[Object(c.jsx)(U,{sc1:V,sc2:R}),!ve&&!Ce&&Object(c.jsx)(z,{nrQuestions:Y,setStarted:Ee,handleAGChoice:function(e,t){var a=m;a[t]=e,h(a)}}),!ve&&Ce&&!De&&Object(c.jsx)(T,{handleClick:Be,sc1:V,sc2:R,dceDescr:ne,ageGender:m}),!ve&&Ce&&!De&&V&&R&&Object(c.jsx)(Q,{handleClick:Be,sc1:V,sc2:R,dceDescr:ne,ageGender:m}),!ve&&Ce&&!De&&Object(c.jsx)(I,{}),!ve&&Ce&&!De&&Object(c.jsxs)("div",{className:"footer",children:[S,y]}),ve&&Ce&&!De&&Fe&&Ie&&Object(c.jsx)(J,{resultList:i,dceDetails:je,dceNameEdit:fe,dceId:Ie,dceFeatures:ie,userId:Fe}),De&&Object(c.jsx)("div",{className:"text-danger mt-5",children:Object(c.jsxs)("h4",{children:["Error: ",De]})})]})},te=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)(""),l=Object(u.a)(r,2),o=l[0],d=l[1],j=Object(n.useState)(null),b=Object(u.a)(j,2),m=b[0],h=b[1],f=function(e){var t=e.currentTarget,a=t.name,c=t.value;"userEmail"===a?s(c):"userPassword"===a&&d(c)};return Object(c.jsxs)("div",{className:"row justify-content-center",children:[Object(c.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign In"}),Object(c.jsxs)("div",{className:"col-sm-7",children:[null!==m&&Object(c.jsx)("div",{className:"text-danger mb-3",children:m}),Object(c.jsxs)("form",{className:"",children:[Object(c.jsxs)("div",{className:"form-floating",children:[Object(c.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:a,placeholder:"Your email",id:"userEmail",onChange:function(e){return f(e)}}),Object(c.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(c.jsxs)("div",{className:"form-floating ",children:[Object(c.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return f(e)}}),Object(c.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(c.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){!function(e,t,a){e.preventDefault(),x.signInWithEmailAndPassword(t,a).catch((function(e){h("Error signing in with password and email!"),console.error("Error signing in with password and email",e)}))}(e,a,o)},children:"Sign in"})]}),Object(c.jsx)("p",{className:"my-3",children:"or"}),Object(c.jsx)("button",{className:"btn btn-outline-info",onClick:function(){g()},children:"Sign in with Google"}),Object(c.jsxs)("p",{className:"my-3",children:["Don't have an account?"," ",Object(c.jsx)(i.b,{to:"/signUp",className:"text-blue-500 hover:text-blue-600",children:"Sign up here"})," ",Object(c.jsx)("br",{})," ",Object(c.jsx)(i.b,{to:"passwordReset",className:"text-blue-500 hover:text-blue-600",children:"Forgot Password?"})]})]})]})},ae=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)(""),l=Object(u.a)(r,2),o=l[0],d=l[1],j=Object(n.useState)(""),m=Object(u.a)(j,2),f=m[0],O=m[1],p=Object(n.useState)(null),v=Object(u.a)(p,2),S=v[0],C=v[1],E=function(){var e=Object(h.a)(b.a.mark((function e(t,a,c){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,x.createUserWithEmailAndPassword(a,c);case 4:n=e.sent,r=n.user,N(r,{displayName:f}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),C("Error Signing up with email and password");case 12:s(""),d(""),O("");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a,c){return e.apply(this,arguments)}}(),w=function(e){var t=e.currentTarget,a=t.name,c=t.value;"userEmail"===a?s(c):"userPassword"===a?d(c):"displayName"===a&&O(c)};return Object(c.jsxs)("div",{className:"row justify-content-center",children:[Object(c.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign Up"}),Object(c.jsxs)("div",{className:"col-sm-7",children:[null!==S&&Object(c.jsx)("div",{className:"text-danger mb-3",children:S}),Object(c.jsxs)("form",{className:"",children:[Object(c.jsxs)("div",{className:"form-floating",children:[Object(c.jsx)("input",{type:"text",className:"form-control ",name:"displayName",value:f,placeholder:"Display name",id:"displayName",onChange:function(e){return w(e)}}),Object(c.jsx)("label",{htmlFor:"displayName",className:"block",children:"Display Name:"})]}),Object(c.jsxs)("div",{className:"form-floating",children:[Object(c.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:a,placeholder:"Your Email",id:"userEmail",onChange:function(e){return w(e)}}),Object(c.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(c.jsxs)("div",{className:"form-floating",children:[Object(c.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return w(e)}}),Object(c.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(c.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){E(e,a,o)},children:"Sign up"})]}),Object(c.jsx)("p",{className:"my-3",children:"or"}),Object(c.jsx)("button",{className:"btn btn-outline-info",onClick:function(){try{g()}catch(S){console.error("Error signing in with Google",S)}},children:"Sign In with Google"}),Object(c.jsxs)("p",{className:"my-3",children:["Already have an account?"," ",Object(c.jsx)(i.b,{to:"/",className:"text-blue-500 hover:text-blue-600",children:"Sign in here"})," "]})]})]})},ce=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)(!1),l=Object(u.a)(r,2),o=l[0],d=l[1],j=Object(n.useState)(null),b=Object(u.a)(j,2),m=b[0],h=b[1];return Object(c.jsxs)("div",{className:"row justify-content-center",children:[Object(c.jsx)("h1",{className:"text-xl text-center font-bold mb-3",children:"Reset your Password"}),Object(c.jsxs)("div",{className:"col-sm-7",children:[Object(c.jsxs)("form",{action:"",children:[o&&Object(c.jsx)("div",{className:"text-danger mb-3",children:"An email has been sent to you!"}),null!==m&&Object(c.jsx)("div",{className:"text-danger mb-3",children:m}),Object(c.jsxs)("div",{class:"form-floating",children:[Object(c.jsx)("input",{type:"email",name:"userEmail",id:"userEmail",value:a,placeholder:"Input your email",onChange:function(e){var t=e.currentTarget,a=t.name,c=t.value;"userEmail"===a&&s(c)},className:"form-control"}),Object(c.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(c.jsx)("button",{className:"btn btn-outline-info my-3",onClick:function(e){!function(e){e.preventDefault(),x.sendPasswordResetEmail(a).then((function(){d(!0),setTimeout((function(){d(!1)}),3e3)})).catch((function(){h("Error resetting password")}))}(e)},children:"Send me a reset link"})]}),Object(c.jsx)(i.b,{to:"/",className:"my-2 text-blue-700 hover:text-blue-800 text-center block",children:"\u2190 back to sign in page"})]})]})},ne=function(e,t,a){var c=e.target.value,n=Object(F.a)(t);return n[0][a]=c,n},se=function(e,t,a){var s=e.handleNameInputChange,r=e.handleDescrInputChange,l=e.handleInputChange,i=e.handleRemoveClick,o=e.handleNrQuestionsInput,d=e.inputList,j=t.setGroupValue,b=t.groupChecked,m=t.groupValue,h=t.handleCheckbox,f=a.handleAddClick,O=a.saveDce,p=a.nrQuestions,x=Object(n.useState)([]),v=Object(u.a)(x,2),g=v[0],N=v[1];return Object(n.useEffect)((function(){var e=[],t=d&&d.map((function(e,t){return{label:e.featureName,value:e.featureName}}));e.push(Object(c.jsx)("div",{children:Object(c.jsxs)("form",{className:"form-inline",children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("label",{htmlFor:"dceName",className:"block",children:"Name: "}),Object(c.jsx)("input",{type:"text",className:"form-control mb-2",name:"dceName",placeholder:"DCE name",id:"dceName",required:!0,onChange:function(e){return s(e)}})]}),Object(c.jsxs)("div",{className:"",children:[Object(c.jsx)("label",{htmlFor:"descr",className:"block",children:"Description: "}),Object(c.jsx)("textarea",{type:"text",className:"form-control mb-2",name:"descr",rows:"3",placeholder:"This text will be displayed in the DCE",id:"descr",required:!0,onChange:function(e){return r(e)}})]}),d&&d.map((function(e,t){return Object(c.jsxs)("div",{className:" row",children:[Object(c.jsxs)("div",{className:"",children:[Object(c.jsx)("label",{htmlFor:t,className:"",children:"Feature name: "}),Object(c.jsx)("input",{className:"form-control mb-2",name:"featureName",required:!0,id:t,placeholder:"Enter feature name",value:e.featureName,onChange:function(e){return l(e,t)}})]}),Object(c.jsx)("div",{className:"col col-xs-1",children:1!==d.length&&Object(c.jsx)("button",{className:"btn btn-sm btn-outline-success mb-2",onClick:function(e){return i(e,t)},children:Object(c.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})})}),Object(c.jsxs)("div",{children:[Object(c.jsx)("label",{htmlFor:t,className:"",children:"Feature value 1: "}),Object(c.jsx)("input",{className:"form-control mb-2",name:"featureValue1",required:!0,id:t,placeholder:"Enter value",value:e.featureValue1,onChange:function(e){return l(e,t)}})]}),Object(c.jsxs)("div",{children:[Object(c.jsx)("label",{htmlFor:t,className:"",children:"Feature value 2: "}),Object(c.jsx)("input",{className:"form-control mb-2",name:"featureValue2",required:!0,id:t,placeholder:"Enter value",value:e.featureValue2,onChange:function(e){return l(e,t)}})]}),Object(c.jsx)("div",{children:d.length-1===t&&Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info mb-2",onClick:function(e){return f(e)},children:"Add another feature"})})]})})),Object(c.jsxs)("div",{children:[Object(c.jsx)("label",{htmlFor:"nrChoices",children:"Nr of questions in DCE"}),Object(c.jsx)("input",{type:"number",className:"col col-xs-1 form-control mb-2",id:"nrChoices",required:!0,onChange:function(e){return o(e)}})]}),Object(c.jsxs)("div",{children:[Object(c.jsx)("input",{type:"checkbox",name:"group",id:"chkGrp",onClick:function(e){return h(e)}}),Object(c.jsx)("label",{htmlFor:"group",className:"",children:"Group by feature "})]}),Object(c.jsx)("div",{children:b&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("label",{className:"col-xs-6 col-form-label pb-0",id:"gr-label",htmlFor:"GrFeat",children:"Group feature"}),Object(c.jsx)(H.a,{className:"form form-select-sm col-xs-6 mb-2",id:"GrFeat",value:t.label,options:t,onChange:function(e){return j(e.value)}})]})}),Object(c.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){return O(e)},children:"Save DCE"})]})})),N(e)}),[d,m,p,b]),{dceHtml:g}};function re(e){var t=e.showNewDceForm,a=e.dceNameList,s=e.setDceListChanged,r=Object(n.useState)([{featureName:null,featureValue1:null,featureValue2:null}]),l=Object(u.a)(r,2),i=l[0],o=l[1],d=Object(n.useState)([{dceName:""}]),j=Object(u.a)(d,2),b=j[0],m=j[1],h=Object(n.useState)([{dceDescr:""}]),f=Object(u.a)(h,2),O=f[0],x=f[1],v=Object(n.useState)(!1),g=Object(u.a)(v,2),N=g[0],S=g[1],C=Object(n.useState)(null),E=Object(u.a)(C,2),w=E[0],y=E[1],A=Object(n.useState)(0),k=Object(u.a)(A,2),I=k[0],V=k[1],L=Object(n.useContext)(D).uid,G=function(e){return null==e.featureName||""===e.featureName?(alert("Please fill in all feature names"),!1):null!=e.featureValue1&&""!==e.featureValue1&&null!=e.featureValue2&&""!==e.featureValue2||(alert("Please fill in all feature values"),!1)},P=function(e){return b[0].dceName===e},R=se({handleNameInputChange:function(e){e.preventDefault();var t=ne(e,b,"dceName");m(t)},handleDescrInputChange:function(e){e.preventDefault();var t=ne(e,O,"dceDescr");x(t)},handleInputChange:function(e,t){e.preventDefault();var a=e.target,c=a.name,n=a.value,s=Object(F.a)(i);s[t][c]=n,o(s)},handleRemoveClick:function(e,t){e.preventDefault();var a=Object(F.a)(i);a.splice(t,1),o(a)},handleNrQuestionsInput:function(e){e.preventDefault();var t,a=e.target.value;t=Number(a),V(t)},inputList:i},{setGroupValue:y,groupChecked:N,groupValue:w,handleCheckbox:function(e){e.preventDefault();var t=e.target.checked;S(t)}},{handleAddClick:function(e){e.preventDefault(),o([].concat(Object(F.a)(i),[{featureName:null,featureValue1:null,featureValue2:null}]))},saveDce:function(e){(e.preventDefault(),!i.every(G)||(""===b[0].dceName||a.some(P)?(alert("Fill in a unique DCE name"),!0):I<=0&&(alert("Fill in the number of questions (higher than 0) the participant has to answer in the DCE"),!0))||N&&null===w&&(alert("Please select a value for the group feature"),!0))||(p.collection("users").doc(L).collection("DceList").add({name:b[0],descr:O[0],features:i,nrFeatures:i.length,grouped:N,groupFeature:w,nrQuestions:I}).then((function(e){console.log("Document written with ID: ",e.id),s(e.id)})).catch((function(e){console.error("Error adding document: ",e)})),t())},nrQuestions:I}).dceHtml;return Object(c.jsx)("div",{children:R})}var le=function(e){var t=Object(n.useState)(0),a=Object(u.a)(t,2),c=a[0],s=a[1],r=Object(n.useState)(null),l=Object(u.a)(r,2),i=l[0],o=l[1],d=Object(n.useState)(null),j=Object(u.a)(d,2),m=j[0],f=j[1];return Object(n.useEffect)((function(){var t=O.ref(e.name);t.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;s(t)}),(function(e){o(e)}),Object(h.a)(b.a.mark((function e(){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:a=e.sent,f(a);case 4:case"end":return e.stop()}}),e)}))))}),[e]),{progress:c,url:m,error:i}},ie=function(e){var t=e.file,a=e.setFile,s=e.dceId,r=e.scNr,l=e.setUrl,i=le(t,s,r),o=i.progress,u=i.url,d=Object(n.useCallback)((function(e){l(e)}),[l]);return Object(n.useEffect)((function(){u&&(a(null),d(u))}),[u,a,d]),Object(c.jsx)("div",{className:"progress-bar",style:{width:o+"%"}})},oe=function(e){var t=e.dceId,a=e.scNr,s=e.setUrl,r=Object(n.useState)(null),l=Object(u.a)(r,2),i=l[0],o=l[1],d=Object(n.useState)(null),j=Object(u.a)(d,2),b=j[0],m=j[1],h=["image/png","image/jpeg"];return Object(c.jsxs)("div",{children:[Object(c.jsxs)("label",{children:[Object(c.jsx)("input",{type:"file",style:{height:0,width:0},onChange:function(e){var t=e.target.files[0];t&&h.includes(t.type)?(o(t),m("")):(o(null),m("Please select an image file (png or jpg)"))}}),Object(c.jsx)("span",{className:"btn btn-sm btn-outline-info mb-3",children:"Upload image"})]}),Object(c.jsxs)("div",{className:"output",children:[b&&Object(c.jsx)("div",{className:"error",children:b}),i&&Object(c.jsx)("div",{children:i.name}),i&&Object(c.jsx)(ie,{file:i,setFile:o,dceId:t,scNr:a,setUrl:s})]})]})},ue=function(e,t,a,s,r){var l=e.dceId,i=e.dceFeatures,o=t.scNr,d=t.setChosen,j=t.setIsSaved,b=t.isSaved,m=a.handleChosen,h=a.handleSave,f=a.handleEntry,O=a.handleCreateAlt,p=Object(n.useState)([]),x=Object(u.a)(p,2),v=x[0],g=x[1],N=function(e){var t=Object(F.a)(r);t[0].data.scImg=e,d(t),j(!1)};return Object(n.useEffect)((function(){var e=[];e.push(Object(c.jsxs)("div",{children:[s.details&&s.details.grouped&&r[0].data&&Object(c.jsxs)("h5",{children:["Paired with scenario nr: ",r[0].data.altnr]}),Object(c.jsxs)("div",{className:"form-row",children:[Object(c.jsx)("h6",{children:"Features"}),Object(c.jsx)("div",{className:"row",children:r[0].data&&i.map((function(e,t){var a=[{label:e.featureValue1,value:e.featureValue1},{label:e.featureValue2,value:e.featureValue2}];return Object(c.jsxs)("div",{className:"col-md-4  mb-3",children:[" ",Object(c.jsx)("label",{htmlFor:t,className:"col-form-label",children:e.featureName}),Object(c.jsx)(H.a,{options:a,placeholder:r[0].data.fValues[e.featureName],defaultValue:r[0].data.fValues[e.featureName],isDisabled:r[0].data.altSc,onChange:function(t){return m(t.value,e.featureName)},id:t},t)]},t)}))})]},"form-row"),r[0].data&&Object(c.jsxs)("form",{id:"textForm",children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("h6",{children:"Scenario text"}),Object(c.jsx)("textarea",{className:"form-control form-control-sm mb-3",name:"scText",value:r[0].data.scText,placeholder:"Enter scenario text",id:"scText",onChange:function(e){return f(e)}})]}),Object(c.jsxs)("div",{children:[Object(c.jsx)("h6",{children:"Scenario explanation"}),Object(c.jsx)("textarea",{className:"form-control form-control-sm mb-3",type:"text",name:"scExpl",value:r[0].data.scExpl,placeholder:"Enter additional explanatory text",id:"scExpl",onChange:function(e){return f(e)}})]}),Object(c.jsx)("h6",{children:"Scenario image link"}),Object(c.jsx)(oe,{dceId:l,scNr:o,setUrl:N}),r[0].data.scImg&&Object(c.jsx)("img",{src:r[0].data.scImg,className:"scImage",alt:"scenario"}),s.details&&s.details.grouped&&!r[0].data.altnr&&Object(c.jsx)("input",{className:"btn  btn-outline-success mb-3",type:"button",onClick:function(e){return O(e)},value:"Save & Create pair"}),(r[0].data.altnr||!s.details.grouped)&&Object(c.jsx)("input",{className:"btn  btn-outline-success mb-3",onClick:function(e){return h(e)},value:"Save"})]}),b&&Object(c.jsx)("div",{className:b,children:"Scenario has been saved"})]})),g(e)}),[s,r,b]),{scenarioHtml:v}};function de(e){var t=e.dceProps,a=e.scProps,s=t.dceId,r=t.dceFeatures,l=t.dceDetails,i=a.scNr,o=a.setScNr,u=a.chosen,d=a.setChosen,j=a.handleAddScenario,f=a.setIsSaved,O=(a.isSaved,Object(n.useContext)(D).uid),x=function(e){var t,a=l.details.groupFeature,c=e[a];r.forEach((function(e){e.featureName===a&&(e.featureValue1===c&&(t=e.featureValue2),e.featureValue2===c&&(t=e.featureValue1))}));var n=Object(m.a)({},e);return n[a]=t,{altFValueList:n,newFeatValue:t}},v=function(){var e,t=!1;return 0!==u[0].data.scText.length||0!==u[0].data.scImg.length?t=!0:alert("Fill in the Scenario Text or upload a Scenario Image, or do both"),e=!r.some((function(e){return 0===u[0].data.fValues[e.featureName].length&&alert("Select a value for every feature in the scenario"),0===u[0].data.fValues[e.featureName].length})),t&&e},g=function(){var e=Object(h.a)(b.a.mark((function e(t){var a,c,n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),v()&&(p.collection("users").doc(O).collection("DceList").doc(s).collection("Scenarios").doc(i.toString()).set(u[0]),a=u[0].data.fValues,c=u[0].data.altnr,n=x(a),r=n.altFValueList,c&&p.collection("users").doc(O).collection("DceList").doc(s).collection("Scenarios").doc(c.toString()).update({"data.fValues":r}),f(!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=ue({handleChosen:function(e,t){var a=Object(F.a)(u);a[0].data.fValues[t]=e,d(a),f(!1)},handleSave:g,handleEntry:function(e){e.preventDefault();var t=e.target,a=t.name,c=t.value,n=Object(F.a)(u);n[0].data[a]=c,d(n),f(!1)},handleCreateAlt:function(e){var t;v()&&j(i).then((function(a){t=a;var c=Object(F.a)(u),n=u[0].data.fValues,r=x(n).altFValueList;c[0].data.altnr=t,d(c),o(t),g(e).then((function(){d([{}]),p.collection("users").doc(O).collection("DceList").doc(s).collection("Scenarios").doc(t.toString()).get().then((function(e){var a=[e.data()];a[0].data.fValues=r,d(a),p.collection("users").doc(O).collection("DceList").doc(s).collection("Scenarios").doc(t.toString()).set(a[0])}))}))})).catch((function(e){console.log("Error with saving scenario"+e)}))}},t,a,l,u).scenarioHtml;return Object(c.jsx)("div",{children:N},"1")}var je=function(e,t,a){var c=Object(n.useState)([]),s=Object(u.a)(c,2),r=s[0],l=s[1];return Object(n.useEffect)((function(){t&&p.collection("users").doc(e).collection("DceList").doc(t).collection("Scenarios").orderBy("data.nr").get().then((function(e){var t=[];e.docs.forEach((function(e){t.push(Object(m.a)(Object(m.a)({},e.data()),{},{id:e.id}))})),l(t)}))}),[t,e,a]),{scList:r}};function be(e){var t=e.dceNameEdit,a=e.dceId,s=e.dceFeatures,r=e.dceDetails,l=Object(n.useContext)(D).uid,o=Object(n.useState)([{nr:0}]),d=Object(u.a)(o,2),j=d[0],m=d[1],f=Object(n.useState)(""),O=Object(u.a)(f,2),x=O[0],v=O[1],g=Object(n.useState)(""),N=Object(u.a)(g,2),S=N[0],C=N[1],E=Object(n.useState)(!1),w=Object(u.a)(E,2),y=w[0],A=w[1],k=je(l,a,x).scList;Object(n.useEffect)((function(){m([{}]),C(null),A(!1)}),[a]);var F=function(){var e=Object(h.a)(b.a.mark((function e(t){var c,n,r,i,o,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=20;break}return c={},s.forEach((function(e){c[e.featureName]=""})),n=p.collection("users").doc(l).collection("DceList").doc(a).collection("Scenarios").orderBy("data.nr"),e.next=6,n.get();case 6:return r=e.sent,i=1,r.docs.forEach((function(e){e.data().data.nr===i&&(i+=1)})),o=!1,t&&(o=!0),m([{}]),u={data:{nr:i,altnr:t,altSc:o,fValues:c,scText:"",scImg:"",scExpl:""}},p.collection("users").doc(l).collection("DceList").doc(a).collection("Scenarios").doc(i.toString()).set(u),m([u]),C(i),A(!1),v(i.toString()+"created"),e.abrupt("return",i);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(e){var t;m([{}]),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),C(t),p.collection("users").doc(l).collection("DceList").doc(a).collection("Scenarios").doc(t).get().then((function(e){var t=e.data();m([t]),A(!1)})).catch((function(e){console.log("Error with loading scenario"+e)}))},V={dceId:a,dceFeatures:s,dceDetails:r},L={scNr:S,setScNr:C,chosen:j,setChosen:m,handleAddScenario:F,setIsSaved:A,isSaved:y};return Object(c.jsxs)("div",{children:[Object(c.jsxs)("h4",{children:[Object(c.jsx)("u",{children:"Details"})," for ",Object(c.jsxs)("b",{children:[" ",t]}),S&&Object(c.jsxs)("span",{children:[" - Scenario nr. ",S]}),!S&&Object(c.jsx)("span",{children:" - Select a scenario nr."})]}),Object(c.jsx)("div",{className:"",children:Object(c.jsxs)("h6",{children:[r&&a&&Object(c.jsxs)("span",{children:[" ",Object(c.jsx)(i.b,{to:{pathname:"/app/"+l+"/"+a},children:Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(c.jsx)("i",{className:"material-icons mat-icon mt-1",children:"play_circle_outline"})})})]}),r&&a&&Object(c.jsx)("span",{children:" Play this DCE"})," ",r&&a&&Object(c.jsxs)("span",{children:[" ",Object(c.jsx)("hr",{className:"ruler detailsRuler"})," ",Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){var e=window.location.href+"app/"+l+"/"+a;navigator.clipboard.writeText(e)},children:"Copy DCE link "})]})," "]})}),Object(c.jsx)("div",{className:"pb-4",children:Object(c.jsxs)("h6",{children:[" ",r.details&&r.details.grouped&&Object(c.jsxs)("span",{children:["Group feature: ",r.details.groupFeature]})," ",r.details&&Object(c.jsxs)("span",{children:[" ",Object(c.jsx)("hr",{className:"ruler detailsRuler"})," Questions in DCE: ",r.details.nrQuestions]})]})}),Object(c.jsxs)("div",{className:"row",children:[Object(c.jsxs)("div",{className:"scenarioList col col-6 col-md-3 col-sm-5",children:[Object(c.jsx)("h5",{children:"Scenario's"}),Object(c.jsxs)("ul",{children:[Object(c.jsxs)("li",{className:"listRuler mb-1",children:["Nr.  ",Object(c.jsx)("hr",{className:"ruler"})," Edit ",Object(c.jsx)("hr",{className:"rulerSm"}),"\xa0Delete "]},"header"),k&&k.map((function(e,t){return Object(c.jsx)("div",{className:"",children:Object(c.jsx)("h5",{className:"mt-3",children:Object(c.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:I,children:e.data.nr}),Object(c.jsx)("hr",{className:"ruler"}),Object(c.jsxs)("button",{className:"btn  btn-outline-warning btn-sm mx-2",onClick:I,children:[" ",Object(c.jsx)("i",{className:"material-icons mat-icon",children:"edit"})]}),Object(c.jsx)("hr",{className:"rulerSm"}),Object(c.jsxs)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:function(e){window.confirm("Are you sure you wish to delete this scenario?")&&function(e){var t;t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");var c=k.find((function(e){return e.id===t})).data.altnr;p.collection("users").doc(l).collection("DceList").doc(a).collection("Scenarios").doc(t).delete().then((function(){console.log("Scenario with ID "+t+"  successfully deleted!"),t===S&&(C(""),m([{}])),v(t+"deleted"),A(!1)})).catch((function(e){console.error("Error removing document: ",e)})),c&&p.collection("users").doc(l).collection("DceList").doc(a).collection("Scenarios").doc(c.toString()).delete().then((function(){console.log("Alt scenario with ID "+c.toString()+"  successfully deleted!"),v(c+"deleted")})).catch((function(e){console.error("Error removing document: ",e)}))}(e)},children:[" ",Object(c.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]})]})})},t)})),a&&Object(c.jsx)("li",{className:"mb-2",children:Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){return F(null)},children:"Add scenario"})})]})]}),Object(c.jsx)("div",{className:"col",children:Object(c.jsx)(de,{dceProps:V,scProps:L})})]})]})}var me=function(e,t){var a=Object(n.useState)([]),c=Object(u.a)(a,2),s=c[0],r=c[1],l=Object(n.useState)([]),i=Object(u.a)(l,2),o=i[0],d=i[1];return Object(n.useEffect)((function(){p.collection("users").doc(e).collection("DceList").get().then((function(e){var t=[],a=[];e.docs.forEach((function(e){t.push(Object(m.a)(Object(m.a)({},e.data()),{},{id:e.id})),a.push(e.data().name.dceName)})),r(t),d(a)}))}),[e,t]),{dceHtml:s,dceNameList:o}},he=function(e,t){var a=Object(n.useState)("(Click on ICON in DCE list)"),c=Object(u.a)(a,2),s=c[0],r=c[1],l=Object(n.useState)([]),i=Object(u.a)(l,2),o=i[0],d=i[1],j=Object(n.useState)(""),b=Object(u.a)(j,2),m=b[0],h=b[1],f=Object(n.useState)([]),O=Object(u.a)(f,2),x=O[0],v=O[1];return Object(n.useEffect)((function(){var a;e&&(a=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),p.collection("users").doc(t).collection("DceList").doc(a).get().then((function(e){var t=e.data().name.dceName,c={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};r(t),d(e.data().features),h(a),v(c)})).catch((function(e){console.error("Error loading document: ",e)})))}),[e,t]),{dceNameEdit:s,dceFeatures:o,dceId:m,dceDetails:x}};function fe(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)(""),l=Object(u.a)(r,2),o=l[0],d=l[1],j=Object(n.useState)(null),b=Object(u.a)(j,2),m=b[0],h=b[1],f=Object(n.useContext)(D).uid,O=me(f,o),x=O.dceHtml,v=O.dceNameList,g=he(m,f),N=g.dceNameEdit,S=g.dceFeatures,C=g.dceId,E=g.dceDetails,w=function(){a?s(!1):a||s(!0)};return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{className:"row my-4",children:[Object(c.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(c.jsxs)("div",{className:" col-auto ",children:[Object(c.jsx)("h4",{children:Object(c.jsx)("u",{children:"DCE list"})}),Object(c.jsx)("ul",{children:x&&x.map((function(e,t){return Object(c.jsx)("div",{className:"",children:Object(c.jsx)("h5",{className:"mt-3",children:Object(c.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(c.jsx)("b",{children:e.name.dceName}),Object(c.jsx)("hr",{className:"ruler"}),Object(c.jsx)("button",{className:"btn btn-sm btn-outline-warning mx-1",onClick:function(e){h(e)},children:Object(c.jsx)("i",{className:"material-icons mat-icon mt-1",children:"edit"})}),Object(c.jsx)("hr",{className:"rulerSm"}),e.grouped&&Object(c.jsx)(i.b,{to:{pathname:"/aspectList/"+f+"/"+e.id,dceFeatures:e.features,groupFeature:e.groupFeature,dceNameEdit:N},children:Object(c.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",children:Object(c.jsx)("i",{className:"material-icons mat-icon mt-1",children:"settings"})})}),Object(c.jsx)("hr",{className:"rulerSm"}),Object(c.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-1",onClick:function(e){window.confirm("Are you sure you wish to delete this DCE?")&&function(e){var t;t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),p.collection("users").doc(f).collection("DceList").doc(t).delete().then((function(){console.log("Document with ID"+t+"  successfully deleted!"),d(t)})).catch((function(e){console.error("Error removing document: ",e)}))}(e)},children:Object(c.jsx)("i",{className:"material-icons mat-icon mt-1",children:"delete_forever"})})]})})},t)}))})]}),Object(c.jsx)("div",{className:"row my-4",children:Object(c.jsxs)("div",{className:"col-auto  ",children:[Object(c.jsx)("h4",{children:Object(c.jsx)("u",{children:"Create new DCE"})}),Object(c.jsxs)("div",{children:[" ",Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:w,children:" new DCE"})]}),a&&Object(c.jsx)(re,{showNewDceForm:w,setDceListChanged:d,dceNameList:v})]})})]}),Object(c.jsx)("div",{className:"col scenarioContainer",children:Object(c.jsx)(be,{dceNameEdit:N,dceId:C,dceFeatures:S,dceDetails:E})})]})})}function Oe(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(n.useContext)(D).uid,l=me(r).dceHtml,o=he(a,r),d=o.dceFeatures,j=o.dceId,b=o.dceDetails;return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{className:"row my-4",children:[Object(c.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(c.jsxs)("div",{className:" col-auto ",children:[Object(c.jsx)("h4",{children:Object(c.jsx)("u",{children:"DCE list"})}),Object(c.jsx)("ul",{children:l&&l.map((function(e,t){return Object(c.jsx)("div",{className:"",children:Object(c.jsx)("h5",{className:"mt-3",children:Object(c.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(c.jsx)("b",{children:e.name.dceName}),Object(c.jsx)("hr",{className:"ruler"}),Object(c.jsx)(i.b,{to:{pathname:"/app/"+r+"/"+e.id},children:Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(c.jsx)("i",{className:"material-icons mat-icon mt-1",children:"play_circle_outline"})})}),e.grouped&&Object(c.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",onClick:function(e){s(e)},children:Object(c.jsx)("i",{className:"material-icons mat-icon mt-1",children:"poll"})})]})})},t)}))})]}),Object(c.jsx)("div",{className:"row my-4",children:Object(c.jsx)("div",{className:"col-auto  ",children:Object(c.jsx)("div",{})})})]}),Object(c.jsx)("div",{className:"col scenarioContainer",children:Object(c.jsx)(X,{dceDetails:b,dceId:j,dceFeatures:d,userId:r})})]})})}var pe=function(e,t){var a=e.target.value,c=Object(F.a)(t);return c[0]=a,c};function xe(e){var t=e.setShowAspectsFlag,a=e.showNewAspectForm,s=Object(n.useState)(["name"]),r=Object(u.a)(s,2),l=r[0],i=r[1],o=Object(n.useState)(["descr"]),j=Object(u.a)(o,2),b=j[0],m=j[1],h=Object(d.h)(),f=h.userId,O=h.dceId;return Object(c.jsx)("div",{children:Object(c.jsxs)("form",{className:"form-inline",children:[Object(c.jsxs)("div",{className:"form-floating",children:[Object(c.jsx)("input",{type:"text",className:"form-control",name:"aspectName",placeholder:"Aspect name",id:"aspectName",required:!0,onChange:function(e){var t=pe(e,l);i(t)}}),Object(c.jsx)("label",{htmlFor:"aspectName",className:"block",children:"Name: "})]}),Object(c.jsxs)("div",{className:"form-floating",children:[Object(c.jsx)("textarea",{type:"text",rows:"7",className:"form-control",name:"aspectDescr",placeholder:"Description",id:"aspectDescr",required:!0,onChange:function(e){var t=pe(e,b);m(t)}}),Object(c.jsx)("label",{htmlFor:"aspectDescr",className:"block",children:"Description: "})]}),Object(c.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){e.preventDefault();var c=p.collection("users").doc(f).collection("DceList").doc(O).collection("AspectList");c.add({aspectName:l[0],aspectDescr:b[0]}).then((function(e){console.log("Document written with ID: ",e.id),c.doc(e.id).collection("Combis").doc("0").set({nr:0,groupValue:"",filters:[]}),t("new aspect saved id "+e.id)})).catch((function(e){console.error("Error adding document: ",e)})),a()},children:"Save aspect"})]})})}function ve(e){var t=e.aspectProps,a=e.editFunctions,s=e.editProps,r=Object(n.useState)([!1]),l=Object(u.a)(r,2),i=l[0],o=l[1],j=Object(d.g)(),b=j.dceFeatures,m=j.groupFeature,h=Object(d.f)(),f=a.saveFilters,O=a.setAgeGenderValues,p=a.setGroupValues,x=a.setChosenFeatures,v=a.handleAddCombi,g=a.handleDeleteCombi,N=t.aspectId,S=t.aspectNameEdit,C=t.aspectDescr,E=t.aspectFilters,w=s.groupValues,y=s.chosenFeatures,D=s.ageGenderValues;void 0===m&&h.push("/");var A=function(e,t,a,s,r,l,i,o,d,j,b,m,h,f,O){var p=Object(n.useState)([]),x=Object(u.a)(p,2),v=x[0],g=x[1],N=[{}],S=[{label:"younger than 25 years",value:"young"},{label:"25 years or older",value:"old"}],C=[{label:"female",value:"female"},{label:"male",value:"male"}];return Object(n.useEffect)((function(){var n=[];s.forEach((function(s,u){n.push(Object(c.jsxs)("div",{id:u,children:[" ",0!==u&&Object(c.jsxs)("h5",{className:"my-5",children:[Object(c.jsxs)("button",{onClick:function(e){return r(e,u)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(c.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]}),"combined with:"]}),Object(c.jsxs)("h5",{children:["Select value for group feature - ",d]}),Object(c.jsx)("label",{htmlFor:"groupVal",children:"Group value"}),Object(c.jsx)("div",{className:"selectInputs",children:l&&N.map((function(t,n){return Object(c.jsx)(H.a,{options:[{label:l.find((function(e){return e.featureName===d})).featureValue1,value:l.find((function(e){return e.featureName===d})).featureValue1},{label:l.find((function(e){return e.featureName===d})).featureValue2,value:l.find((function(e){return e.featureName===d})).featureValue2}],placeholder:a[u]||"Select...",onChange:function(e){return o(e.value,u)}},"".concat(e,"-grValue- ").concat(u))}))}),Object(c.jsx)("h5",{children:"Saved features and values"})]})),s.forEach((function(e,t){n.push(Object(c.jsxs)("div",{id:t,className:"my-3",children:[Object(c.jsx)("div",{className:"savedFeatures my-2 mx-3 px-5 py-1 p-3 border rounded",children:e.fName}),Object(c.jsx)("span",{className:"savedFeatures mx-3 px-5 py-1 border rounded",children:e.fValue}),Object(c.jsx)("span",{children:Object(c.jsxs)("button",{onClick:function(e){return i(e,t,u)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(c.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]})})]}))})),n.push(Object(c.jsxs)("div",{children:[Object(c.jsxs)("span",{children:[Object(c.jsxs)("form",{children:[Object(c.jsx)("label",{htmlFor:"fNames",className:"col-md-3 col-form-label",children:"Add filter feature "}),Object(c.jsx)("div",{className:"selectInputs",children:Object(c.jsx)(H.a,{options:l&&l.map((function(e,t){var a=e.featureName,c=!1;return e.featureName===d&&(c=!0),{label:a,value:a,isDisabled:c}})),id:"fNames",onChange:function(e){return j(e.value,u)}},"".concat(e,"-fName- ").concat(u))})]}),l&&Object(c.jsxs)("form",{children:[Object(c.jsx)("div",{className:"selectInputs pb-3",children:t[u][0]&&t[u].map((function(a,n){return Object(c.jsx)(H.a,{id:"fValues",options:[{label:l.find((function(e){return e.featureName===t[u][0].fName})).featureValue1,value:l.find((function(e){return e.featureName===t[u][0].fName})).featureValue1},{label:l.find((function(e){return e.featureName===t[u][0].fName})).featureValue2,value:l.find((function(e){return e.featureName===t[u][0].fName})).featureValue2}],placeholder:"Enter filter value",onChange:function(e){return b(e.value,u)}},"".concat(e,"-fValue- ").concat(u))}))}),Object(c.jsxs)("div",{className:"selectInputs pb-3",children:[Object(c.jsx)("label",{htmlFor:"ageFilter",className:"",children:"Optional filters for age and gender of participants "}),f[u]&&Object(c.jsx)(H.a,{options:S,isClearable:!0,id:"ageFilter",name:"age",placeholder:f[u].age||"Select age filter ...",onChange:function(e,t){var a;a=null==e?"":e.value,h(t.name,a,u)}}),f[u]&&Object(c.jsx)(H.a,{options:C,isClearable:!0,id:"genderFilter",name:"gender",placeholder:f[u].gender||"Select gender filter ...",onChange:function(e,t){var a;a=null==e?"":e.value,h(t.name,a,u)}})]})]})]}),Object(c.jsx)("button",{"data-id":u,className:"btn btn-sm btn-outline-info mb-3",onClick:m,children:"save filter feature and group value"}),O[u]&&Object(c.jsx)("h6",{children:"Filter saved"})]}))})),g(n)}),[t,a,f]),{fromDb:v}}({handleDelete:function(e,t,a){e.preventDefault();var c=a.toString(),n=Object(F.a)(E[c]),s=[];E.forEach((function(){s.push([])})),n.splice(t,1),f(c,n,s,w,D)},handleGroupValue:function(e,t){var a=Object(F.a)(w);a[t]=e;var c=Object(F.a)(i);c[t]=!1,p(a),o(c)},handleFName:function(e,t){var a=Object(F.a)(y);a[t][0]={fName:e};var c=Object(F.a)(i);c[t]=!1,x(a),o(c)},handleFValue:function(e,t){var a=Object(F.a)(y);a[t][0].fValue=e;var c=Object(F.a)(i);c[t]=!1,x(a),o(c)},handleSave:function(e){e.preventDefault();var t=e.target.dataset.id,a=[].concat(Object(F.a)(E[t]),Object(F.a)(y[t])),c=Object(F.a)(y);if(c[t][0]&&c[t][0].fName.length>0&&!c[t][0].fValue)alert("Select a value for the filter feature before saving");else if(c[t]=[],0===w[t].length)alert("Select a value for the Group feature before saving");else{f(t,a,c,w,D);var n=Object(F.a)(i);n[t]=!0,o(n)}},handleAgeGenderValue:function(e,t,a){var c=Object(F.a)(D);c[a][e]=t;var n=Object(F.a)(i);n[a]=!1,O(c),o(n)},handleDeleteCombi:g},{aspectId:N,chosenFeatures:y,groupValues:w,groupFeature:m,aspectFilters:E,dceFeatures:b,ageGenderValues:D,filterSaved:i}).fromDb,k=[];return"(Click on ICON in Aspect list)"!==S&&k.push(Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:v,children:"add combination feature"})),Object(c.jsxs)("div",{children:[Object(c.jsxs)("h4",{className:"mb-1",children:["Define aspect for ",Object(c.jsx)("b",{children:S})]}),Object(c.jsxs)("h6",{className:"text-secondary pb-3",children:["Description: ",C]}),A,k]})}var ge=function(e,t,a){var c=Object(n.useState)([]),s=Object(u.a)(c,2),r=s[0],l=s[1];return Object(n.useEffect)((function(){e&&t&&p.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").get().then((function(e){var t=[];e.docs.forEach((function(e){t.push(Object(m.a)(Object(m.a)({},e.data()),{},{id:e.id}))})),l(t)})).catch((function(e){console.log("Error with loading document"+e)}))}),[e,t,a]),{aspects:r}};function Ne(e){var t=e.aspects,a=e.editAspect,n=e.deleteAspect;return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{className:" col-auto ",children:[Object(c.jsx)("h4",{children:Object(c.jsx)("u",{children:"Aspect list"})}),Object(c.jsx)("ul",{children:t&&t.map((function(e,t){return Object(c.jsx)("div",{className:"",children:Object(c.jsx)("h5",{className:"mt-3",children:Object(c.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(c.jsx)("b",{children:e.aspectName}),Object(c.jsx)("hr",{className:"ruler"}),Object(c.jsx)("button",{className:"btn btn-sm btn-outline-warning",onClick:a,children:Object(c.jsx)("i",{className:"material-icons mat-icon",children:"edit"})}),Object(c.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:n,children:Object(c.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})})]},t)})})}))})]})})}var Se=function(){var e=Object(h.a)(b.a.mark((function e(t,a,c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.collection("users").doc(t).collection("DceList").doc(a).collection("AspectList").doc(c).collection("Combis").orderBy("nr","asc").get().then((function(e){for(var n=0,s=0;s<e.docs.length;s++){if(e.docs[s].data().nr!==n)return void Ce(n,t,a,c);n+=1,s===e.docs.length-1&&Ce(n,t,a,c)}})).catch((function(e){console.log("Error adding combi",e)})),e.abrupt("return",c);case 3:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}(),Ce=function(e,t,a,c){p.collection("users").doc(t).collection("DceList").doc(a).collection("AspectList").doc(c).collection("Combis").doc(e.toString()).set({nr:e,groupValue:"",filters:[]}).then((function(){return c})).catch((function(e){console.log("Error adding combi",e)}))};function Ee(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)([]),l=Object(u.a)(r,2),i=l[0],o=l[1],j=Object(n.useState)([]),m=Object(u.a)(j,2),f=m[0],O=m[1],x=Object(n.useState)([]),v=Object(u.a)(x,2),g=v[0],N=v[1],S=Object(n.useState)([{age:"",gender:""}]),C=Object(u.a)(S,2),E=C[0],w=C[1],y=Object(n.useState)(!1),D=Object(u.a)(y,2),A=D[0],k=D[1],I=Object(n.useState)("(Click on ICON in Aspect list)"),V=Object(u.a)(I,2),L=V[0],G=V[1],P=Object(n.useState)(""),R=Object(u.a)(P,2),B=R[0],T=R[1],U=Object(n.useState)(""),K=Object(u.a)(U,2),M=K[0],Q=K[1],H=Object(d.h)(),z=H.userId,q=H.dceId,Y=ge(z,q,a).aspects,Z=function(e){var t=[],a=p.collection("users").doc(z).collection("DceList").doc(q).collection("AspectList").doc(e);a.get().then((function(c){var n=c.data().aspectName,s=[],r=[],l=[];a.collection("Combis").get().then((function(e){e.docs.forEach((function(e){s.push(e.data().filters),t.push([]),r.push(e.data().groupValue),e.data().ageGender&&l.push(e.data().ageGender),e.data().ageGender||l.push({age:"",gender:""})})),N(r),w(l),T(c.data().aspectDescr),O(s),o(t)})).catch((function(e){console.log("Error loading aspect data",e)})),G(n),Q(e)})).catch((function(e){console.log("Error loading aspect data",e)}))},W=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Se(z,q,M).then((function(e){Z(e)})).catch((function(e){console.log("Error with adding document"+e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(h.a)(b.a.mark((function e(t){var a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.parentElement.parentElement.getAttribute("data-id")?t.target.parentElement.parentElement.getAttribute("data-id"):t.target.parentElement.getAttribute("data-id"),(c=p.collection("users").doc(z).collection("DceList").doc(q).collection("AspectList").doc(a)).collection("Combis").get().then((function(e){e.forEach((function(e){c.collection("Combis").doc(e.id).delete().then((function(){console.log("Combi with ID "+e.id+" deleted")}))}))})).then((function(){c.delete().then((function(){console.log("Document with ID"+a+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),a===M&&(Q(""),T(""),G("(Click on ICON in Aspect list)"),O([]),o([])),s("set flag "+a)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){A?k(!1):A||k(!0)},_={saveFilters:function(e,t,a,c,n){p.collection("users").doc(z).collection("DceList").doc(q).collection("AspectList").doc(M).collection("Combis").doc(e).update({filters:t,groupValue:c[e],ageGender:n[e]}).then((function(){var c=Object(F.a)(f);c[e]=t,O(c),o(a),console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))},setGroupValues:N,setAgeGenderValues:w,setChosenFeatures:o,handleAddCombi:W,handleDeleteCombi:function(e,t){p.collection("users").doc(z).collection("DceList").doc(q).collection("AspectList").doc(M).collection("Combis").doc(t.toString()).delete().then((function(){console.log("Combination successfully deleted!"),Z(M)})).catch((function(e){console.error("Error removing document: ",e)}))}},$={ageGenderValues:E,groupValues:g,chosenFeatures:i},ee={aspectId:M,aspectNameEdit:L,aspectDescr:B,aspectFilters:f};return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{className:"row my-4",children:[Object(c.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(c.jsx)(Ne,{aspects:Y,editAspect:function(e){var t;t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),Z(t)},deleteAspect:X}),Object(c.jsx)("div",{className:"row my-4",children:Object(c.jsxs)("div",{className:"col-auto  ",children:[Object(c.jsx)("h4",{children:Object(c.jsx)("u",{children:"Create new Aspect"})}),Object(c.jsxs)("div",{children:[" ",Object(c.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:J,children:" new Aspect"})]}),A&&Object(c.jsx)(xe,{dceId:q,setShowAspectsFlag:s,showNewAspectForm:J})]})})]}),Object(c.jsx)("div",{className:"col scenarioContainer",children:Object(c.jsx)(ve,{aspectProps:ee,editFunctions:_,editProps:$})})]})})}var we=function(){return Object(n.useContext)(D)?Object(c.jsx)(d.c,{children:Object(c.jsxs)(i.a,{children:[Object(c.jsx)(d.a,{exact:!0,path:"/",children:Object(c.jsx)(fe,{})}),Object(c.jsx)(d.a,{exact:!0,path:"/dces",children:Object(c.jsx)(Oe,{})}),Object(c.jsx)(d.a,{path:"/aspectList/:userId/:dceId",exact:!0,component:function(){return Object(c.jsx)(Ee,{})}}),Object(c.jsx)(d.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(c.jsx)(ee,{})}})]})}):Object(c.jsx)(d.c,{children:Object(c.jsxs)(i.a,{children:[Object(c.jsxs)(d.a,{exact:!0,path:"/signUp",children:[" ",Object(c.jsx)(ae,{})]}),Object(c.jsxs)(d.a,{exact:!0,path:"/",children:[" ",Object(c.jsx)(te,{})]}),Object(c.jsxs)(d.a,{exact:!0,path:"/passwordReset",children:[" ",Object(c.jsx)(ce,{})," "]}),Object(c.jsx)(d.a,{exact:!0,path:"/dces",children:Object(c.jsx)(te,{})}),Object(c.jsx)(d.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(c.jsx)(ee,{})}})]})})};var ye=function(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(i.a,{children:Object(c.jsxs)(A,{children:[Object(c.jsx)(k,{}),Object(c.jsx)(we,{})]})})})};l.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(ye,{})}),document.getElementById("root"))},48:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){}},[[108,1,2]]]);
//# sourceMappingURL=main.c9df1342.chunk.js.map