(this.webpackJsonppem=this.webpackJsonppem||[]).push([[0],{109:function(e,t,c){"use strict";c.r(t);var a=c(0),n=c(1),s=c.n(n),r=c(32),l=c.n(r),i=(c(64),c(65),c(48),c(9)),o=c(4),u=c(16),d=c(8),j=c.n(d),b=c(14),m=c(13),f=c(36);c(110),c(111),c(68);f.a.initializeApp({apiKey:"AIzaSyDkuqUfQCo8w_7OWogV44gsGLzaE-yEvX4",authDomain:"pem-firestore.firebaseapp.com",projectId:"pem-firestore",storageBucket:"pem-firestore.appspot.com",messagingSenderId:"528017814946",appId:"1:528017814946:web:f8fab7864531498a146efb"});var h=f.a.storage(),O=f.a.firestore(),p=(f.a.firestore.FieldValue.serverTimestamp,f.a.firestore.FieldPath.documentId,f.a.auth()),x=new f.a.auth.GoogleAuthProvider,g=function(){p.signInWithPopup(x)},v=function(){var e=Object(m.a)(j.a.mark((function e(t,c){var a,n,s,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a=O.doc("users/".concat(t.uid)),e.next=5,a.get();case 5:if(e.sent.exists){e.next=16;break}return n=t.email,s=t.displayName,r=t.photoURL,e.prev=8,e.next=11,a.set(Object(b.a)({displayName:s,email:n,photoURL:r},c));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error creating user document",e.t0);case 16:return e.abrupt("return",N(t.uid));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,c){return e.apply(this,arguments)}}(),N=function(){var e=Object(m.a)(j.a.mark((function e(t){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,O.doc("users/".concat(t)).get();case 5:return c=e.sent,e.abrupt("return",Object(b.a)({uid:t},c.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),S=c(27),y=c(21),E=c(28),w=c(55),C=Object(n.createContext)({user:null}),D=function(e){Object(E.a)(c,e);var t=Object(w.a)(c);function c(){var e;Object(S.a)(this,c);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={user:null},e.componentDidMount=Object(m.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.onAuthStateChanged(function(){var t=Object(m.a)(j.a.mark((function t(c){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(c);case 2:a=t.sent,e.setState({user:a}),console.log("Logged in, user: "+JSON.stringify(a));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e}return Object(y.a)(c,[{key:"render",value:function(){var e=this.state.user;return Object(a.jsx)(C.Provider,{value:e,children:this.props.children})}}]),c}(n.Component);var A=Object(u.i)((function(e){var t=Object(n.useContext)(C),c=Object(n.useState)(t),s=Object(o.a)(c,2),r=(s[0],s[1]);return Object(n.useEffect)((function(){r(p.currentUser)})),Object(a.jsx)("div",{className:"navigation",children:Object(a.jsx)("nav",{class:"navbar navbar-expand navbar-dark bg-dark",children:Object(a.jsxs)("div",{class:"container",children:[Object(a.jsx)(i.b,{class:"navbar-brand",to:"/",children:Object(a.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAW1SURBVGhD7ZpbaBxVGMe/mb0k2dy1uVWTJpV4KVJTL01D1baK4IMWwar1QcEqQlGDTxaxpQ++GX0q1JciCGKpFZpSEQxqQRtj0UqMF6RJ2wSJaZum2Wyz2WZv4/efPWd2Zndmd5oL3YX84LCzcz3/c77bHEYhsH+/2tbc/aym0W5SlI28p1zfX6hoWlgjZYBU5eDYrppe7rOmQERrc/eHfPht4j2pM4sFLalpykdjr9XuUdoOTT2nER0pPhESFqOoO1TdnIpWBFBUJZl8S9ViEfhEUQMNquIPFLZjuwAaVLFd9KwIKTRWhBQaSuuhq5wPiXwsyata0wmnTYol8St2OGB3rR2RePpGpV6FMq+YT2iOz/LyM3wZz0jwyVHuHzCE7HmojF66p0TfKYGIUFSj4ekE9Z6LUt9YlKIJcdDE3o0B2nm3X/yzB53c8kWIZmMa+blT3+6opltKrR1799QcnTgfFf+svPNgGb28ztq/YyNR2vfTnL5tmBZuXu5TLK2mRKGWSpUeb/HRgW3ldOzpKmqtMi4x8Huyr7VrBrwZsDm+qckrTrCCiXhijS/rfDxXkt0rwfR1ja5yM0/1uls99OmTlVTlt45kJrgmzrOZ2fLR2ejNMjdQH1B5AE29tsFRSM+ZCHUeDtL24yH6eyptT5ihNzpKxT973v95jjYfmbG0bUdDFDb5iB0t3NlGmxy9fpVH95FcOB5mP9dH8S8W8ebJWd1fJE+t9evT7USI/eDyXNLSJiNJ/Z65QNDYUJ898o/c5hNbzuTRmWJ0JknnZ9KzsppHrb0m91TfCBPh9Ch1NVk7jZnY2pzaB5Od4gGxw5UQDOS5oDVctdcunZC+sZjhi5tX+yx+Ul+mUiP7CBifTdLZ6UUIAZG42BDkc/gbIcymiLAMmtkHG0x+8kCD1/CP0xfjVMmR1A7XQjLxLJ0O3Td+n0yNFDp9X116trfenja1X1hIBYddOxYsxByWF0sFz+6P4+kp3yKc28O96xS5Bc8buhKnMvtU414IRs3MXI5QCrND7JetNiODZxLgcmXwclz3RXA/mxNo4mubhJkF5zW6wAEns0yRuBbSIBxOcolDqhN7OwPU/0K10T5+rEIcsQd11zAHk3kxOKgeIG59ndcI879BKB9GBWKHKyEoBcxRCjllaNKm6BLAf2DrssFEclHKt8aIDwdTg1PCN7iTn3eX6ZmD7EOKopA3vcuCKyEdPDK1pmgxxDeVUcYOJFIUl7KZk6kd0mxPjcdSG8y9nM3bqlMH8KR+9iGs9XgdFnxyCsG04oY9j5ZbFoyODttXqBJUpB2fBY32yjez4og98hUAoy5ZW+3RZwVc4wr8LFfgOMuponAU0r2hlAZ2VtPx7VV6fSWBrX45PC/+2RPlEIN3D9lQwudChnLcWxaX7TWqLgaMsP/gPgsSgmiBiGO+EOFv93dhfqERO5YIOduouEdDKd/r4gwvTU5GNAer0nEUgkGEbcMX/riSoPf65+j5r67pBeBSIzuIZw6KIGJOuD+IHJNDh7OQnl8j9DCX312HZ/RS/vN/5tlExMElxtzB0xNphwcwKViCzkJmZIbDIUY/V3RaDlBPmct9VMboSz4chdws0PGLJvM9cynuqhwqOCGIWn+a3kgHJtIhORfLIqSKK9S6suwmy/F89I7M08l/Y/Q9N5iaG5ZFyL5NARp4sSar3SHyQj6+vhCjXX2z9Cq3//hlyg3LIgS5B+Ezs+XKA4vFEAKHQqKTTTOK6vxkXuvUzNEIq4TmY67IeI45CFiWTM21PsoMN2tRAKW1myXT66Yl0TLTkikSYb4yBuB8XCeJ88jIlU9DSLGzLD5yM1gRUmisCCk0VA7uYbFdvLAGVf/KpsiBBrzLHuRNt7m18NC0hJJMHFDxvRM+FSpKMSyC0/0Ho6+vOpHK96xkzSfBZ/CVDVd2RfPhGWYCIkhRtP8BHVdn5YjM5rcAAAAASUVORK5CYII=",width:"35px",height:"30px"})}),Object(a.jsx)("div",{children:Object(a.jsxs)("ul",{class:"navbar-nav ml-auto",children:[Object(a.jsx)("li",{class:"nav-item  ".concat("/"===e.location.pathname?"active":""),children:Object(a.jsx)(i.b,{class:"nav-link",to:"/",children:"Develop"})}),Object(a.jsx)("li",{class:"nav-item  ".concat("/dces"===e.location.pathname?"active":""),children:Object(a.jsx)(i.b,{class:"nav-link",to:"/dces",children:"Run/Results"})}),Object(a.jsx)("li",{className:"nav-item",children:Object(a.jsx)(i.b,{to:"/",className:"nav-link",onClick:function(){p.signOut()},children:"Sign out"})})]})})]})})})})),F=c(7),k=(c(77),function(){return Object(a.jsx)("div",{className:"outtro",children:Object(a.jsx)("div",{className:"fixed-action-btn",children:Object(a.jsx)("a",{href:"#modal1",className:" modal-trigger btn-floating red darken-2",children:Object(a.jsx)("i",{className:"material-icons mat-icon",style:{fontSize:"140%"},children:"help_outline"})})})})}),I=c(133),V=c(132),L=c(134),J=c(53),R=c.n(J),B=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=e.value,l=e.shownSc,i=Object(n.useState)({}),u=Object(o.a)(i,2),d=u[0],j=u[1];return Object(n.useEffect)((function(){if(c&&s){var e=c.data.fValues,t=s.data.fValues,a=null;"A"===r&&(a={pref:e,nonPref:t}),"B"===r&&(a={pref:t,nonPref:e}),j(a)}}),[c,s]),Object(a.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(a.jsx)("div",{className:"s10 ",children:l&&Object(a.jsxs)("div",{className:"choice-container",children:[Object(a.jsx)("p",{children:l.data.scText}),Object(a.jsx)("img",{className:"swipe-img choice-container",src:l.data.scImg,alt:"Image not loaded"})]})}),l&&Object(a.jsx)("button",{value:r,onClick:function(){t(d)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},P=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=e.dceDescr,l=Object(n.useState)(0),i=Object(o.a)(l,2),u=i[0],d=i[1],j=Object(n.useState)(0),b=Object(o.a)(j,2),m=b[0],f=b[1],h={tabs:{background:"#fff"},label:{fontSize:"100%"}};return Object(a.jsxs)("div",{className:"swiper-container",children:[Object(a.jsx)(L.a,{position:"static",color:"default",children:Object(a.jsxs)(I.a,{indicatorColor:"primary",textColor:"primary",background:"primary",variant:"fullWidth",value:m,onChange:function(e,t){f(t),d(t)},style:h.tabs,children:[Object(a.jsx)(V.a,{style:h.label,label:"option n\xb01"}),Object(a.jsx)(V.a,{style:h.label,label:"option n\xb02"})]})}),Object(a.jsx)("h5",{class:"text-secondary mt-1 mb-0 text-center",children:r}),Object(a.jsxs)(R.a,{enableMouseEvents:!0,index:u,onChangeIndex:function(e){d(e),f(e)},children:[Object(a.jsx)("div",{className:"slide",children:Object(a.jsx)("div",{className:"innerslide",children:Object(a.jsx)(B,{handleClick:t,sc1:c,sc2:s,value:"A",shownSc:c})})}),Object(a.jsx)("div",{className:"slide",children:Object(a.jsx)("div",{className:"innerslide",children:Object(a.jsx)(B,{handleClick:t,sc1:c,sc2:s,value:"B",shownSc:s})})})]})]})},T=function(e){var t=e.nrQuestions,c=e.sc1,n=e.sc2;return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{id:"introModal",className:"modal",children:Object(a.jsxs)("div",{className:"modal-content black-text modal-close center",children:[Object(a.jsx)("h4",{children:"Intro"}),Object(a.jsxs)("p",{className:"flow-text",children:["There are ",t," choices to make during this experiment. In each dilemma, choose one from the two options."]}),Object(a.jsxs)("p",{className:"flow-text",children:[Object(a.jsx)("i",{className:"material-icons danger red darken-2 btn-floating btn-sm",style:{color:"#ffff",fontSize:"140%",margin:"15px"},children:"help_outline"}),"shows additional explanation of each dilemma."]})]})}),Object(a.jsx)("div",{id:"modal1","data-id":"modal1",className:"modal",children:Object(a.jsx)("div",{className:"modal-content black-text modal-close center",children:Object(a.jsxs)("div",{className:"flow-text",children:[Object(a.jsx)("h4",{className:"mb-3",children:"Additional explanation:"}),Object(a.jsx)("h6",{children:Object(a.jsx)("u",{children:"Scenario 1:"})}),c&&Object(a.jsx)("p",{className:"flow-text",children:c.data.scExpl}),c&&0===c.data.scExpl.length&&Object(a.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(a.jsx)("h6",{children:Object(a.jsx)("u",{children:"Scenario 2:"})}),n&&Object(a.jsx)("p",{className:"flow-text",children:n.data.scExpl}),n&&0===n.data.scExpl.length&&Object(a.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(a.jsx)("button",{className:"btn btn-sm blue darken-2 waves-effect waves-light z-depth-2",children:"Close"})]})})})]})},U=c(54),G=c.n(U),q=function(e){var t=e.handleClick,c=e.sc1,n=e.sc2,s=e.dceDescr;return Object(a.jsxs)("div",{className:"pc-view",children:[Object(a.jsx)("h5",{class:"text-secondary mt-1 mb-1",children:s}),Object(a.jsxs)("div",{className:"pc-container",children:[Object(a.jsx)("div",{className:"option-container",children:Object(a.jsx)(B,{handleClick:t,sc1:c,sc2:n,value:"A",shownSc:c})}),Object(a.jsx)("div",{className:"option-container",children:Object(a.jsx)(B,{handleClick:t,sc2:n,sc1:c,value:"B",shownSc:n})})]})]})},K=function(e,t){var c=Object(n.useState)([]),a=Object(o.a)(c,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){if(t){console.log("user en dce id in loadResults: "+e+" "+t);var c=O.collection("users").doc(e).collection("DceList").doc(t).collection("RawResults").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(b.a)(Object(b.a)({},e.data().pref),{},{id:e.id}))})),r(t)}));return function(){return c()}}}),[t]),{results:s}};function M(e){var t=e.dceId,c=(e.dceNameEdit,e.dceDetails),s=e.dceFeatures,r=e.userId,l=Object(n.useState)([]),i=Object(o.a)(l,2);i[0],i[1],Object(u.g)();console.log("user and dce id in ResultDce: "+JSON.stringify(r)+" "+t),console.log("dceDetails in ResultDce start: "+JSON.stringify(c));var d=K(r,t).results,j=Object(n.useState)(null),b=Object(o.a)(j,2),m=(b[0],b[1],function(e,t){var c=Object(n.useState)([]),s=Object(o.a)(c,2),r=s[0],l=s[1];Object(n.useEffect)((function(){var c=[];console.log("all aspectObj is: "+JSON.stringify(e)),e.forEach((function(e){var n=e.aspectName,s=e.aspectDescr,r=[],o=[];console.log("aspectObj is: "+JSON.stringify(e)),e.combis&&(console.log("combi if entered"),e.combis.forEach((function(e){console.log("combi: "+JSON.stringify(e)),e.nr,t.filter((function(t){var c=!0;return e.favorFilters.forEach((function(e){console.log("forEach favFilter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){console.log(" forEach favor "+JSON.stringify(e)),-1===r.indexOf(e)&&r.push(e)})),t.filter((function(t){var c=!0;return e.againstFilters.forEach((function(e){console.log("forEach againstFilter: "+JSON.stringify(e)),console.log("result in forEach: "+JSON.stringify(t)),e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){console.log(" forEach against "+JSON.stringify(e)),-1===o.indexOf(e)&&o.push(e),console.log("oddsAgainst: "+JSON.stringify(o))}))}))),o.length>0&&(r.length,o.length);var d=r.length/(r.length+o.length)*2-1,j=Math.abs(50*d),b=i(d),m=u(d);console.log("oddsFavor: "+JSON.stringify(r)),c.push(Object(a.jsxs)("div",{children:["Aspect: ",n," ",Object(a.jsx)("br",{}),Object(a.jsx)("span",{className:"text-secondary",children:s}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{className:b,children:[Object(a.jsx)("div",{className:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"}),0===d&&Object(a.jsx)("div",{class:"progress-bar bg-teal",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"}),Object(a.jsx)("div",{className:m,role:"progressbar","aria-valuenow":d,"aria-valuemin":"0","aria-valuemax":"100",style:{width:j+"%"},children:(d>=.1||d<=-.1)&&Object(a.jsxs)("span",{className:"sr-only",children:["\u0394 P = ",d.toFixed(2)]})})]}),d<.1&&d>-.1&&Object(a.jsxs)("div",{children:["\u0394 P = ",d.toFixed(2)]})]})),console.log("resultHtml: "+JSON.stringify(c)),l(c)}))}),[e]);var i=function(e){var t="progress w-80 mx-auto";return e<0&&(t="progress w-80 mx-auto flex-row-reverse"),console.log("clNames: "+t),t},u=function(e){var t="progress-bar bg-teal progress-bar-striped";return e<0&&(t="progress-bar bg-purple progress-bar-striped"),t};return r}(function(e,t,c,a){var s=Object(n.useState)([]),r=Object(o.a)(s,2),l=r[0],i=r[1];return Object(n.useEffect)((function(){if(t&&c){console.log("DceId in useEffect: "+t);var n=[];O.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").get().then((function(s){s.forEach((function(s){console.log("Aspects just loaded, in docs.forEach, doc: "+JSON.stringify(s.data())),n.push({aspectName:s.data().aspectName,aspectDescr:s.data().aspectDescr,id:s.id}),O.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").doc(s.id).collection("Combis").get().then((function(e){console.log("tempAspectObjs at start: "+JSON.stringify(n));var t=[];e.forEach((function(e){console.log("doc.is is: "+s.id);var n=e.data(),r=[],l=[];r.push.apply(r,Object(F.a)(n.filters)),l.push.apply(l,Object(F.a)(n.filters)),console.log("favorFilters is : "+JSON.stringify(r));var i={fName:c.groupFeature,fValue:e.data().groupValue};r.push(i);var o="";a.map((function(t,a){console.log("Feature: "+JSON.stringify(t.featureName)),t.featureName===c.groupFeature&&(console.log("Group feat ===featureName"),t.featureValue1===e.data().groupValue&&(o=t.featureValue2),t.featureValue2===e.data().groupValue&&(o=t.featureValue1))}));var u={fName:c.groupFeature,fValue:o};l.push(u),console.log("tempFilter: "+JSON.stringify(n)),n.favorFilters=r,n.againstFilters=l,console.log("tempFilter: "+JSON.stringify(n)),console.log("groupFeature: "+c.groupFeature+" favorFilters: "+JSON.stringify(r)+"  againstFilters: "+JSON.stringify(l)),t.push(n),console.log("Combis in snap: "+JSON.stringify(t)+JSON.stringify(s.id))})),console.log("doc.is is: "+s.id);var r=[].concat(n),l=n.findIndex((function(e){return e.id===s.id}));console.log("index2: "+JSON.stringify(l)),r[l].combis=t,console.log("newtempObjs before setting: "+JSON.stringify(r)),i(r)}))}))}))}}),[t]),l}(r,t,c.details,s),d));return Object(a.jsxs)("div",{children:[Object(a.jsx)("h4",{children:"Some of the results for the experiment so far:"}),Object(a.jsx)("div",{className:"mb-3",children:" \u0394 P shows the difference in probability that the aspect is true and the probability that the aspect is not true"}),m]})}var Q=function(e){var t=e.dceDetails,c=e.dceNameEdit,n=e.dceId,s=e.dceFeatures,r=e.userId;return Object(a.jsxs)("div",{className:"my-5",children:[Object(a.jsx)("p",{children:"Thank you for completing this experiment!"}),Object(a.jsx)("div",{className:"col resultsContainer mx-3",children:Object(a.jsx)(M,{dceDetails:t,dceNameEdit:c,dceId:n,dceFeatures:s,userId:r})})]})},z=function(e,t){var c=Object(n.useState)([]),a=Object(o.a)(c,2),s=a[0],r=a[1];return Object(n.useEffect)((function(){var c=O.collection("users").doc(e).collection("DceList").doc(t).collection("Scenarios").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id}))})),r(t)}));return function(){return c()}}),[]),{scenarios:s}};var H=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(1),l=Object(o.a)(r,2),i=l[0],d=l[1],j=Object(n.useState)([Object(a.jsx)("span",{class:"dot blue darken-2"})]),b=Object(o.a)(j,2),m=b[0],f=b[1],h=Object(n.useState)([]),p=Object(o.a)(h,2),x=p[0],g=p[1],v=Object(n.useState)(null),N=Object(o.a)(v,2),S=N[0],y=N[1],E=Object(n.useState)(null),w=Object(o.a)(E,2),C=w[0],D=w[1],A=Object(n.useState)(null),I=Object(o.a)(A,2),V=I[0],L=I[1],J=Object(n.useState)(null),R=Object(o.a)(J,2),B=R[0],U=R[1],K=Object(n.useState)(0),M=Object(o.a)(K,2),H=M[0],Z=M[1],Y=Object(n.useState)(!1),W=Object(o.a)(Y,2),X=W[0],_=W[1],$=Object(n.useState)(null),ee=Object(o.a)($,2),te=ee[0],ce=ee[1],ae=Object(n.useState)([]),ne=Object(o.a)(ae,2),se=ne[0],re=ne[1],le=Object(n.useState)(null),ie=Object(o.a)(le,2),oe=ie[0],ue=ie[1],de=Object(n.useState)(""),je=Object(o.a)(de,2),be=je[0],me=je[1],fe=Object(n.useState)(!1),he=Object(o.a)(fe,2),Oe=he[0],pe=he[1],xe=Object(u.h)(),ge=xe.userId,ve=xe.dceId,Ne=z(ge,ve).scenarios,Se=Object(n.useRef)(!0);Object(n.useEffect)((function(){G.a.AutoInit()}));var ye=function(e){var t=Object(F.a)(c);t.push(e),s(t),we(X),i+1>H&&pe(!0),d(i+1),Ee()},Ee=function(){var e=[];(e=Object(F.a)(m)).push(Object(a.jsx)("span",{class:"dot blue darken-2"})),f(e);var t=[];(t=Object(F.a)(x)).pop(),g(t)},we=function(e){if(!e){var t=De(),c=t.ScenarioA,a=t.ScenarioB;y(c),D(a)}if(e){var n=Ce(),s=n.ScenarioA,r=n.ScenarioB;y(s),D(r)}},Ce=function(){var e=Ne.length,t=Ae(e),c=Ne[t];if(c){var a=c.data.altnr;return{ScenarioA:c,ScenarioB:Ne.find((function(e){return e.data.nr===a}))}}return pe(!0),{ScenarioA:"",ScenarioB:""}},De=function(){var e=Fe(),t=e.RandomNrA,c=e.RandomNrB;return{ScenarioA:Ne[t],ScenarioB:Ne[c]}},Ae=function(e){var t=[];null!=V&&(t=Object(F.a)(V));for(var c=-1,a=5*Ne.length;a>0;a--){var n=Math.floor(Math.random()*e);if(!t.includes(n)){c=n;break}}return-1!==c&&t.push(c),L(t),c},Fe=function(){var e=[];null!=B&&(e=Object(F.a)(B));for(var t=Ne.length,c=Ae(t),a=-1,n=10*Ne.length;n>0;n--){var s=Math.floor(Math.random()*t);if(c!==s){a=s;break}}return-1!==a&&e.push(a),U(e),{RandomNrA:c,RandomNrB:a}};return Object(n.useEffect)((function(){O.collection("users").doc(ge).collection("DceList").doc(ve).get().then((function(e){var t=e.data().grouped;re(e.data().features);var c={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};ue(c),ce(e.data().descr.dceDescr),me(e.data().name.dceName),Z(e.data().nrQuestions),_(t),function(e){for(var t=[],c=0;c<e-1;c++)t.push(Object(a.jsx)("span",{class:"dot"}));g(t)}(e.data().nrQuestions),0!==Ne.length&&we(t)}))}),[Ne]),Object(n.useEffect)((function(){if(Se.current)Se.current=!1;else{var e=O.collection("users").doc(ge).collection("DceList").doc(ve).collection("RawResults");c.map((function(t,c){e.add(t)}))}}),[Oe]),Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(T,{nrQuestions:H,sc1:S,sc2:C}),!Oe&&Object(a.jsx)(P,{handleClick:ye,sc1:S,sc2:C,dceDescr:te}),!Oe&&S&&C&&Object(a.jsx)(q,{handleClick:ye,sc1:S,sc2:C,dceDescr:te}),Oe&&ge&&ve&&Object(a.jsx)(Q,{dceDetails:oe,dceNameEdit:be,dceId:ve,dceFeatures:se,userId:ge}),!Oe&&Object(a.jsx)(k,{}),!Oe&&Object(a.jsxs)("div",{className:"footer",children:[m,x]})]})},Z=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(""),l=Object(o.a)(r,2),u=l[0],d=l[1],j=Object(n.useState)(null),b=Object(o.a)(j,2),m=b[0],f=b[1],h=function(e){var t=e.currentTarget,c=t.name,a=t.value;"userEmail"===c?s(a):"userPassword"===c&&d(a)};return Object(a.jsxs)("div",{className:"row justify-content-center",children:[Object(a.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign In"}),Object(a.jsxs)("div",{className:"col-sm-7",children:[null!==m&&Object(a.jsx)("div",{className:"text-danger mb-3",children:m}),Object(a.jsxs)("form",{className:"",children:[Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your email",id:"userEmail",onChange:function(e){return h(e)}}),Object(a.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(a.jsxs)("div",{className:"form-floating ",children:[Object(a.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:u,placeholder:"Your Password",id:"userPassword",onChange:function(e){return h(e)}}),Object(a.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){!function(e,t,c){e.preventDefault(),console.log("signing in w pw n email "+JSON.stringify(t)),p.signInWithEmailAndPassword(t,c).catch((function(e){f("Error signing in with password and email!"),console.error("Error signing in with password and email",e)}))}(e,c,u)},children:"Sign in"})]}),Object(a.jsx)("p",{className:"my-3",children:"or"}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(){g()},children:"Sign in with Google"}),Object(a.jsxs)("p",{className:"my-3",children:["Don't have an account?"," ",Object(a.jsx)(i.b,{to:"/signUp",className:"text-blue-500 hover:text-blue-600",children:"Sign up here"})," ",Object(a.jsx)("br",{})," ",Object(a.jsx)(i.b,{to:"passwordReset",className:"text-blue-500 hover:text-blue-600",children:"Forgot Password?"})]})]})]})},Y=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(""),l=Object(o.a)(r,2),u=l[0],d=l[1],b=Object(n.useState)(""),f=Object(o.a)(b,2),h=f[0],O=f[1],x=Object(n.useState)(null),N=Object(o.a)(x,2),S=N[0],y=N[1],E=function(){var e=Object(m.a)(j.a.mark((function e(t,c,a){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,p.createUserWithEmailAndPassword(c,a);case 4:n=e.sent,r=n.user,v(r,{displayName:h}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),y("Error Signing up with email and password");case 12:s(""),d(""),O("");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,c,a){return e.apply(this,arguments)}}(),w=function(e){var t=e.currentTarget,c=t.name,a=t.value;"userEmail"===c?s(a):"userPassword"===c?d(a):"displayName"===c&&O(a)};return Object(a.jsxs)("div",{className:"row justify-content-center",children:[Object(a.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign Up"}),Object(a.jsxs)("div",{className:"col-sm-7",children:[null!==S&&Object(a.jsx)("div",{className:"text-danger mb-3",children:S}),Object(a.jsxs)("form",{className:"",children:[Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"text",className:"form-control ",name:"displayName",value:h,placeholder:"Display name",id:"displayName",onChange:function(e){return w(e)}}),Object(a.jsx)("label",{htmlFor:"displayName",className:"block",children:"Display Name:"})]}),Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your Email",id:"userEmail",onChange:function(e){return w(e)}}),Object(a.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:u,placeholder:"Your Password",id:"userPassword",onChange:function(e){return w(e)}}),Object(a.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){E(e,c,u)},children:"Sign up"})]}),Object(a.jsx)("p",{className:"my-3",children:"or"}),Object(a.jsx)("button",{className:"btn btn-outline-info",onClick:function(){try{g()}catch(S){console.error("Error signing in with Google",S)}},children:"Sign In with Google"}),Object(a.jsxs)("p",{className:"my-3",children:["Already have an account?"," ",Object(a.jsx)(i.b,{to:"/",className:"text-blue-500 hover:text-blue-600",children:"Sign in here"})," "]})]})]})},W=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(!1),l=Object(o.a)(r,2),u=l[0],d=l[1],j=Object(n.useState)(null),b=Object(o.a)(j,2),m=b[0],f=b[1];return Object(a.jsxs)("div",{className:"row justify-content-center",children:[Object(a.jsx)("h1",{className:"text-xl text-center font-bold mb-3",children:"Reset your Password"}),Object(a.jsxs)("div",{className:"col-sm-7",children:[Object(a.jsxs)("form",{action:"",children:[u&&Object(a.jsx)("div",{className:"text-danger mb-3",children:"An email has been sent to you!"}),null!==m&&Object(a.jsx)("div",{className:"text-danger mb-3",children:m}),Object(a.jsxs)("div",{class:"form-floating",children:[Object(a.jsx)("input",{type:"email",name:"userEmail",id:"userEmail",value:c,placeholder:"Input your email",onChange:function(e){var t=e.currentTarget,c=t.name,a=t.value;"userEmail"===c&&s(a)},className:"form-control"}),Object(a.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(a.jsx)("button",{className:"btn btn-outline-info my-3",onClick:function(e){!function(e){e.preventDefault(),p.sendPasswordResetEmail(c).then((function(){d(!0),setTimeout((function(){d(!1)}),3e3)})).catch((function(){f("Error resetting password")}))}(e)},children:"Send me a reset link"})]}),Object(a.jsx)(i.b,{to:"/",className:"my-2 text-blue-700 hover:text-blue-800 text-center block",children:"\u2190 back to sign in page"})]})]})},X=function(e,t,c){var a=e.target.value,n=Object(F.a)(t);return console.log("name ande nameList in handleInputD: "+a+" "+JSON.stringify(n)),n[0][c]=a,n},_=c(35),$=function(e,t,c,s,r,l,i,u,d,j,b,m){var f=Object(n.useState)([]),h=Object(o.a)(f,2),O=h[0],p=h[1];return Object(n.useEffect)((function(){var n=[];c&&c.map((function(e,t){return Object(a.jsx)("option",{value:e.featureName,children:e.featureName},t)}));var o=c&&c.map((function(e,t){return{label:e.featureName,value:e.featureName}}));n.push(Object(a.jsx)("div",{children:Object(a.jsxs)("form",{className:"form-inline",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{htmlFor:"dceName",className:"block",children:"Name: "}),Object(a.jsx)("input",{type:"text",className:"form-control mb-2",name:"dceName",placeholder:"DCE name",id:"dceName",required:!0,onChange:function(t){return e(t)}})]}),Object(a.jsxs)("div",{className:"",children:[Object(a.jsx)("label",{htmlFor:"descr",className:"block",children:"Description: "}),Object(a.jsx)("textarea",{type:"text",className:"form-control mb-2",name:"descr",rows:"3",placeholder:"This text will be displayed in the DCE",id:"descr",required:!0,onChange:function(e){return t(e)}})]}),c&&c.map((function(e,t){return Object(a.jsxs)("div",{className:" row",children:[Object(a.jsxs)("div",{className:"",children:[Object(a.jsx)("label",{htmlFor:t,className:"",children:"Feature name: "}),Object(a.jsx)("input",{className:"form-control mb-2",name:"featureName",required:!0,id:t,placeholder:"Enter feature name",value:e.featureName,onChange:function(e){return s(e,t)}})]}),Object(a.jsx)("div",{className:"col col-xs-1",children:1!==c.length&&Object(a.jsx)("button",{className:"btn btn-sm btn-outline-success mb-2",onClick:function(){return r(t)},children:Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})})}),Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{htmlFor:t,className:"",children:"Feature value 1: "}),Object(a.jsx)("input",{className:"form-control mb-2",name:"featureValue1",required:!0,id:t,placeholder:"Enter value",value:e.featureValue1,onChange:function(e){return s(e,t)}})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{htmlFor:t,className:"",children:"Feature value 2: "}),Object(a.jsx)("input",{className:"form-control mb-2",name:"featureValue2",required:!0,id:t,placeholder:"Enter value",value:e.featureValue2,onChange:function(e){return s(e,t)}})]}),Object(a.jsx)("div",{children:c.length-1===t&&Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info mb-2",onClick:function(e){return u(e)},children:"Add another feature"})})]})})),Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{htmlFor:"nrChoices",children:"Nr of questions in DCE"}),Object(a.jsx)("input",{type:"number",className:"col col-xs-1 form-control mb-2",id:"nrChoices",required:!0,onChange:function(e){return l(e)}})]}),Object(a.jsxs)("div",{children:[d&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("label",{className:"col-xs-6 col-form-label pb-0",id:"gr-label",htmlFor:"GrFeat",children:"Group feature"}),Object(a.jsx)(_.a,{className:"form form-select-sm col-xs-6 mb-2",id:"GrFeat",value:o.label,options:o,onChange:function(e){return i(e.value)}})]}),console.log("options are: "+JSON.stringify(o)),"      "]}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){return j(e)},children:"Save DCE"})]})})),console.log("tempHtml van newDce: "+JSON.stringify(n)),p(n)}),[c,b,m]),{dceHtml:O}};function ee(e){var t=e.showDceList,c=e.showNewDceForm,s=e.dceNameList,r=Object(n.useState)([{featureName:null,featureValue1:null,featureValue2:null}]),l=Object(o.a)(r,2),i=l[0],u=l[1],d=Object(n.useState)([{dceName:""}]),j=Object(o.a)(d,2),b=j[0],m=j[1],f=Object(n.useState)([{dceDescr:""}]),h=Object(o.a)(f,2),p=h[0],x=h[1],g=Object(n.useState)(!0),v=Object(o.a)(g,2),N=v[0],S=(v[1],Object(n.useState)(null)),y=Object(o.a)(S,2),E=y[0],w=y[1],D=Object(n.useState)(0),A=Object(o.a)(D,2),k=A[0],I=A[1],V=Object(n.useContext)(C).uid;Object(n.useEffect)((function(){console.log("nrQuestions changed. nr is "+k)}),[k]);var L=function(e){return null==e.featureName||""===e.featureName?(alert("Please fill in all feature names"),!1):null!=e.featureValue1&&""!==e.featureValue1&&null!=e.featureValue2&&""!==e.featureValue2||(alert("Please fill in all feature values"),!1)},J=function(e){return b[0].dceName===e},R=(i.map((function(e,t){return Object(a.jsx)("option",{value:e.featureName,children:e.featureName},t)})),$((function(e){console.log("start handleNameInput, dceName is: "+JSON.stringify(b));var t=X(e,b,"dceName");m(t)}),(function(e){var t=X(e,p,"dceDescr");x(t)}),i,(function(e,t){console.log("start handleInput");var c=e.target,a=c.name,n=c.value,s=Object(F.a)(i);s[t][a]=n,u(s)}),(function(e){var c=Object(F.a)(i);c.splice(e,1),u(c),t()}),(function(e){console.log("handleNrQ started, nrString is: "+e.target.value);var t,c=e.target.value;t=Number(c),console.log("nrQ is "+t),I(t)}),w,(function(){u([].concat(Object(F.a)(i),[{featureName:null,featureValue1:null,featureValue2:null}]))}),N,(function(e){(e.preventDefault(),!i.every(L)||(console.log("dceNotNull check - dceName is: "+b[0].dceName+" nrQuestions is: "+k),""===b[0].dceName||s.some(J)?(alert("Fill in a unique DCE name"),!0):k<=0&&(alert("Fill in the number of questions the participant has to answer in the DCE"),!0))||null===E&&(alert("Please select a value for the group feature"),!0))||(O.collection("users").doc(V).collection("DceList").add({name:b[0],descr:p[0],features:i,nrFeatures:i.length,grouped:N,groupFeature:E,nrQuestions:k}).then((function(e){console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)})),t(),c())}),E,k).dceHtml);return Object(a.jsx)("div",{children:R})}var te=function(e,t){var c=Object(n.useState)(0),a=Object(o.a)(c,2),s=a[0],r=a[1],l=Object(n.useState)(null),i=Object(o.a)(l,2),u=i[0],d=i[1],b=Object(n.useState)(null),f=Object(o.a)(b,2),p=f[0],x=f[1],g=Object(n.useContext)(C).uid;return Object(n.useEffect)((function(){var c=h.ref(e.name);O.collection("users").doc(g).collection("DceList").doc(t).collection("Scenarios");c.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;r(t)}),(function(e){d(e)}),Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getDownloadURL();case 2:t=e.sent,x(t);case 4:case"end":return e.stop()}}),e)}))))}),[e]),{progress:s,url:p,error:u}},ce=function(e){var t=e.file,c=e.setFile,s=e.dceId,r=e.scNr,l=e.setUrl,i=te(t,s,r),o=i.progress,u=i.url;return Object(n.useEffect)((function(){u&&(c(null),l(u))}),[u,c]),Object(a.jsx)("div",{className:"progress-bar",style:{width:o+"%"}})},ae=function(e){var t=e.dceId,c=e.scNr,s=e.setUrl,r=Object(n.useState)(null),l=Object(o.a)(r,2),i=l[0],u=l[1],d=Object(n.useState)(null),j=Object(o.a)(d,2),b=j[0],m=j[1],f=["image/png","image/jpeg"];return Object(a.jsxs)("form",{children:[Object(a.jsxs)("label",{children:[Object(a.jsx)("input",{type:"file",style:{height:0,width:0},onChange:function(e){var t=e.target.files[0];t&&f.includes(t.type)?(u(t),m("")):(u(null),m("Please select an image file (png or jpg)"))}}),Object(a.jsx)("span",{className:"btn btn-sm btn-outline-info mb-3",children:"Upload image"})]}),Object(a.jsxs)("div",{className:"output",children:[b&&Object(a.jsx)("div",{className:"error",children:b}),i&&Object(a.jsx)("div",{children:i.name}),i&&Object(a.jsx)(ce,{file:i,setFile:u,dceId:t,scNr:c,setUrl:s})]})]})},ne=function(e,t,c,s,r,l,i,u,d,j,b,m){var f=Object(n.useState)([]),h=Object(o.a)(f,2),O=h[0],p=h[1],x=function(e){var c=Object(F.a)(t);c[0].data.scImg=e,j(c),b(!1)};return Object(n.useEffect)((function(){var n=[];n.push(Object(a.jsxs)("div",{children:[e&&e.details.grouped&&t[0].data&&Object(a.jsxs)("h5",{children:["Paired with scenario nr: ",t[0].data.altnr]}),Object(a.jsxs)("form",{className:"form-row",children:[Object(a.jsx)("h6",{children:"Features"}),Object(a.jsx)("div",{className:"row",children:t[0].data&&i.map((function(e,n){var s=[{label:e.featureValue1,value:e.featureValue1},{label:e.featureValue2,value:e.featureValue2}];return Object(a.jsxs)("div",{className:"col-md-4  mb-3",children:[" ",Object(a.jsx)("label",{htmlFor:n,className:"col-form-label",children:e.featureName}),Object(a.jsx)(_.a,{options:s,placeholder:t[0].data.fValues[e.featureName],defaultValue:t[0].data.fValues[e.featureName],isDisabled:t[0].data.altSc,onChange:function(t){return c(t.value,e.featureName)},id:n})]})}))})]}),t[0].data&&Object(a.jsxs)("form",{id:"textForm",onSubmit:function(e){return s(e)},children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("h6",{children:"Scenario text"}),Object(a.jsx)("textarea",{className:"form-control form-control-sm mb-3",name:"scText",value:t[0].data.scText,placeholder:"Enter scenario text",id:"scText",onChange:function(e){return r(e)}})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("h6",{children:"Scenario explanation"}),Object(a.jsx)("textarea",{className:"form-control form-control-sm mb-3",type:"text",name:"scExpl",value:t[0].data.scExpl,placeholder:"Enter additional explanatory text",id:"scExpl",onChange:function(e){return r(e)}})]}),Object(a.jsx)("h6",{children:"Scenario image link"}),Object(a.jsx)(ae,{dceId:u,scNr:d,setUrl:x}),t[0].data.scImg&&Object(a.jsx)("img",{src:t[0].data.scImg,className:"scImage",alt:"scenario image"}),e&&e.details.grouped&&!t[0].data.altnr&&Object(a.jsx)("input",{className:"btn  btn-outline-success mb-3",type:"button",onClick:function(e){return l(e)},value:"Save & Create pair"}),(t[0].data.altnr||!e.details.grouped)&&Object(a.jsx)("input",{className:"btn  btn-outline-success mb-3",type:"submit",value:"Save"})]}),m&&Object(a.jsx)("div",{className:m,children:"Scenario has been saved"})]})),console.log("tempScenario: "+JSON.stringify(n)),p(n)}),[e,t,m]),{scenarioHtml:O}};function se(e){var t=e.dceId,c=e.dceFeatures,s=e.dceDetails,r=e.scNr,l=e.setScNr,i=e.chosen,u=e.setChosen,d=e.handleAddScenario,f=e.setIsSaved,h=e.isSaved,p=Object(n.useContext)(C).uid,x=Object(n.useState)(r),g=Object(o.a)(x,2),v=(g[0],g[1]),N=function(e){var t,a=s.details.groupFeature,n=e[a];c.map((function(e,c){e.featureName===a&&(e.featureValue1===n&&(t=e.featureValue2),e.featureValue2===n&&(t=e.featureValue1))}));var r=Object(b.a)({},e);return r[a]=t,{altFValueList:r,newFeatValue:t}},S=function(){var e,t=!1;return 0!==i[0].data.scText.length||0!==i[0].data.scImg.length?t=!0:alert("Fill in the Scenario Text or upload a Scenario Image, or do both"),e=!c.some((function(e){return console.log("check features complete: "+JSON.stringify(i[0].data)),console.log("feature: "+JSON.stringify(e)),0===i[0].data.fValues[e.featureName].length&&alert("Select a value for every feature in the scenario"),0===i[0].data.fValues[e.featureName].length})),console.log("text and feat complete: "+t+e),t&&e},y=function(){var e=Object(m.a)(j.a.mark((function e(c){var a,n,s,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.preventDefault(),S()&&(O.collection("users").doc(p).collection("DceList").doc(t).collection("Scenarios").doc(r.toString()).set(i[0]),a=i[0].data.fValues,n=i[0].data.altnr,s=N(a),l=s.altFValueList,n&&O.collection("users").doc(p).collection("DceList").doc(t).collection("Scenarios").doc(n.toString()).update({"data.fValues":l}),f(!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=ne(s,i,(function(e,t){console.log("value and name in handleChosen: "+e+t);var c=Object(F.a)(i);console.log("chosenList in handleChosen: "+JSON.stringify(c)),c[0].data.fValues[t]=e,u(c),f(!1)}),y,(function(e){e.preventDefault();var t=e.target,c=t.name,a=t.value,n=Object(F.a)(i);n[0].data[c]=a,u(n),f(!1)}),(function(e){var c;S()&&d(r).then((function(a){c=a;var n=Object(F.a)(i),s=i[0].data.fValues,r=N(s),o=r.altFValueList;r.newFeatValue;n[0].data.altnr=c,u(n),v(c),l(c),y(e).then((function(){u([{}]),O.collection("users").doc(p).collection("DceList").doc(t).collection("Scenarios").doc(c.toString()).get().then((function(e){var a=[e.data()];a[0].data.fValues=o,u(a),O.collection("users").doc(p).collection("DceList").doc(t).collection("Scenarios").doc(c.toString()).set(a[0])}))})).catch((function(e){console.log("Error with saving scenario"+e)}))}))}),c,t,r,u,f,h).scenarioHtml;return Object(a.jsx)("div",{children:E})}function re(e){var t=e.dceNameEdit,c=e.dceId,s=e.dceFeatures,r=e.dceDetails,l=Object(n.useContext)(C).uid,u=Object(n.useState)([{nr:0}]),d=Object(o.a)(u,2),f=d[0],h=d[1],p=Object(n.useState)([]),x=Object(o.a)(p,2),g=x[0],v=x[1],N=Object(n.useState)(""),S=Object(o.a)(N,2),y=S[0],E=S[1],w=Object(n.useState)(!1),D=Object(o.a)(w,2),A=D[0],F=D[1],k=function(){var e=Object(m.a)(j.a.mark((function e(){var t,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=8;break}return t=O.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").orderBy("data.nr"),e.next=4,t.get();case 4:a=e.sent,n=[],a.docs.forEach((function(e){n.push(Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id}))})),v(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){k(),h([{}]),E(null),F(!1)}),[c]);var I=function(){var e=Object(m.a)(j.a.mark((function e(t){var a,n,r,i,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=20;break}return a={},s.map((function(e){a[e.featureName]=""})),n=O.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").orderBy("data.nr"),e.next=6,n.get();case 6:return r=e.sent,i=1,r.docs.forEach((function(e){e.data().data.nr===i?(console.log("doc id == seqNr, seqNr is: "+i+"doc id is: "+e.data().data.nr),i+=1):console.log("doc id !== seqNr, seqNr is: "+i+"doc id is: "+e.data().data.nr)})),o=!1,t&&(o=!0),h([{}]),u={data:{nr:i,altnr:t,altSc:o,fValues:a,scText:"",scImg:"",scExpl:""}},O.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(i.toString()).set(u),h([u]),E(i),F(!1),k(),e.abrupt("return",i);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(e){var t;h([{}]),console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),E(t),O.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(t).get().then((function(e){var t=e.data();h([t]),F(!1)}))};return Object(a.jsxs)("div",{children:[Object(a.jsxs)("h4",{children:[Object(a.jsx)("u",{children:"Details"})," for ",Object(a.jsxs)("b",{children:[" ",t]}),y&&Object(a.jsxs)("span",{children:[" - Scenario nr. ",y]}),!y&&Object(a.jsx)("span",{children:" - Select a scenario nr."})]}),Object(a.jsx)("div",{className:"",children:Object(a.jsxs)("h6",{children:[r&&Object(a.jsxs)("span",{children:[" ",Object(a.jsx)(i.b,{to:{pathname:"/app/"+l+"/"+c},children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"play_circle_outline"})})})]}),r&&Object(a.jsx)("span",{children:" Play this DCE"})," ",r&&Object(a.jsxs)("span",{children:[" ",Object(a.jsx)("hr",{className:"ruler detailsRuler"})," ",Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){var e=window.location.href+"app/"+l+"/"+c;navigator.clipboard.writeText(e)},children:"Copy DCE link "})]})," "]})}),Object(a.jsx)("div",{className:"pb-4",children:Object(a.jsxs)("h6",{children:[" ",r&&r.details.grouped&&Object(a.jsxs)("span",{children:["Group feature: ",r.details.groupFeature]})," ",r&&Object(a.jsxs)("span",{children:[" ",Object(a.jsx)("hr",{className:"ruler detailsRuler"})," Questions in DCE: ",r.details.nrQuestions]})]})}),Object(a.jsxs)("div",{className:"row",children:[Object(a.jsxs)("div",{className:"scenarioList col col-6 col-md-3 col-sm-5",children:[Object(a.jsx)("h5",{children:"Scenario's"}),Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{className:"listRuler mb-1",children:["Nr.  ",Object(a.jsx)("hr",{className:"ruler"})," Edit ",Object(a.jsx)("hr",{className:"rulerSm"}),"\xa0Delete "]}),g&&g.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:V,children:e.data.nr}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsxs)("button",{className:"btn  btn-outline-warning btn-sm mx-2",onClick:V,children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"edit"})]}),Object(a.jsx)("hr",{className:"rulerSm"}),Object(a.jsxs)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:function(e){window.confirm("Are you sure you wish to delete this scenario?")&&function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");var a=g.find((function(e){return e.id===t})).data.altnr;console.log("Alt sc that should be deleted: "+JSON.stringify(a)),O.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(t).delete().then((function(){console.log("Scenario with ID "+t+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),a&&O.collection("users").doc(l).collection("DceList").doc(c).collection("Scenarios").doc(a.toString()).delete().then((function(){console.log("Alt scenario with ID "+a.toString()+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),console.log("sc="+t+"scNr="+y),t==y&&(console.log("sc = scNr : "+t+y),E(""),h([{}])),k(),F(!1)}(e)},children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]})]})})},t)})),c&&Object(a.jsx)("li",{className:"mb-2",children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){return I(null)},children:"Add scenario"})})]})]}),Object(a.jsx)("div",{className:"col",children:Object(a.jsx)(se,{dceId:c,dceFeatures:s,dceDetails:r,scNr:y,setScNr:E,chosen:f,setChosen:h,handleAddScenario:I,setIsSaved:F,isSaved:A})})]})]})}function le(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(!1),l=Object(o.a)(r,2),u=l[0],d=l[1],f=Object(n.useState)("(Click on ICON in DCE list)"),h=Object(o.a)(f,2),p=h[0],x=h[1],g=Object(n.useState)([]),v=Object(o.a)(g,2),N=v[0],S=v[1],y=Object(n.useState)(""),E=Object(o.a)(y,2),w=E[0],D=E[1],A=Object(n.useState)([]),F=Object(o.a)(A,2),k=F[0],I=F[1],V=Object(n.useState)(null),L=Object(o.a)(V,2),J=L[0],R=L[1],B=Object(n.useContext)(C),P=B.uid;console.log("user uid in dcelist is: "+JSON.stringify(B.uid));var T=function(){var e=Object(m.a)(j.a.mark((function e(){var t,c,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O.collection("users").doc(P).collection("DceList"),e.next=3,t.get();case 3:c=e.sent,a=[],n=[],c.docs.forEach((function(e){a.push(Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id})),n.push(e.data().name.dceName)})),s(a),I(n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){T()}),[]);var U=function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");O.collection("users").doc(P).collection("DceList").doc(t).get().then((function(e){var c=e.data().name.dceName,a={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};x(c),S(e.data().features),D(t),R(a)}))},G=function(){u?d(!1):u||d(!0)};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row my-4",children:[Object(a.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(a.jsxs)("div",{className:" col-auto ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"DCE list"})}),Object(a.jsxs)("ul",{children:[c&&console.log("dceHtml: "+JSON.stringify(c)),c&&c.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(a.jsx)("b",{children:e.name.dceName}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-warning mx-1",onClick:U,children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"edit"})}),Object(a.jsx)(i.b,{to:{pathname:"/aspectList/"+P+"/"+e.id,dceFeatures:e.features,groupFeature:e.groupFeature,dceNameEdit:p},children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"settings"})})}),Object(a.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-1",onClick:function(e){window.confirm("Are you sure you wish to delete this DCE?")&&function(e){var t;t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),O.collection("users").doc(P).collection("DceList").doc(t).delete().then((function(){console.log("Documentwith ID"+t.id+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),T()}(e)},children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"delete_forever"})})]})})},t)}))]})]}),Object(a.jsx)("div",{className:"row my-4",children:Object(a.jsxs)("div",{className:"col-auto  ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"Create new DCE"})}),Object(a.jsxs)("div",{children:[" ",Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:G,children:" new DCE"})]}),u&&Object(a.jsx)(ee,{showDceList:T,showNewDceForm:G,dceNameList:k})]})})]}),Object(a.jsx)("div",{className:"col scenarioContainer",children:Object(a.jsx)(re,{dceNameEdit:p,dceId:w,dceFeatures:N,dceDetails:J})})]})})}function ie(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(!1),l=Object(o.a)(r,2),u=(l[0],l[1],Object(n.useState)("(Click on ICON in DCE list)")),d=Object(o.a)(u,2),f=d[0],h=d[1],p=Object(n.useState)([]),x=Object(o.a)(p,2),g=x[0],v=x[1],N=Object(n.useState)(""),S=Object(o.a)(N,2),y=S[0],E=S[1],w=Object(n.useState)([]),D=Object(o.a)(w,2),A=(D[0],D[1]),F=Object(n.useState)([]),k=Object(o.a)(F,2),I=k[0],V=k[1],L=Object(n.useContext)(C),J=L.uid,R=function(){var e=Object(m.a)(j.a.mark((function e(){var t,c,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O.collection("users").doc(J).collection("DceList"),e.next=3,t.get();case 3:c=e.sent,a=[],n=[],c.docs.forEach((function(e){a.push(Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id})),n.push(e.data().name.dceName)})),s(a),A(n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){R()}),[L]);var B=function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id");O.collection("users").doc(J).collection("DceList").doc(t).get().then((function(e){var c=e.data().name.dceName,a={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};h(c),V(a),v(e.data().features),E(t),console.log("dceDetails onCreate: "+JSON.stringify(a))}))};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row my-4",children:[Object(a.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(a.jsxs)("div",{className:" col-auto ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"DCE list"})}),Object(a.jsx)("ul",{children:c&&c.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(a.jsx)("b",{children:e.name.dceName}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsx)(i.b,{to:{pathname:"/app/"+J+"/"+e.id},children:Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"play_circle_outline"})})}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",onClick:B,children:Object(a.jsx)("i",{class:"material-icons mat-icon mt-1",children:"poll"})})]})})},t)}))})]}),Object(a.jsx)("div",{className:"row my-4",children:Object(a.jsx)("div",{className:"col-auto  ",children:Object(a.jsx)("div",{})})})]}),Object(a.jsx)("div",{className:"col scenarioContainer",children:Object(a.jsx)(M,{dceDetails:I,dceNameEdit:f,dceId:y,dceFeatures:g,userId:J})})]})})}var oe=function(e,t){var c=e.target.value,a=Object(F.a)(t);return a[0]=c,a};function ue(e){var t=e.setShowAspectsFlag,c=e.showNewAspectForm,s=Object(n.useState)(["name"]),r=Object(o.a)(s,2),l=r[0],i=r[1],d=Object(n.useState)(["descr"]),j=Object(o.a)(d,2),b=j[0],m=j[1],f=Object(u.h)(),h=f.userId,p=f.dceId;Object(n.useContext)(C).uid;return Object(a.jsx)("div",{children:Object(a.jsxs)("form",{className:"form-inline",children:[Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("input",{type:"text",className:"form-control",name:"aspectName",placeholder:"Aspect name",id:"aspectName",required:!0,onChange:function(e){var t=oe(e,l);i(t)}}),Object(a.jsx)("label",{htmlFor:"aspectName",className:"block",children:"Name: "})]}),Object(a.jsxs)("div",{className:"form-floating",children:[Object(a.jsx)("textarea",{type:"text",rows:"7",className:"form-control",name:"aspectDescr",placeholder:"Description",id:"aspectDescr",required:!0,onChange:function(e){var t=oe(e,b);m(t)}}),Object(a.jsx)("label",{htmlFor:"aspectDescr",className:"block",children:"Description: "})]}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){e.preventDefault();var a=O.collection("users").doc(h).collection("DceList").doc(p).collection("AspectList");a.add({aspectName:l[0],aspectDescr:b[0]}).then((function(e){console.log("Document written with ID: ",e.id),a.doc(e.id).collection("Combis").doc("0").set({nr:0,groupValue:"",filters:[]}),t("new aspect saved id "+e.id)})).catch((function(e){console.error("Error adding document: ",e)})),c()},children:"Save aspect"})]})})}function de(e){var t=e.aspectId,c=e.aspectNameEdit,s=e.aspectDescr,r=e.aspectFilters,l=e.saveFilters,i=e.chosenFeatures,d=e.setChosenFeatures,j=e.handleAddCombi,b=e.handleDeleteCombi,m=e.groupValues,f=e.setGroupValues,h=Object(n.useState)(null),O=Object(o.a)(h,2),p=O[0],x=O[1],g=Object(n.useState)(null),v=Object(o.a)(g,2),N=v[0],S=v[1],y=Object(u.g)(),E=y.dceFeatures,w=y.groupFeature,C=Object(u.f)();void 0===w&&C.push("/");var D=function(e,t){x(null);var c=Object(F.a)(i);c[t][0]={fName:e},d(c)},A=function(e,t){x(null),S(null);var c=Object(F.a)(i);c[t][0].fValue=e,d(c)},k=function(e){e.preventDefault();var t=e.target.dataset.id,c=[].concat(Object(F.a)(r[t]),Object(F.a)(i[t])),a=Object(F.a)(i);a[t]=[],console.log("group values: "+JSON.stringify(m)),0===m[t].length?alert("Select a value for the Group feature before saving"):(l(t,c,a,m),console.log("tempList in save: "+JSON.stringify(c)),console.log("tempChosen in save: "+JSON.stringify(a)),x(""),console.log("SetFormValue blanc"),S(""))},I=function(e,t,c,s,r,l,i,u,d,j,b,m,f,h){var O=Object(n.useState)([]),p=Object(o.a)(O,2),x=p[0],g=p[1],v=Object(n.useState)([]),N=Object(o.a)(v,2),S=(N[0],N[1],[{}]);return Object(n.useEffect)((function(){var n=[];s.map((function(s,o){n.push(Object(a.jsxs)("div",{id:o,children:[" ",0!==o&&Object(a.jsxs)("h5",{className:"my-5",children:[Object(a.jsxs)("button",{onClick:function(e){return r(e,o)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]}),"combined with:"]}),Object(a.jsxs)("h5",{children:["Select value for group feature - ",d]}),Object(a.jsx)("label",{htmlFor:"groupVal",children:"Group value"}),Object(a.jsx)("div",{className:"selectInputs",children:l&&S.map((function(t,n){return Object(a.jsx)(_.a,{options:[{label:l.find((function(e){return e.featureName===d})).featureValue1,value:l.find((function(e){return e.featureName===d.featureValue1}))},{label:l.find((function(e){return e.featureName===d})).featureValue2,value:l.find((function(e){return e.featureName===d})).featureValue2}],placeholder:c[o]||"Select...",onChange:function(e){return u(e.value,o)}},"".concat(e,"-grValue- ").concat(o))}))}),Object(a.jsx)("h5",{children:"Saved features and values"})]})),s.map((function(e,t){console.log("filter is: "+JSON.stringify(e)),n.push(Object(a.jsxs)("div",{id:t,className:"my-3",children:[Object(a.jsx)("div",{className:"savedFeatures my-2 mx-3 px-5 py-1 p-3 border rounded",children:e.fName}),Object(a.jsx)("span",{className:"savedFeatures mx-3 px-5 py-1 border rounded",children:e.fValue}),Object(a.jsx)("span",{children:Object(a.jsxs)("button",{onClick:function(e){return i(e,t,o)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})]})})]}))})),n.push(Object(a.jsxs)("div",{children:[Object(a.jsxs)("span",{children:[Object(a.jsxs)("form",{children:[console.log("groupFeature: "+d),console.log("dceFeatures: "+JSON.stringify(l)),Object(a.jsx)("label",{htmlFor:"fNames",className:"col-md-3 col-form-label",children:"Add filter feature "}),Object(a.jsx)("div",{className:"selectInputs",children:Object(a.jsx)(_.a,{options:l&&l.map((function(e,t){console.log("ind is: "+t);var c=e.featureName;return e.featureName===d&&(c=""),{label:c,value:c}})),id:"fNames",onChange:function(e){return j(e.value,o)}},"".concat(e,"-fName- ").concat(o))})]}),l&&Object(a.jsxs)("form",{children:[Object(a.jsx)("label",{htmlFor:"fValues",className:"col-md-3 col-form-label",children:"Enter filter value "}),Object(a.jsx)("div",{className:"selectInputs pb-3",children:t[o][0]&&t[o].map((function(c,n){return Object(a.jsx)(_.a,{id:"fValues",options:[{label:l.find((function(e){return e.featureName===t[o][0].fName})).featureValue1,value:l.find((function(e){return e.featureName===t[o][0].fName})).featureValue1},{label:l.find((function(e){return e.featureName===t[o][0].fName})).featureValue2,value:l.find((function(e){return e.featureName===t[o][0].fName})).featureValue2}],onChange:function(e){return b(e.value,o)}},"".concat(e,"-fValue- ").concat(o))}))})]})]}),Object(a.jsx)("button",{"data-id":o,className:"btn btn-sm btn-outline-info mb-3",onClick:m,children:"save filter feature and group value"})]}))})),g(n)}),[t,c]),{fromDb:x}}(t,i,m,r,b,E,(function(e,t,c){e.preventDefault();var a=c.toString(),n=Object(F.a)(r[a]),s=[];r.map((function(e){s.push([])})),n.splice(t,1),l(a,n,s,m)}),(function(e,t){var c=Object(F.a)(m);c[t]=e,f(c)}),w,D,A,k).fromDb,V=function(e,t,c,s,r,l,i,u){var d=Object(n.useState)([]),j=Object(o.a)(d,2),b=j[0],m=j[1];return Object(n.useEffect)((function(){console.log("Rerender choose html"),console.log("chosenFeatures in choose html: "+JSON.stringify(e));var n=[];"(Click on ICON in Aspect list)"!==t&&n.push(Object(a.jsxs)("div",{children:[Object(a.jsx)("form",{children:Object(a.jsxs)("label",{htmlFor:"fNames",className:"col-md-3 col-form-label",children:["Add filter feature",Object(a.jsxs)("select",{className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:c,"data-id":0,id:e.length-1,onChange:u,children:[Object(a.jsx)("option",{value:"",disabled:!0}),s&&s.map((function(e,t){return console.log("ind is: "+t),Object(a.jsxs)("option",{value:e.featureName,children:[e.featureName," "]})}))]})]})}),s&&Object(a.jsx)("form",{children:Object(a.jsxs)("label",{htmlFor:"fValue",children:["Filter value",Object(a.jsxs)("select",{name:"fValue",id:"",className:"form-select form-select-sm col-md-3  mb-3",defaultValue:"",value:r,"data-id":0,onChange:l,children:[Object(a.jsx)("option",{value:"",disabled:!0}),console.log("i="+e.length-1),console.log("chosenFeatures: "+JSON.stringify(e)),e[0][0]&&Object(a.jsx)("option",{value:s.find((function(t){return t.featureName===e[0][0].fName})).featureValue1,children:s.find((function(t){return t.featureName===e[0][0].fName})).featureValue1}),e[0][0]&&Object(a.jsx)("option",{value:s.find((function(t){return t.featureName===e[0][0].fName})).featureValue2,children:s.find((function(t){return t.featureName===e[0][0].fName})).featureValue2})]})]})}),Object(a.jsx)("button",{"data-id":"0",className:"btn btn-sm btn-outline-info mb-3",onClick:i,children:"save filter feature"})]})),m(n)}),[e]),b}(i,c,p,E,N,A,k,D),L=[];return"(Click on ICON in Aspect list)"!==c&&L.push(Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:j,children:"add combination feature"})),Object(a.jsxs)("div",{children:[Object(a.jsxs)("h4",{className:"mb-1",children:["Define aspect for ",Object(a.jsx)("b",{children:c})]}),Object(a.jsxs)("h6",{className:"text-secondary pb-3",children:["Description: ",s]}),I,0===I.length&&V,L]})}var je=function(e,t,c){var a=Object(n.useState)([]),s=Object(o.a)(a,2),r=s[0],l=s[1];return Object(n.useEffect)((function(){O.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").get().then((function(e){var t=[];e.docs.forEach((function(e){t.push(Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id}))})),console.log("Aspects data: "+JSON.stringify(t)),l(t)}))}),[c]),{aspects:r}};function be(e){var t=e.aspects,c=e.editAspect,n=e.deleteAspect;return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:" col-auto ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"Aspect list"})}),Object(a.jsx)("ul",{children:t&&t.map((function(e,t){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("h5",{className:"mt-3",children:Object(a.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(a.jsx)("b",{children:e.aspectName}),Object(a.jsx)("hr",{className:"ruler"}),Object(a.jsx)("button",{className:"btn btn-sm btn-outline-warning",onClick:c,children:Object(a.jsx)("i",{class:"material-icons mat-icon",children:"edit"})}),Object(a.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:n,children:Object(a.jsx)("i",{class:"material-icons mat-icon",children:"delete_forever"})})]})})},t)}))})]})})}var me=function(){var e=Object(m.a)(j.a.mark((function e(t,c,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleAddCombi received"),O.collection("users").doc(t).collection("DceList").doc(c).collection("AspectList").doc(a).collection("Combis").orderBy("nr","asc").get().then((function(e){console.log("data in handleAddCombi: "+JSON.stringify(e.docs));for(var n=0,s=0;s<e.docs.length;s++){if(e.docs[s].data().nr!==n)return console.log("doc nr !== seqNr, seqNr is: "+n+"doc id is: "+e.docs[s].data().nr),void fe(n);console.log("doc nr == seqNr, seqNr is: "+n+"doc id is: "+e.docs[s].data().nr),n+=1,s===e.docs.length-1&&(console.log("Last doc, i===length"),fe(n,t,c,a))}})).catch((function(e){console.log("Error adding combi",e)})),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,c,a){return e.apply(this,arguments)}}(),fe=function(e,t,c,a){O.collection("users").doc(t).collection("DceList").doc(c).collection("AspectList").doc(a).collection("Combis").doc(e.toString()).set({nr:e,groupValue:"",filters:[]}).then((function(){return console.log("combi added"),a})).catch((function(e){console.log("Error adding combi",e)}))};function he(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)([]),l=Object(o.a)(r,2),i=l[0],d=l[1],b=Object(n.useState)([]),f=Object(o.a)(b,2),h=f[0],p=f[1],x=Object(n.useState)([]),g=Object(o.a)(x,2),v=g[0],N=g[1],S=Object(n.useState)(!1),y=Object(o.a)(S,2),E=y[0],w=y[1],C=Object(n.useState)("(Click on ICON in Aspect list)"),D=Object(o.a)(C,2),A=D[0],k=D[1],I=Object(n.useState)(""),V=Object(o.a)(I,2),L=V[0],J=V[1],R=Object(n.useState)(""),B=Object(o.a)(R,2),P=B[0],T=B[1],U=Object(u.h)(),G=U.userId,q=U.dceId,K=je(G,q,c).aspects,M=function(e){var t=[],c=O.collection("users").doc(G).collection("DceList").doc(q).collection("AspectList").doc(e);c.get().then((function(a){var n=a.data().aspectName,s=[],r=[];c.collection("Combis").get().then((function(e){e.docs.forEach((function(e){s.push(e.data().filters),t.push([]),r.push(e.data().groupValue)})),N(r),J(a.data().aspectDescr),p(s),d(t)})).catch((function(e){console.log("Error loading aspect data",e)})),k(n),T(e)})).catch((function(e){console.log("Error loading aspect data",e)}))},Q=function(){var e=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("start handleAddCombi"),me(G,q,P).then((function(e){console.log("combi added , aspectId returned, Id: "+e),M(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(m.a)(j.a.mark((function e(t){var c,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.target.parentElement.parentElement.getAttribute("data-id")?t.target.parentElement.parentElement.getAttribute("data-id"):t.target.parentElement.getAttribute("data-id"),(a=O.collection("users").doc(G).collection("DceList").doc(q).collection("AspectList").doc(c)).collection("Combis").get().then((function(e){e.forEach((function(e){a.collection("Combis").doc(e.id).delete().then((function(){console.log("Combi with ID "+e.id+" deleted")}))}))})).then((function(){console.log("Combis deleted"),a.delete().then((function(){console.log("Document with ID"+c+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)})),c===P&&(T(""),J(""),k("(Click on ICON in Aspect list)"),p([]),d([])),s("set flag "+c),console.log("just set showAspectFlag "+c)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){E?w(!1):E||w(!0)};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row my-4",children:[Object(a.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(a.jsx)(be,{aspects:K,editAspect:function(e){var t;console.log("e is: "+e.target.parentElement.parentElement.getAttribute("data-id")),t=e.target.parentElement.parentElement.getAttribute("data-id")?e.target.parentElement.parentElement.getAttribute("data-id"):e.target.parentElement.getAttribute("data-id"),M(t)},deleteAspect:z}),Object(a.jsx)("div",{className:"row my-4",children:Object(a.jsxs)("div",{className:"col-auto  ",children:[Object(a.jsx)("h4",{children:Object(a.jsx)("u",{children:"Create new Aspect"})}),Object(a.jsxs)("div",{children:[" ",Object(a.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:H,children:" new Aspect"})]}),E&&Object(a.jsx)(ue,{dceId:q,setShowAspectsFlag:s,showNewAspectForm:H})]})})]}),Object(a.jsx)("div",{className:"col scenarioContainer",children:Object(a.jsx)(de,{aspectId:P,aspectNameEdit:A,aspectDescr:L,aspectFilters:h,saveFilters:function(e,t,c,a){O.collection("users").doc(G).collection("DceList").doc(q).collection("AspectList").doc(P).collection("Combis").doc(e).update({filters:t,groupValue:a[e]}).then((function(){var a=Object(F.a)(h);a[e]=t,p(a),d(c),console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))},chosenFeatures:i,setChosenFeatures:d,handleAddCombi:Q,handleDeleteCombi:function(e,t){O.collection("users").doc(G).collection("DceList").doc(q).collection("AspectList").doc(P).collection("Combis").doc(t.toString()).delete().then((function(){console.log("Combination successfully deleted!"),M(P)})).catch((function(e){console.error("Error removing document: ",e)}))},groupValues:v,setGroupValues:N})})]})})}var Oe=function(){return Object(n.useContext)(C)?Object(a.jsx)(u.c,{children:Object(a.jsxs)(i.a,{children:[Object(a.jsx)(u.a,{exact:!0,path:"/",children:Object(a.jsx)(le,{})}),Object(a.jsx)(u.a,{exact:!0,path:"/dces",children:Object(a.jsx)(ie,{})}),Object(a.jsx)(u.a,{path:"/aspectList/:userId/:dceId",exact:!0,component:function(){return Object(a.jsx)(he,{})}}),Object(a.jsx)(u.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(a.jsx)(H,{})}})]})}):Object(a.jsx)(u.c,{children:Object(a.jsxs)(i.a,{children:[Object(a.jsxs)(u.a,{exact:!0,path:"/signUp",children:[" ",Object(a.jsx)(Y,{})]}),Object(a.jsxs)(u.a,{exact:!0,path:"/",children:[" ",Object(a.jsx)(Z,{})]}),Object(a.jsxs)(u.a,{exact:!0,path:"/passwordReset",children:[" ",Object(a.jsx)(W,{})," "]}),Object(a.jsx)(u.a,{exact:!0,path:"/dces",children:Object(a.jsx)(Z,{})}),Object(a.jsx)(u.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(a.jsx)(H,{})}})]})})};var pe=function(){return Object(n.useContext)(C),Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(i.a,{children:[Object(a.jsx)(A,{}),Object(a.jsx)(D,{children:Object(a.jsx)(Oe,{})})]})})};l.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(pe,{})}),document.getElementById("root"))},48:function(e,t,c){},64:function(e,t,c){},65:function(e,t,c){},77:function(e,t,c){}},[[109,1,2]]]);
//# sourceMappingURL=main.2e4355eb.chunk.js.map