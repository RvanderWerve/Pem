(this.webpackJsonppem=this.webpackJsonppem||[]).push([[0],{108:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(1),s=c.n(a),r=c(33),i=c.n(r),l=(c(64),c(65),c(49),c(12)),o=c(8),u=c(4),d=c(16),j=c(14),b=c.n(j),h=c(6),m=c(20),f=c(36);c(109),c(110),c(68);f.a.initializeApp({apiKey:"AIzaSyDkuqUfQCo8w_7OWogV44gsGLzaE-yEvX4",authDomain:"pem-firestore.firebaseapp.com",projectId:"pem-firestore",storageBucket:"pem-firestore.appspot.com",messagingSenderId:"528017814946",appId:"1:528017814946:web:f8fab7864531498a146efb"});var O=f.a.storage(),p=f.a.firestore(),x=(f.a.firestore.FieldValue.serverTimestamp,f.a.firestore.FieldPath.documentId,f.a.auth()),v=new f.a.auth.GoogleAuthProvider,g=function(){x.signInWithPopup(v)},N=function(){var e=Object(m.a)(b.a.mark((function e(t,c){var n,a,s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=p.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=16;break}return a=t.email,s=t.displayName,r=t.photoURL,e.prev=8,e.next=11,n.set(Object(h.a)({displayName:s,email:a,photoURL:r},c));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error creating user document",e.t0);case 16:return e.abrupt("return",S(t.uid));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,c){return e.apply(this,arguments)}}(),S=function(){var e=Object(m.a)(b.a.mark((function e(t){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,p.doc("users/".concat(t)).get();case 5:return c=e.sent,e.abrupt("return",Object(h.a)({uid:t},c.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),y=c(10),C=c(22),w=c(24),D=c(44),E=Object(a.createContext)({user:null}),L=function(e){Object(w.a)(c,e);var t=Object(D.a)(c);function c(){var e;Object(y.a)(this,c);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={user:null},e.componentDidMount=Object(m.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:x.onAuthStateChanged(function(){var t=Object(m.a)(b.a.mark((function t(c){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(c);case 2:n=t.sent,e.setState({user:n}),console.log("User logged in");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e}return Object(C.a)(c,[{key:"render",value:function(){var e=this.state.user;return Object(n.jsx)(E.Provider,{value:e,children:this.props.children})}}]),c}(a.Component);var k=Object(d.h)((function(e){var t,c=Object(a.useContext)(E),s=Object(a.useState)(""),r=Object(u.a)(s,2),i=(r[0],r[1]);return Object(a.useEffect)((function(){var e;c?(e=c.displayName,i(e)):e=""}),[c]),Object(n.jsx)("div",{className:"navigation",children:Object(n.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-dark",children:Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)(l.b,{className:"navbar-brand",to:"/",children:Object(n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAW1SURBVGhD7ZpbaBxVGMe/mb0k2dy1uVWTJpV4KVJTL01D1baK4IMWwar1QcEqQlGDTxaxpQ++GX0q1JciCGKpFZpSEQxqQRtj0UqMF6RJ2wSJaZum2Wyz2WZv4/efPWd2Zndmd5oL3YX84LCzcz3/c77bHEYhsH+/2tbc/aym0W5SlI28p1zfX6hoWlgjZYBU5eDYrppe7rOmQERrc/eHfPht4j2pM4sFLalpykdjr9XuUdoOTT2nER0pPhESFqOoO1TdnIpWBFBUJZl8S9ViEfhEUQMNquIPFLZjuwAaVLFd9KwIKTRWhBQaSuuhq5wPiXwsyata0wmnTYol8St2OGB3rR2RePpGpV6FMq+YT2iOz/LyM3wZz0jwyVHuHzCE7HmojF66p0TfKYGIUFSj4ekE9Z6LUt9YlKIJcdDE3o0B2nm3X/yzB53c8kWIZmMa+blT3+6opltKrR1799QcnTgfFf+svPNgGb28ztq/YyNR2vfTnL5tmBZuXu5TLK2mRKGWSpUeb/HRgW3ldOzpKmqtMi4x8Huyr7VrBrwZsDm+qckrTrCCiXhijS/rfDxXkt0rwfR1ja5yM0/1uls99OmTlVTlt45kJrgmzrOZ2fLR2ejNMjdQH1B5AE29tsFRSM+ZCHUeDtL24yH6eyptT5ihNzpKxT973v95jjYfmbG0bUdDFDb5iB0t3NlGmxy9fpVH95FcOB5mP9dH8S8W8ebJWd1fJE+t9evT7USI/eDyXNLSJiNJ/Z65QNDYUJ898o/c5hNbzuTRmWJ0JknnZ9KzsppHrb0m91TfCBPh9Ch1NVk7jZnY2pzaB5Od4gGxw5UQDOS5oDVctdcunZC+sZjhi5tX+yx+Ul+mUiP7CBifTdLZ6UUIAZG42BDkc/gbIcymiLAMmtkHG0x+8kCD1/CP0xfjVMmR1A7XQjLxLJ0O3Td+n0yNFDp9X116trfenja1X1hIBYddOxYsxByWF0sFz+6P4+kp3yKc28O96xS5Bc8buhKnMvtU414IRs3MXI5QCrND7JetNiODZxLgcmXwclz3RXA/mxNo4mubhJkF5zW6wAEns0yRuBbSIBxOcolDqhN7OwPU/0K10T5+rEIcsQd11zAHk3kxOKgeIG59ndcI879BKB9GBWKHKyEoBcxRCjllaNKm6BLAf2DrssFEclHKt8aIDwdTg1PCN7iTn3eX6ZmD7EOKopA3vcuCKyEdPDK1pmgxxDeVUcYOJFIUl7KZk6kd0mxPjcdSG8y9nM3bqlMH8KR+9iGs9XgdFnxyCsG04oY9j5ZbFoyODttXqBJUpB2fBY32yjez4og98hUAoy5ZW+3RZwVc4wr8LFfgOMuponAU0r2hlAZ2VtPx7VV6fSWBrX45PC/+2RPlEIN3D9lQwudChnLcWxaX7TWqLgaMsP/gPgsSgmiBiGO+EOFv93dhfqERO5YIOduouEdDKd/r4gwvTU5GNAer0nEUgkGEbcMX/riSoPf65+j5r67pBeBSIzuIZw6KIGJOuD+IHJNDh7OQnl8j9DCX312HZ/RS/vN/5tlExMElxtzB0xNphwcwKViCzkJmZIbDIUY/V3RaDlBPmct9VMboSz4chdws0PGLJvM9cynuqhwqOCGIWn+a3kgHJtIhORfLIqSKK9S6suwmy/F89I7M08l/Y/Q9N5iaG5ZFyL5NARp4sSar3SHyQj6+vhCjXX2z9Cq3//hlyg3LIgS5B+Ezs+XKA4vFEAKHQqKTTTOK6vxkXuvUzNEIq4TmY67IeI45CFiWTM21PsoMN2tRAKW1myXT66Yl0TLTkikSYb4yBuB8XCeJ88jIlU9DSLGzLD5yM1gRUmisCCk0VA7uYbFdvLAGVf/KpsiBBrzLHuRNt7m18NC0hJJMHFDxvRM+FSpKMSyC0/0Ho6+vOpHK96xkzSfBZ/CVDVd2RfPhGWYCIkhRtP8BHVdn5YjM5rcAAAAASUVORK5CYII=",width:"35px",height:"30px",alt:"PEM logo"})}),Object(n.jsx)("div",{children:Object(n.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(n.jsx)("li",{className:"nav-item  ".concat("/"===e.location.pathname?"active":""),children:Object(n.jsx)(l.b,{className:"nav-link",to:"/",children:"Develop"})},"0"),Object(n.jsx)("li",{className:"nav-item  ".concat("/dcePlayList"===e.location.pathname?"active":""),children:Object(n.jsx)(l.b,{className:"nav-link",to:"/dcePlayList",children:"Run/Results"})},"1"),c?Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsxs)(l.b,{to:"/",className:"nav-link",onClick:function(){x.signOut()},children:["Sign out (",c.displayName,")"]})},"2"):Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(l.b,(t={to:"/",className:"nav-link"},Object(o.a)(t,"to","/"),Object(o.a)(t,"children","Sign in"),t))},"2")]})})]})})})})),A=c(9),I=function(){return Object(n.jsx)("div",{className:"outtro",children:Object(n.jsx)("div",{className:"fixed-action-btn",children:Object(n.jsx)("a",{href:"#modal1",className:" modal-trigger btn-floating red darken-2",children:Object(n.jsx)("i",{className:"material-icons mat-icon",style:{fontSize:"140%"},children:"help_outline"})})})})},V=c(132),F=c(131),G=c(133),P=c(54),R=c.n(P),T=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=e.value,i=e.shownSc,l=e.ageGender,o=Object(a.useState)({}),d=Object(u.a)(o,2),j=d[0],b=d[1];return Object(a.useEffect)((function(){if(c&&s){var e=c.fValues,t=s.fValues,n=null;"A"===r&&(n={pref:Object(h.a)(Object(h.a)({},e),l),nonPref:Object(h.a)(Object(h.a)({},t),l)}),"B"===r&&(n={pref:Object(h.a)(Object(h.a)({},t),l),nonPref:Object(h.a)(Object(h.a)({},e),l)}),b(n)}}),[c,s,l,r]),Object(n.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(n.jsx)("div",{className:"s10 ",children:i&&Object(n.jsxs)("div",{className:"choice-container",children:[Object(n.jsx)("p",{children:i.scText}),Object(n.jsx)("img",{className:"swipe-img choice-container",src:i.scImg,alt:""})]})}),i&&Object(n.jsx)("button",{value:r,onClick:function(){t(j)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},J=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=e.dceDescr,i=e.ageGender,l=Object(a.useState)(0),o=Object(u.a)(l,2),d=o[0],j=o[1],b=Object(a.useState)(0),h=Object(u.a)(b,2),m=h[0],f=h[1],O={tabs:{background:"#fff"},label:{fontSize:"100%"}};return Object(n.jsxs)("div",{className:"swiper-container",children:[Object(n.jsx)(G.a,{position:"static",color:"default",children:Object(n.jsxs)(V.a,{indicatorColor:"primary",textColor:"primary",background:"primary",variant:"fullWidth",value:m,onChange:function(e,t){f(t),j(t)},style:O.tabs,children:[Object(n.jsx)(F.a,{style:O.label,label:"option n\xb01"}),Object(n.jsx)(F.a,{style:O.label,label:"option n\xb02"})]})}),Object(n.jsx)("h5",{className:"text-secondary mt-1 mb-0 text-center",children:r}),Object(n.jsxs)(R.a,{enableMouseEvents:!0,index:d,onChangeIndex:function(e){j(e),f(e)},children:[Object(n.jsx)("div",{className:"slide",children:Object(n.jsx)("div",{className:"innerslide",children:Object(n.jsx)(T,{handleClick:t,sc1:c,sc2:s,value:"A",shownSc:c,ageGender:i})})}),Object(n.jsx)("div",{className:"slide",children:Object(n.jsx)("div",{className:"innerslide",children:Object(n.jsx)(T,{handleClick:t,sc1:c,sc2:s,value:"B",shownSc:s,ageGender:i})})})]})]})},B=function(e){var t=e.sc1,c=e.sc2;return Object(n.jsx)("div",{children:Object(n.jsx)("div",{id:"modal1","data-id":"modal1",className:"modal",children:Object(n.jsx)("div",{className:"modal-content black-text modal-close center",children:Object(n.jsxs)("div",{className:"flow-text",children:[Object(n.jsx)("h4",{className:"mb-3",children:"Additional explanation:"}),Object(n.jsx)("h6",{children:Object(n.jsx)("u",{children:"Scenario 1:"})}),t&&Object(n.jsx)("p",{className:"flow-text",children:t.scExpl}),t&&0===t.scExpl.length&&Object(n.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(n.jsx)("h6",{children:Object(n.jsx)("u",{children:"Scenario 2:"})}),c&&Object(n.jsx)("p",{className:"flow-text",children:c.scExpl}),c&&0===c.scExpl.length&&Object(n.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(n.jsx)("button",{className:"btn btn-sm blue darken-2 waves-effect waves-light z-depth-2",children:"Close"})]})})})})},Q=c(55),U=c.n(Q),K=function(e){var t=e.handleClick,c=e.sc1,a=e.sc2,s=e.dceDescr,r=e.ageGender;return Object(n.jsxs)("div",{className:"pc-view",children:[Object(n.jsx)("h5",{className:"text-secondary mt-1 mb-1",children:s}),Object(n.jsxs)("div",{className:"pc-container",children:[Object(n.jsx)("div",{className:"option-container",children:Object(n.jsx)(T,{handleClick:t,sc1:c,sc2:a,value:"A",shownSc:c,ageGender:r})}),Object(n.jsx)("div",{className:"option-container",children:Object(n.jsx)(T,{handleClick:t,sc2:a,sc1:c,value:"B",shownSc:a,ageGender:r})})]})]})},M=c(26),z=function(e){var t=e.nrQuestions,c=e.setStarted,a=e.setQNr,s=e.handleAGChoice;return Object(n.jsx)("div",{className:"my-5",children:Object(n.jsxs)("div",{className:"col resultsContainer mx-3",children:[Object(n.jsxs)("h5",{children:["Thank you for particpating in this experiment. You will be asked ",t," questions about your preference."]}),Object(n.jsx)("h5",{className:"text-secondary mb-5",children:"Please select your gender and age and then start by clicking the button below. "}),Object(n.jsxs)("div",{className:"col-md-6   mx-auto",children:[" ",Object(n.jsx)("label",{htmlFor:"gender",className:"col-form-label",children:"Gender"}),Object(n.jsx)(M.a,{className:"mb-2",options:[{label:"female",value:"female"},{label:"male",value:"male"}],id:"gender",name:"gender",onChange:function(e,t){return s(e.value,t.name)}})]}),Object(n.jsxs)("div",{className:"col-md-6   mx-auto",children:[" ",Object(n.jsx)("label",{htmlFor:"age",className:"col-form-label",children:"Age"}),Object(n.jsx)(M.a,{className:"mb-4",options:[{label:"younger than 25 years",value:"younger than 25 years"},{label:"25 years or older",value:"25 years or older"}],id:"age",name:"age",onChange:function(e,t){return s(e.value,t.name)}})]}),Object(n.jsx)("button",{className:"btn blue darken-2 ",onClick:function(){c(!0),a(0)},children:"Start"})]})})},H=function(e,t){var c=Object(a.useState)([]),n=Object(u.a)(c,2),s=n[0],r=n[1];return Object(a.useEffect)((function(){if(e&&t){var c=p.collection("users").doc(e).collection("DceList").doc(t).collection("Scenarios").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(h.a)({},e.data()))})),r(t),console.log("scenarios just set: "+JSON.stringify(t))}));return function(){return c()}}}),[e,t]),{scenarios:s}};function Y(e,t,c){var n=Object(a.useState)([]),s=Object(u.a)(n,2),r=s[0],i=s[1],l=c.features;return Object(a.useEffect)((function(){if(e&&t&&c){var n=[];return i(n),void p.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").get().then((function(a){a.forEach((function(a){n.push({aspectName:a.data().aspectName,aspectDescr:a.data().aspectDescr,id:a.id}),p.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").doc(a.id).collection("Combis").get().then((function(e){var t=[];e.forEach((function(e){var n=e.data(),a=[],s=[];a.push.apply(a,Object(A.a)(n.filterList)),s.push.apply(s,Object(A.a)(n.filterList));var r={fName:c.groupFeature,fValue:e.data().groupValue};if(e.data().ageGender){if(""!==e.data().ageGender.age){var i={fName:"age",fValue:e.data().ageGender.age};a.push(i),s.push(i)}if(""!==e.data().ageGender.gender){var o={fName:"gender",fValue:e.data().ageGender.gender};a.push(o),s.push(o)}}a.push(r);var u="";l.forEach((function(t,n){t.featureName===c.groupFeature&&(t.featureValue1===e.data().groupValue&&(u=t.featureValue2),t.featureValue2===e.data().groupValue&&(u=t.featureValue1))}));var d={fName:c.groupFeature,fValue:u};s.push(d),n.favorFilters=a,n.againstFilters=s,t.push(n)}));var s=[].concat(n);s[n.findIndex((function(e){return e.id===a.id}))].combis=t,i(s)}))}))})).catch((function(e){console.log("Error with loading document"+e)}))}}),[e,t,c]),{aspectObjs:r}}function Z(e,t){var c=Object(a.useState)([]),s=Object(u.a)(c,2),r=s[0],i=s[1];Object(a.useEffect)((function(){var c=[];c.push(Object(n.jsx)("div",{children:Object(n.jsx)("div",{className:"mb-3",children:" \u0394 P shows the difference in probability that the aspect is true and the probability that the aspect is not true"},"headtext")},"head")),e.forEach((function(e,a){var s=e.aspectDescr,r=[],u=[];e.combis&&e.combis.forEach((function(e){t.filter((function(t){var c=!0;return e.favorFilters.forEach((function(e){e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){-1===r.indexOf(e)&&r.push(e)}));t.filter((function(t){var c=!0;return e.againstFilters.forEach((function(e){e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){-1===u.indexOf(e)&&u.push(e)}))}));var d=0;(u.length>0||r.length>0)&&(d=r.length/(r.length+u.length)*2-1);var j=Math.abs(50*d),b=l(d),h=o(d);c.push(Object(n.jsxs)("div",{className:"pb-2",children:[Object(n.jsx)("span",{className:"text-secondary",children:s},"asp-desc ".concat(a)),Object(n.jsx)("br",{}),Object(n.jsxs)("div",{className:b,children:[Object(n.jsx)("div",{className:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"},"pg-bar-pt1 ".concat(a)),0===d&&Object(n.jsx)("div",{class:"progress-bar bg-teal",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"},"pg-bar-pt2 ".concat(a)),Object(n.jsx)("div",{className:h,role:"progressbar","aria-valuenow":d,"aria-valuemin":"0","aria-valuemax":"100",style:{width:j+"%"},children:(d>=.2||d<=-.2)&&Object(n.jsxs)("span",{className:"sr-only",children:["\u0394 P = ",d.toFixed(2)]},"pg-title ".concat(a))},"pg-bar-pt3 ".concat(a))]},"clNames ".concat(a)),d<.2&&d>-.2&&Object(n.jsxs)("div",{children:["\u0394 P = ",d.toFixed(2)]},"pg-desc ".concat(a)),Object(n.jsxs)("span",{children:["(Chosen ",(100*d).toFixed(0),"% ",d<0?"less":"more"," than the opposite.)"]},"pg-desc2 ".concat(a))]},"graphs ".concat(a))),i(c)})),0===e.length&&i([Object(n.jsx)("div",{children:Object(n.jsx)("h5",{children:"No aspects defined."})})])}),[e,t]);var l=function(e){var t="progress w-80 mx-auto";return e<0&&(t="progress w-80 mx-auto flex-row-reverse"),t},o=function(e){var t="progress-bar bg-teal progress-bar-striped";return e<0&&(t="progress-bar bg-purple progress-bar-striped"),t};return{resultHtml:r}}var q=function(e,t){var c=Object(a.useState)([]),n=Object(u.a)(c,2),s=n[0],r=n[1];return Object(a.useEffect)((function(){if(e&&t){var c=p.collection("users").doc(e).collection("DceList").doc(t).collection("RawResults").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(h.a)(Object(h.a)({},e.data().pref),{},{id:e.id}))})),r(t)}));return function(){return c()}}}),[e,t]),{results:s}};function W(e){var t=e.currentDce,c=e.dceId,a=e.userId,s=q(a,c).results,r=Z(Y(a,c,t).aspectObjs,s).resultHtml;return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"mb-5",children:[Object(n.jsx)("h3",{children:"Total results from all particpants: "}),r]},"title")},"main")}function X(e){var t=e.resultList,c=e.currentDce,a=e.dceId,s=e.userId,r=Z(Y(s,a,c).aspectObjs,t).resultHtml;return Object(n.jsxs)("div",{className:"my-5",children:[Object(n.jsx)("p",{children:"Thank you for completing this experiment!"}),c.grouped&&Object(n.jsx)("div",{className:"col resultsContainer mx-3",children:Object(n.jsxs)("div",{className:"mb-5",children:[Object(n.jsx)("h3",{children:"Your results: "}),r]})}),c.grouped&&Object(n.jsx)("div",{className:"col resultsContainer mx-3",children:Object(n.jsx)(W,{currentDce:c,dceId:a,userId:s})})]})}var _=function(e,t){for(var c=[],n=[],a=0;a<t;a++){for(var s=-1,r=5*e;r>0;r--){var i=Math.floor(Math.random()*e);if(!c.includes(i)){s=i;break}}-1!==s&&c.push(s),n.push(s)}return n};var $=function e(t,c,n,a,s,r){Object(y.a)(this,e),this.id=t,this.name=c,this.descr=n,this.nrQuestions=a,this.features=s,this.grouped=r,this.scList=[],this.aspectList=[]},ee=function(e){Object(w.a)(c,e);var t=Object(D.a)(c);function c(e,n,a,s,r,i,l,o){var u;return Object(y.a)(this,c),(u=t.call(this,e,n,a,s,r,i,o)).groupFeature=l,u}return c}($);var te=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)([]),i=Object(u.a)(r,2),l=i[0],o=i[1],j=Object(a.useState)({age:"",gender:""}),b=Object(u.a)(j,2),h=b[0],m=b[1],f=Object(a.useState)([]),O=Object(u.a)(f,2),x=O[0],v=O[1],g=Object(a.useState)([]),N=Object(u.a)(g,2),S=N[0],y=N[1],C=Object(a.useState)(null),w=Object(u.a)(C,2),D=w[0],E=w[1],L=Object(a.useState)(null),k=Object(u.a)(L,2),V=k[0],F=k[1],G=Object(a.useState)(null),P=Object(u.a)(G,2),R=P[0],T=P[1],Q=Object(a.useState)(null),M=Object(u.a)(Q,2),Y=M[0],Z=M[1],q=Object(a.useState)(0),W=Object(u.a)(q,2),te=W[0],ce=W[1],ne=Object(a.useState)(null),ae=Object(u.a)(ne,2),se=ae[0],re=ae[1],ie=Object(a.useState)(null),le=Object(u.a)(ie,2),oe=le[0],ue=le[1],de=Object(a.useState)([]),je=Object(u.a)(de,2),be=je[0],he=je[1],me=Object(a.useState)(null),fe=Object(u.a)(me,2),Oe=fe[0],pe=fe[1],xe=Object(a.useState)(""),ve=Object(u.a)(xe,2),ge=ve[0],Ne=ve[1],Se=Object(a.useState)(!1),ye=Object(u.a)(Se,2),Ce=ye[0],we=ye[1],De=Object(a.useState)(!1),Ee=Object(u.a)(De,2),Le=Ee[0],ke=Ee[1],Ae=Object(a.useState)(""),Ie=Object(u.a)(Ae,2),Ve=Ie[0],Fe=Ie[1],Ge=Object(d.g)(),Pe=Ge.userId,Re=Ge.dceId,Te=H(Pe,Re).scenarios,Je=function(e,t,c,n){var s=Object(a.useState)(null),r=Object(u.a)(s,2),i=r[0],l=r[1],o=Object(a.useState)(null),d=Object(u.a)(o,2),j=d[0],b=d[1];return Object(a.useEffect)((function(){if(console.log("entering useeffect in getScenarios, nrQ en grouped:"+t+n),e&&t&&n&&e.length>0){var c=e.length;console.log("maxNr: "+c);var a=_(c,t),s=[];console.log("scenarios: "+JSON.stringify(e)),a.forEach((function(t){s.push(e[t])}));var r=[];n&&(console.log("scListA: "+JSON.stringify(s)),s.forEach((function(t){r.push(e.find((function(e){return e.id===t.altnr})))}))),n||_(c,t).forEach((function(t){r.push(e[t])})),l(s),b(r)}}),[e,t,n]),{scenarioListA:i,scenarioListB:j}}(Te,te,0,se),Be=Je.scenarioListA,Qe=Je.scenarioListB;Object(a.useEffect)((function(){U.a.AutoInit()})),Object(a.useEffect)((function(){Qe&&Be&&(E(Be[R]),F(Qe[R]))}),[Be,Qe,R]);var Ue=function(e){if(e){var t=Object(A.a)(c);t.push(e),s(t)}R+2>te&&we(!0),T((function(e){return e+1})),function(e,t,c,a,s){var r=[];(r=Object(A.a)(e)).push(Object(n.jsx)("span",{className:"dot blue darken-2"},"filleddot".concat(s))),t(r);var i=[];(i=Object(A.a)(c)).pop(),a(i)}(x,v,S,y,R)};return Object(a.useEffect)((function(){if(Te&&Pe&&Re){Fe(""),s([]);var e=Te.map((function(e){return e.fValues}));console.log("fValuesArray: "+JSON.stringify(e)),console.log("containsEmpty: false"),p.collection("users").doc(Pe).collection("DceList").doc(Re).get().then((function(e){if(e.data().grouped&&Te.length<2*e.data().nrQuestions||!e.data().grouped&&(Te.length<e.data().nrQuestions||Te.length<2))Fe("The scenario's are incomplete - please contact the researcher.");else{Fe("");var t,c=e.data().grouped;t=e.data().grouped?new ee(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped,e.data().groupFeature):new $(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped),Z(t),he(e.data().features);var a={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};pe(a),ue(e.data().descr),Ne(e.data().name),ce(e.data().nrQuestions),re(c),y(function(e){for(var t=[],c=0;c<e;c++)t.push(Object(n.jsx)("span",{className:"dot"},"emptydot".concat(c)));return t}(e.data().nrQuestions)),Te.length}})).catch((function(e){console.error("Error loading document: ",e)}))}}),[Te,Pe,Re]),function(e,t,c,n,s){var r=Object(a.useRef)(!0);Object(a.useEffect)((function(){if(r.current)r.current=!1;else{var e=p.collection("users").doc(c).collection("DceList").doc(n).collection("RawResults"),a=[];t.forEach((function(t,c){e.add(t),a.push(t.pref,c)})),s(a)}}),[e])}(Ce,c,Pe,Re,o),Object(n.jsxs)("div",{children:[Object(n.jsx)(B,{sc1:D,sc2:V}),!Ce&&!Le&&Object(n.jsx)(z,{nrQuestions:te,setStarted:ke,setQNr:T,handleAGChoice:function(e,t){var c=h;c[t]=e,m(c)}}),!Ce&&Le&&!Ve&&Object(n.jsx)(J,{handleClick:Ue,sc1:D,sc2:V,dceDescr:oe,ageGender:h}),!Ce&&Le&&!Ve&&D&&V&&Object(n.jsx)(K,{handleClick:Ue,sc1:D,sc2:V,dceDescr:oe,ageGender:h}),!Ce&&Le&&!Ve&&Object(n.jsx)(I,{}),!Ce&&Le&&!Ve&&Object(n.jsxs)("div",{className:"footer",children:[x,S]}),Ce&&Le&&!Ve&&Pe&&Re&&Object(n.jsx)(X,{resultList:l,currentDce:Y,dceDetails:Oe,dceNameEdit:ge,dceId:Re,dceFeatures:be,userId:Pe}),Ve&&Object(n.jsx)("div",{className:"text-danger mt-5",children:Object(n.jsxs)("h4",{children:["Error: ",Ve]})})]})},ce=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)(""),i=Object(u.a)(r,2),o=i[0],d=i[1],j=Object(a.useState)(null),b=Object(u.a)(j,2),h=b[0],m=b[1],f=function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c?s(n):"userPassword"===c&&d(n)};return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign In"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[null!==h&&Object(n.jsx)("div",{className:"text-danger mb-3",children:h}),Object(n.jsxs)("form",{className:"",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your email",id:"userEmail",onChange:function(e){return f(e)}}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsxs)("div",{className:"form-floating ",children:[Object(n.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return f(e)}}),Object(n.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){!function(e,t,c){e.preventDefault(),x.signInWithEmailAndPassword(t,c).catch((function(e){m("Error signing in with password and email!"),console.error("Error signing in with password and email",e)}))}(e,c,o)},children:"Sign in"})]}),Object(n.jsx)("p",{className:"my-3",children:"or"}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){g()},children:"Sign in with Google"}),Object(n.jsxs)("p",{className:"my-3",children:["Don't have an account?"," ",Object(n.jsx)(l.b,{to:"/signUp",className:"text-blue-500 hover:text-blue-600",children:"Sign up here"})," ",Object(n.jsx)("br",{})," ",Object(n.jsx)(l.b,{to:"passwordReset",className:"text-blue-500 hover:text-blue-600",children:"Forgot Password?"})]})]})]})},ne=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)(""),i=Object(u.a)(r,2),o=i[0],d=i[1],j=Object(a.useState)(""),h=Object(u.a)(j,2),f=h[0],O=h[1],p=Object(a.useState)(null),v=Object(u.a)(p,2),S=v[0],y=v[1],C=function(){var e=Object(m.a)(b.a.mark((function e(t,c,n){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,x.createUserWithEmailAndPassword(c,n);case 4:a=e.sent,r=a.user,N(r,{displayName:f}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),y("Error Signing up with email and password");case 12:s(""),d(""),O("");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,c,n){return e.apply(this,arguments)}}(),w=function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c?s(n):"userPassword"===c?d(n):"displayName"===c&&O(n)};return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign Up"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[null!==S&&Object(n.jsx)("div",{className:"text-danger mb-3",children:S}),Object(n.jsxs)("form",{className:"",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"text",className:"form-control ",name:"displayName",value:f,placeholder:"Display name",id:"displayName",onChange:function(e){return w(e)}}),Object(n.jsx)("label",{htmlFor:"displayName",className:"block",children:"Display Name:"})]}),Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your Email",id:"userEmail",onChange:function(e){return w(e)}}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return w(e)}}),Object(n.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){C(e,c,o)},children:"Sign up"})]}),Object(n.jsx)("p",{className:"my-3",children:"or"}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){try{g()}catch(S){console.error("Error signing in with Google",S)}},children:"Sign In with Google"}),Object(n.jsxs)("p",{className:"my-3",children:["Already have an account?"," ",Object(n.jsx)(l.b,{to:"/",className:"text-blue-500 hover:text-blue-600",children:"Sign in here"})," "]})]})]})},ae=function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)(!1),i=Object(u.a)(r,2),o=i[0],d=i[1],j=Object(a.useState)(null),b=Object(u.a)(j,2),h=b[0],m=b[1];return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-xl text-center font-bold mb-3",children:"Reset your Password"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[Object(n.jsxs)("form",{action:"",children:[o&&Object(n.jsx)("div",{className:"text-danger mb-3",children:"An email has been sent to you!"}),null!==h&&Object(n.jsx)("div",{className:"text-danger mb-3",children:h}),Object(n.jsxs)("div",{class:"form-floating",children:[Object(n.jsx)("input",{type:"email",name:"userEmail",id:"userEmail",value:c,placeholder:"Input your email",onChange:function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c&&s(n)},className:"form-control"}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info my-3",onClick:function(e){!function(e){e.preventDefault(),x.sendPasswordResetEmail(c).then((function(){d(!0),setTimeout((function(){d(!1)}),3e3)})).catch((function(){m("Error resetting password")}))}(e)},children:"Send me a reset link"})]}),Object(n.jsx)(l.b,{to:"/",className:"my-2 text-blue-700 hover:text-blue-800 text-center block",children:"\u2190 back to sign in page"})]})]})},se=function(e){var t=Object(a.useState)(0),c=Object(u.a)(t,2),n=c[0],s=c[1],r=Object(a.useState)(null),i=Object(u.a)(r,2),l=i[0],o=i[1],d=Object(a.useState)(null),j=Object(u.a)(d,2),h=j[0],f=j[1];return Object(a.useEffect)((function(){var t=O.ref(e.name);t.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;s(t)}),(function(e){o(e)}),Object(m.a)(b.a.mark((function e(){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:c=e.sent,f(c);case 4:case"end":return e.stop()}}),e)}))))}),[e]),{progress:n,url:h,error:l}},re=function(e){var t=e.file,c=e.setFile,s=e.dceId,r=e.scNr,i=e.setUrl,l=se(t,s,r),o=l.progress,u=l.url,d=Object(a.useCallback)((function(e){i(e)}),[i]);return Object(a.useEffect)((function(){u&&(c(null),d(u))}),[u,c,d]),Object(n.jsx)("div",{className:"progress-bar",style:{width:o+"%"}})},ie=function(e){var t=e.dceId,c=e.scNr,s=e.setUrl,r=Object(a.useState)(null),i=Object(u.a)(r,2),l=i[0],o=i[1],d=Object(a.useState)(null),j=Object(u.a)(d,2),b=j[0],h=j[1],m=["image/png","image/jpeg"];return Object(n.jsxs)("div",{children:[Object(n.jsxs)("label",{children:[Object(n.jsx)("input",{type:"file",style:{height:0,width:0},onChange:function(e){var t=e.target.files[0];t&&m.includes(t.type)?(o(t),h("")):(o(null),h("Please select an image file (png or jpg)"))}}),Object(n.jsx)("span",{className:"btn btn-sm btn-outline-info mb-3",children:"Upload image"})]}),Object(n.jsxs)("div",{className:"output",children:[b&&Object(n.jsx)("div",{className:"error",children:b}),l&&Object(n.jsx)("div",{children:l.name}),l&&Object(n.jsx)(re,{file:l,setFile:o,dceId:t,scNr:c,setUrl:s})]})]})},le=function(e,t,c,s,r,i,l,o,d,j,b){var m=r.scNr,f=r.setIsSaved,O=r.isSaved,p=Object(a.useState)([]),x=Object(u.a)(p,2),v=x[0],g=x[1],N=function(e){var t=Object(h.a)({},c);t.scImg=e,s(t),f(!1)};return Object(a.useEffect)((function(){if(console.log("useScDtl triggered"),Object.keys(c).length>0){var a=[];return a.push(Object(n.jsx)(n.Fragment,{children:c.id&&Object(n.jsxs)("div",{children:[e&&e.grouped&&Object(n.jsxs)("h5",{children:["Paired with scenario nr: ",c.altnr]}),Object(n.jsxs)("div",{className:"form-row",children:[Object(n.jsx)("h6",{children:"Features"}),Object(n.jsxs)("div",{className:"row",children:[console.log("inside features, fValues are:.."+JSON.stringify(c.fValues)),c.fValues&&e.features&&e.features.map((function(e,t){var a=[{label:e.featureValue1,value:e.featureValue1},{label:e.featureValue2,value:e.featureValue2}];return Object(n.jsxs)("div",{className:"col-md-4  mb-3",children:[" ",Object(n.jsx)("label",{htmlFor:t,className:"col-form-label",children:e.featureName}),Object(n.jsx)(M.a,{options:a,placeholder:c.fValues[e.featureName]||"Select..",defaultValue:c.fValues[e.featureName],isDisabled:c.altSc,onChange:function(t){return i(t.value,e.featureName)},id:t},c.id+t)]},t)}))]})]},"form-row"),Object(n.jsxs)("form",{id:"textForm",children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("h6",{children:"Scenario text"}),Object(n.jsx)("textarea",{className:"form-control form-control-sm mb-3",name:"scText",value:c.scText,placeholder:"Enter scenario text",id:"scText",onChange:function(e){return j(e)}})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h6",{children:"Scenario explanation"}),Object(n.jsx)("textarea",{className:"form-control form-control-sm mb-3",type:"text",name:"scExpl",value:c.scExpl,placeholder:"Enter additional explanatory text",id:"scExpl",onChange:function(e){return j(e)}})]}),Object(n.jsx)("h6",{children:"Scenario image link"}),Object(n.jsx)(ie,{dceId:t,scNr:m,setUrl:N}),c.scImg&&Object(n.jsx)("img",{src:c.scImg,className:"scImage",alt:"scenario"}),e&&e.grouped&&!c.altnr&&Object(n.jsx)("input",{className:"btn  btn-outline-success my-3",type:"button",onClick:function(e){return d(e)},value:"Save & Create pair"}),(c.altnr||!e.grouped)&&Object(n.jsx)("input",{className:"btn  btn-outline-success my-3",onClick:function(e){return o(e)},value:"Save"})]}),O&&Object(n.jsx)("div",{className:O,children:"Scenario has been saved"})]})})),void g(a)}}),[e,c,O]),{scenarioHtml:v}};function oe(e){var t=e.currentDce,c=e.dceId,s=e.currentSc,r=e.setCurrentSc,i=(e.scList,e.scProps),l=e.chosen,o=e.setChosen,u=(i.scNr,i.setScNr,i.handleAddScenario),d=i.setIsSaved,j=(i.isSaved,Object(a.useContext)(E).uid),f=function(e){var c,n=t.groupFeature,a=e[n];t.features.forEach((function(e){e.featureName===n&&(e.featureValue1===a&&(c=e.featureValue2),e.featureValue2===a&&(c=e.featureValue1))}));var s=Object(h.a)({},e);return s[n]=c,s},O=function(){var e,c=!1;return 0!==s.scText.length||0!==s.scImg.length?c=!0:alert("Fill in the Scenario Text or upload a Scenario Image, or do both"),e=!t.features.some((function(e){return 0===s.fValues[e.featureName].length&&alert("Select a value for every feature in the scenario"),0===s.fValues[e.featureName].length})),c&&e},x=function(){var e=Object(m.a)(b.a.mark((function e(n){var a,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),O()&&(v(s),a=s.altnr,console.log("altnr is: "+a),console.log("fValues i currentSc: "+JSON.stringify(s.fValues)),r=f(s.fValues),console.log("altFValuesList in handlesave: "+JSON.stringify(r)),a&&(i=t.scList.findIndex((function(e){return e.id===a})),console.log("altIndex is: "+i),console.log("altSc is: "+JSON.stringify(t.scList[i])),t.scList[i].fValues=r,p.collection("users").doc(j).collection("DceList").doc(c).collection("Scenarios").doc(a.toString()).update({fValues:r})),d(!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(e){var n=t.scList.findIndex((function(t){return t.id===e.id}));console.log("scIndex is: "+n),t.scList[n]=e,p.collection("users").doc(j).collection("DceList").doc(c).collection("Scenarios").doc(s.id.toString()).set(Object.assign({},e))},g=le(t,c,s,r,i,(function(e,t){var c=Object(h.a)({},s);c.fValues[t]=e,r(c),d(!1)}),o,x,(function(e){if(O()){console.log("fValues of currentSc: "+JSON.stringify(s.fValues)),console.log("currentSc.id: "+s.id);var t=f(s.fValues);console.log("altFValues after get: "+JSON.stringify(t)),u(t,s.id).then((function(e){s.altnr=e,v(s)}))}}),(function(e){e.preventDefault();var t=e.target,c=t.name,n=t.value,a=Object(h.a)({},s);a[c]=n,r(a),d(!1)}),l).scenarioHtml;return Object(n.jsx)("div",{children:g},"1")}var ue=function e(t,c,n,a,s,r,i){Object(y.a)(this,e),this.id=t,this.scText=c,this.scExpl=n,this.scImg=a,this.fValues=s,this.altSc=r,this.altnr=i};function de(e){var t=e.currentDce,c=e.dceId,s=e.currentSc,r=e.setCurrentSc,i=Object(a.useContext)(E).uid,o=Object(a.useState)([{nr:0}]),d=Object(u.a)(o,2),j=d[0],f=d[1],O=Object(a.useState)(""),x=Object(u.a)(O,2),v=(x[0],x[1]),g=Object(a.useState)(""),N=Object(u.a)(g,2),S=N[0],y=N[1],C=Object(a.useState)(!1),w=Object(u.a)(C,2),D=w[0],L=w[1];Object(a.useEffect)((function(){f([{}]),y(null),L(!1)}),[c]);var k=function(){var e=Object(m.a)(b.a.mark((function e(n,a){var s,l,o,u,d,j;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=19;break}return s={},t.features.forEach((function(e){s[e.featureName]=""})),l=1,t.scList.forEach((function(e){e.id===l&&(l+=1)})),o=!1,a&&(o=!0,s=Object(h.a)({},n)),console.log("altFValues: "+JSON.stringify(n)),u={id:l,altnr:a,altSc:o,fValues:s,scText:"",scImg:"",scExpl:""},d=p.collection("users").doc(i).collection("DceList").doc(c).collection("Scenarios"),console.log("newScDetails: "+JSON.stringify(u)),d.doc(l.toString()).set(u),j=new ue(l,"","","",s,o,a||null),console.log("newSc: "+JSON.stringify(j)),t.scList.push(j),L(!1),r(j),v(l.toString()+"created"),e.abrupt("return",j.id);case 19:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}(),A={scNr:S,setScNr:y,handleAddScenario:k,setIsSaved:L,isSaved:D};return Object(n.jsxs)("div",{children:[Object(n.jsxs)("h4",{children:[Object(n.jsx)("u",{children:"Details"})," for ",Object(n.jsxs)("b",{children:[" ",t&&t.name]}),s.id&&Object(n.jsxs)("span",{children:[" - Scenario nr. ",s.id]}),!s.id&&Object(n.jsx)("span",{children:" - Select a scenario nr."})]}),Object(n.jsx)("div",{className:"",children:Object(n.jsxs)("h6",{children:[t&&Object(n.jsxs)("span",{children:[" ",Object(n.jsx)(l.b,{to:{pathname:"/app/"+i+"/"+t.id},children:Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"play_circle_outline"})})})]}),t&&Object(n.jsx)("span",{children:" Play this DCE"})," ",t&&Object(n.jsxs)("span",{children:[" ",Object(n.jsx)("hr",{className:"ruler detailsRuler"})," ",Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){var e=window.location.href+"app/"+i+"/"+t.id;navigator.clipboard.writeText(e)},children:"Copy DCE link "})]})," "]})}),Object(n.jsx)("div",{className:"pb-4",children:Object(n.jsxs)("h6",{children:[" ",t&&t.grouped&&Object(n.jsxs)("span",{children:["Group feature: ",t&&t.groupFeature]})," ",Object(n.jsxs)("span",{children:[" ",Object(n.jsx)("hr",{className:"ruler detailsRuler"})," Questions in DCE: ",t&&t.nrQuestions]})]})}),Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"scenarioList col col-6 col-md-3 col-sm-5",children:[Object(n.jsx)("h5",{children:"Scenario's"}),Object(n.jsxs)("ul",{children:[Object(n.jsxs)("li",{className:"listRuler mb-1",children:["Nr.  ",Object(n.jsx)("hr",{className:"ruler"})," Edit ",Object(n.jsx)("hr",{className:"rulerSm"}),"\xa0Delete "]},"header"),t.scList&&t.scList.map((function(e,a){return Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){r({dummy:"clear"+a}),r(e)},children:e.id}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsxs)("button",{className:"btn  btn-outline-warning btn-sm mx-2",onClick:function(){r({dummy:"clear"+a}),r(e)},children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"edit"})]}),Object(n.jsx)("hr",{className:"rulerSm"}),Object(n.jsxs)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:function(){window.confirm("Are you sure you wish to delete this scenario?")&&function(e){var n=e.id;console.log("scId to be deleted: "+JSON.stringify(n));var a=t.scList.findIndex((function(e){return e.id===n})),l=t.scList[a].altnr;if(console.log("scIndx "+a),t.scList.splice(a,1),console.log("scList: "+JSON.stringify(t.scList)),p.collection("users").doc(i).collection("DceList").doc(c).collection("Scenarios").doc(n.toString()).delete().then((function(){console.log("Scenario with ID "+n+"  successfully deleted!"),n===s.id&&r({dummy:s.id}),v(n+"deleted"),L(!1)})).catch((function(e){console.error("Error removing document: ",e)})),l){var o=t.scList.findIndex((function(e){return e.id===l}));o&&t.scList.splice(o,1),p.collection("users").doc(i).collection("DceList").doc(c).collection("Scenarios").doc(l.toString()).delete().then((function(){console.log("Alt scenario with ID "+l.toString()+"  successfully deleted!"),v(l+"deleted")})).catch((function(e){console.error("Error removing document: ",e)}))}}(e)},children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]})]})})},a)})),t&&Object(n.jsx)("li",{className:"mb-2",children:Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){k(null,null)},children:"Add scenario"})})]})]}),Object(n.jsx)("div",{className:"col",children:Object(n.jsx)(oe,{currentDce:t,dceId:c,currentSc:s,setCurrentSc:r,scList:t.scList,scProps:A,chosen:j,setChosen:f})})]})]})}var je=c(5);function be(e){var t=e.addAspect,c=Object(a.useState)(["name"]),s=Object(u.a)(c,2),r=s[0],i=s[1],l=Object(a.useState)(["descr"]),o=Object(u.a)(l,2),j=o[0],b=o[1],h=Object(d.g)(),m=(h.userId,h.dceId,function(e,t){var c=e.target.value,n=Object(A.a)(t);return n[0]=c,n});return Object(n.jsx)("div",{children:Object(n.jsxs)("form",{className:"form-inline",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"text",className:"form-control",name:"aspectName",placeholder:"Aspect name",id:"aspectName",required:!0,onChange:function(e){var t=m(e,r);i(t)}}),Object(n.jsx)("label",{htmlFor:"aspectName",className:"block",children:"Name: "})]}),Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("textarea",{type:"text",rows:"7",className:"form-control",name:"aspectDescr",placeholder:"Description",id:"aspectDescr",required:!0,onChange:function(e){var t=m(e,j);b(t)}}),Object(n.jsx)("label",{htmlFor:"aspectDescr",className:"block",children:"Description: "})]}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){e.preventDefault(),t(r[0],j[0])},children:"Save aspect"})]})})}function he(e){var t=e.currentDce,c=e.refreshListFlag,s=e.setCurrentAsp,r=e.deleteAspect,i=Object(a.useState)([]),l=Object(u.a)(i,2),o=l[0],d=l[1];return Object(a.useEffect)((function(){var e=[];t.aspectList&&t.aspectList.map((function(t,c){e.push(Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h6",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":t.id,children:[" ",Object(n.jsx)("b",{children:t.name}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-warning",onClick:function(){s({dummy:"clear"+c}),s(t)},children:Object(n.jsx)("i",{className:"material-icons mat-icon",children:"edit"})}),Object(n.jsx)("hr",{className:"rulerSm"}),Object(n.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:function(){r(t)},children:Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})})]},c)})}))})),d(e)}),[t,c]),Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Aspect list"})}),Object(n.jsx)("ul",{children:o})]})})}var me=function e(t,c){Object(y.a)(this,e),this.age=t,this.gender=c},fe=function e(t,c,n){Object(y.a)(this,e),this.nr=t,this.groupValue=c,this.filterList=n},Oe=function e(t,c,n,a,s){Object(y.a)(this,e),this.id=t,this.name=c,this.descr=n,this.ageGender=a,this.combiList=s};var pe=function e(t,c){Object(y.a)(this,e),this.fName=t,this.fValue=c};function xe(e){var t=e.currentDce,c=e.currentAsp,s=e.showAspectsFlag,r=e.setCurrentDce,i=e.setCurrentAsp,l=e.filterSaved,o=e.setFilterSaved,j=e.aspectProps,b=e.editFunctions,m=e.editProps,f=Object(d.f)(),O=f.dceFeatures,p=f.groupFeature,x=b.saveFilters,v=(b.setAgeGenderValues,b.setGroupValues,b.setChosenFeatures,b.handleAddCombi),g=b.handleDeleteCombi,N=(j.aspectId,j.aspectFilters,m.groupValues,m.chosenFeatures,m.ageGenderValues,function(e,t,c,s,r,i,l,o,d,j,b,h,m){var f=Object(a.useState)([]),O=Object(u.a)(f,2),p=O[0],x=O[1],v=[{}],g=[{label:"younger than 25 years",value:"young"},{label:"25 years or older",value:"old"}],N=[{label:"female",value:"female"},{label:"male",value:"male"}],S=e.features;return Object(a.useEffect)((function(){var c=[];t.combiList&&t.combiList.forEach((function(a,l){console.log("combi in forEach: "+JSON.stringify(a)),c.push(Object(n.jsxs)("div",{id:l,children:[" ",0!==l&&Object(n.jsxs)("h5",{className:"my-5",children:[Object(n.jsxs)("button",{onClick:function(e){return b(e,l)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]}),"combined with:"]}),Object(n.jsxs)("h5",{children:["Select value for group feature - ",e.groupFeature]}),Object(n.jsx)("label",{htmlFor:"groupVal",children:"Group value"}),Object(n.jsx)("div",{className:"selectInputs mb-3",children:e.features&&v.map((function(c,s){return Object(n.jsx)(M.a,{options:[{label:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue1,value:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue1},{label:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue2,value:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue2}],placeholder:a.groupValue||"Select...",onChange:function(e){return i(e.value,l)}},"".concat(t.id,"-grValue- ").concat(l))}))}),Object(n.jsx)("h5",{children:"Filter features and values"})]})),a.filterList&&a.filterList.length>0&&a.filterList.forEach((function(a,i){c.push(Object(n.jsxs)("div",{id:i,className:"selectInputs my-3",children:[Object(n.jsx)("span",{children:Object(n.jsx)(M.a,{options:S&&S.map((function(t,c){var n=t.featureName,a=!1;return t.featureName===e.groupFeature&&(a=!0),{label:n,value:n,isDisabled:a}})),id:"fNames",placeholder:a.fName,onChange:function(e){console.log("option.value +cIndex in onChange: "+JSON.stringify(e.value)+l),s(e.value,l,i)}},"".concat(t.id,"-fName- ").concat(l))}),Object(n.jsx)("span",{className:"selectInputs pb-3",children:a.fName&&Object(n.jsx)(M.a,{options:[{label:S.find((function(e){return e.featureName===a.fName})).featureValue1,value:S.find((function(e){return e.featureName===a.fName})).featureValue1},{label:S.find((function(e){return e.featureName===a.fName})).featureValue2,value:S.find((function(e){return e.featureName===a.fName})).featureValue2}],placeholder:a.fValue||"Enter filter value",onChange:function(e){return r(e.value,l,i)}})}),Object(n.jsx)("span",{children:Object(n.jsxs)("button",{onClick:function(e){return o(e,i,l)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]})})]}))})),c.push(Object(n.jsx)("div",{children:Object(n.jsx)("span",{children:Object(n.jsx)("button",{onClick:function(e){return d(e,l)},className:"btn  btn-outline-success btn-sm mx-2",children:" Add filter feature"})})}))})),c.push(Object(n.jsxs)("div",{children:[!t.dummy&&Object.keys(t).length>0&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:j,children:"add combination feature"}),Object(n.jsx)("span",{children:S&&Object(n.jsx)("form",{children:Object(n.jsxs)("div",{className:"selectInputs pb-3",children:[t.ageGender&&Object(n.jsx)("label",{htmlFor:"ageFilter",className:"",children:"Optional filters for age and gender of participants "}),t.ageGender&&Object(n.jsx)(M.a,{options:g,isClearable:!0,id:"ageFilter",name:"age",placeholder:t.ageGender.age||"Select age filter ...",onChange:function(e,c){var n;n=null==e?"":e.value,l(c.name,n,t.id)}}),t.ageGender&&Object(n.jsx)(M.a,{options:N,isClearable:!0,id:"genderFilter",name:"gender",placeholder:t.ageGender.gender||"Select gender filter ...",onChange:function(e,c){var n;n=null==e?"":e.value,l(c.name,n,t.id)}})]})})}),!t.dummy&&Object.keys(t).length>0&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mb-3",onClick:h,children:"save all filters "}),m&&Object(n.jsx)("h6",{children:"Filter saved"})]})),x(c)}),[t,e,c]),{fromDb:p}}(t,c,s,(function(e,t,n){var a=Object(A.a)(c.combiList);a[t].filterList[n].fName=e,i((function(e){return Object(h.a)(Object(h.a)({},e),{},{combiList:a})})),o(!1)}),(function(e,t,n){var a=Object(A.a)(c.combiList);a[t].filterList[n].fValue=e,i((function(e){return Object(h.a)(Object(h.a)({},e),{},{combiList:a})})),o(!1)}),(function(e,t){var n=Object(A.a)(c.combiList);n[t].groupValue=e,i((function(e){return Object(h.a)(Object(h.a)({},e),{},{combiList:n})})),o(!1)}),(function(e,c,n){var a=t.aspectList.findIndex((function(e){return e.id===n})),s=Object(A.a)(t.aspectList),l=Object(h.a)({},s[a]),u=Object(h.a)({},l.ageGender);u[e]=c,l.ageGender=u,s[a]=l,r((function(e){return Object(h.a)(Object(h.a)({},e),{},{aspectList:s})})),i((function(e){return Object(h.a)(Object(h.a)({},e),{},{ageGender:u})})),o(!1)}),(function(e,t,n){e.preventDefault();var a=Object(A.a)(c.combiList);a[n].filterList.splice(t,1),i((function(e){return Object(h.a)(Object(h.a)({},e),{},{combiList:a})})),o(!1)}),(function(e,t){e.preventDefault();var n=Object(A.a)(c.combiList);n[t].filterList.push(new pe("","")),i((function(e){return Object(h.a)(Object(h.a)({},e),{},{combiList:n})})),o(!1)}),v,g,x,{groupFeature:p,dceFeatures:O,filterSaved:l}).fromDb);return c.dummy||0!==!Object.keys(c).length||[].push(Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:v,children:"add combination feature"})),Object(n.jsxs)("div",{children:[Object(n.jsxs)("h4",{className:"mb-1",children:["Define aspect for ",Object(n.jsx)("b",{children:c.name||"(Select an aspect..)"})]}),Object(n.jsxs)("h6",{className:"text-secondary pb-3",children:["Description: ",c.descr]}),!c.dummy&&N]})}function ve(e){var t=e.currentDce,c=e.dceId,s=e.currentAsp,r=e.setCurrentDce,i=e.setCurrentAsp,l=Object(a.useContext)(E).uid,o=Object(a.useState)(""),d=Object(u.a)(o,2),j=d[0],b=d[1],h=Object(a.useState)(""),m=Object(u.a)(h,2),f=m[0],O=m[1],x=Object(a.useState)(!1),v=Object(u.a)(x,2),g=v[0],N=v[1],S=Object(a.useState)([]),y=Object(u.a)(S,2),C=y[0],w=y[1],D=Object(a.useState)([]),L=Object(u.a)(D,2),k=L[0],A=(L[1],Object(a.useState)([])),I=Object(u.a)(A,2),V=I[0],F=I[1],G=Object(a.useState)([{age:"",gender:""}]),P=Object(u.a)(G,2),R=P[0],T=P[1],J=Object(a.useState)(!1),B=Object(u.a)(J,2),Q=B[0],U=B[1],K=Object(a.useState)("(Click on ICON in Aspect list)"),M=Object(u.a)(K,2),z=(M[0],M[1],Object(a.useState)("")),H=Object(u.a)(z,2),Y=(H[0],H[1],Object(a.useState)("")),Z=Object(u.a)(Y,2),q=Z[0],W=(Z[1],function(){var e=0;return s.combiList.sort((function(e,t){return e.nr-t.nr})).forEach((function(t){if(t.nr!==e)return e;e+=1})),e}),X=function(e){console.log("user en dce en aspect ids: "+l+c+s.Id),console.log("combi nr: "+e.nr),p.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList").doc(s.id).collection("Combis").doc(e.nr.toString()).set(Object.assign({},e)).then((function(){console.log("combi added with nr "+e.nr)})).catch((function(e){console.log("Error adding combi",e)}))},_=function(){Q?U(!1):Q||U(!0)},$={saveFilters:function(){var e=p.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList");console.log("aspectList in SaveFilters: "+JSON.stringify(t.aspectList)),t.aspectList.length>0&&t.aspectList.forEach((function(t){e.doc(t.id).update({ageGender:{age:t.ageGender.age,gender:t.ageGender.gender}});var c=e.doc(t.id).collection("Combis");t.combiList.length>0&&t.combiList.forEach((function(e){var t=e.filterList,n=Object(je.a)(e,["filterList"]),a=[];t.forEach((function(e){var t={fName:e.fName,fValue:e.fValue};a.push(t)})),n.filterList=a,console.log("restOfCombi is:"+JSON.stringify(n)),c.doc(e.nr.toString()).set(Object.assign({},n)).then((function(){console.log("combi saved with nr "+e.nr)})).catch((function(e){console.log("Error saving combi",e)}))}))}))},setGroupValues:F,setAgeGenderValues:T,setChosenFeatures:w,handleAddCombi:function(){var e=W(),t=new fe(e,"",[]);s.combiList.push(t),X(t),b("combi added"+e)},handleDeleteCombi:function(e,t){s.combiList.splice(t,1),p.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList").doc(s.id).collection("Combis").doc(t.toString()).delete().then((function(){console.log("Combination successfully deleted!"),b("combi deleted"+t)})).catch((function(e){console.error("Error removing document: ",e)}))}},ee={ageGenderValues:R,groupValues:V,chosenFeatures:C},te={aspectId:q,aspectFilters:k};return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsx)(he,{currentDce:t,refreshListFlag:f,setCurrentAsp:i,deleteAspect:function(e){var n=e.id,a=t.aspectList.findIndex((function(e){return e.id===n})),r=p.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList").doc(n);r.collection("Combis").get().then((function(e){e.forEach((function(e){r.collection("Combis").doc(e.id).delete().then((function(){console.log("Combi with ID "+e.id+" deleted")}))}))})).then((function(){r.delete().then((function(){t.aspectList.splice(a,1),console.log("Document with ID"+n+"  successfully deleted!"),O("set flag "+n)})).catch((function(e){console.error("Error removing document: ",e)})),s.id===n&&i({dummy:s.id})}))}}),Object(n.jsx)("div",{className:"row my-4",children:Object(n.jsxs)("div",{className:"col-auto  ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Create new Aspect"})}),Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:_,children:" new Aspect"})]}),Q&&Object(n.jsx)(be,{dceId:c,addAspect:function(e,n){var a=p.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList");a.add({aspectName:e,aspectDescr:n,ageGender:{age:"",gender:""}}).then((function(c){console.log("Document written with ID: ",c.id),a.doc(c.id).collection("Combis").doc("0").set({nr:0,groupValue:"",filterList:[]});var s=[new fe(0,"",[])],r=new me("",""),l=new Oe(c.id,e,n,r,s);t.aspectList.push(l),i(l),O("new aspect saved id "+c.id)})).catch((function(e){console.error("Error adding document: ",e)})),_()},setRefreshListFlag:O,showNewAspectForm:_})]})})]}),Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(xe,{currentDce:t,currentAsp:s,showAspectsFlag:j,setCurrentDce:r,setCurrentAsp:i,filterSaved:g,setFilterSaved:N,aspectProps:te,editFunctions:$,editProps:ee})})]})})}var ge=function(e){var t=Object(a.useState)([]),c=Object(u.a)(t,2),n=c[0],s=c[1];return Object(a.useEffect)((function(){p.collection("users").doc(e).collection("DceList").get().then((function(e){var t=[];e.docs.forEach((function(e){var c;c=e.data().grouped?new ee(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped,e.data().groupFeature):new $(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped),t.push(c)})),s(t)})).catch((function(e){console.log("Error with loading dce"+e)}))}),[e]),Object(a.useEffect)((function(){n.forEach((function(t){p.collection("users").doc(e).collection("DceList").doc(t.id).collection("Scenarios").orderBy("id").get().then((function(e){var c=[];e.forEach((function(e){var t=new ue(e.data().id,e.data().scText,e.data().scExpl,e.data().scImg,e.data().fValues,e.data().altSc,e.data().altnr);c.push(t)})),t.scList=c})).catch((function(e){console.log("Error with loading scenario document"+e)}))}))}),[n]),Object(a.useEffect)((function(){n.forEach((function(t){p.collection("users").doc(e).collection("DceList").doc(t.id).collection("AspectList").get().then((function(c){var n=[];c.forEach((function(c){var a=p.collection("users").doc(e).collection("DceList").doc(t.id).collection("AspectList").doc(c.id),s=[];a.collection("Combis").get().then((function(e){e.forEach((function(e){var t=new fe(e.data().nr,e.data().groupValue,e.data().filterList);s.push(t)})),c.data().ageGender&&console.log("ageGender: "+JSON.stringify(c.data().ageGender.age));var t=new me("","");c.data().ageGender&&(t=new me(c.data().ageGender.age,c.data().ageGender.gender));var a=new Oe(c.id,c.data().aspectName,c.data().aspectDescr,t,s);n.push(a)})),t.aspectList=n}))})).catch((function(e){console.log("Error with loading aspect document"+e)}))}))}),[n]),n},Ne=function(e,t,c,s){var r=e.handleEntry,i=(e.handleDescrInputChange,e.handleInputChange),l=e.handleRemoveClick,o=e.handleNrQuestionsInput,d=e.inputList,j=t.setGroupValue,b=t.groupChecked,h=t.groupValue,m=t.handleCheckbox,f=c.handleAddClick,O=c.saveDce,p=c.nrQuestions,x=Object(a.useState)([]),v=Object(u.a)(x,2),g=v[0],N=v[1];return Object(a.useEffect)((function(){var e=[],t=d&&d.map((function(e,t){return{label:e.featureName,value:e.featureName}}));e.push(Object(n.jsx)("div",{children:Object(n.jsxs)("form",{className:"form-inline",children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:"dceName",className:"block",children:"Name: "}),Object(n.jsx)("input",{type:"text",className:"form-control mb-2",name:"name",placeholder:"DCE name",id:"dceName",onChange:function(e){return r(e)}},"dceName")]},"formdiv"),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:"descr",className:"block",children:"Description: "}),Object(n.jsx)("textarea",{type:"text",className:"form-control mb-2",name:"descr",rows:"3",placeholder:"This text will be displayed in the DCE",id:"descr",onChange:function(e){return r(e)}},"descr")]},"formdiv2"),d&&d.map((function(e,t){return Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"",children:[Object(n.jsx)("label",{htmlFor:t+"Fname",className:"",children:"Feature name: "}),Object(n.jsx)("input",{className:"form-control mb-2",name:"featureName",required:!0,id:t+"Fname",placeholder:"Enter feature name",value:e.featureName,onChange:function(e){return i(e,t)}})]}),Object(n.jsx)("div",{className:"col col-xs-1",children:1!==d.length&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-success mb-2",onClick:function(e){return l(e,t)},children:Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})})}),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:t+"fV1",className:"",children:"Feature value 1: "}),Object(n.jsx)("input",{className:"form-control mb-2",name:"featureValue1",required:!0,id:t+"fV1",placeholder:"Enter value",value:e.featureValue1,onChange:function(e){return i(e,t)}},t+"fV1")]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:t+"fV2",className:"",children:"Feature value 2: "}),Object(n.jsx)("input",{className:"form-control mb-2",name:"featureValue2",required:!0,id:t+"fV2",placeholder:"Enter value",value:e.featureValue2,onChange:function(e){return i(e,t)}},t+"fV2")]}),Object(n.jsx)("div",{children:d.length-1===t&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mb-2",onClick:function(e){return f(e)},children:"Add another feature"})})]},"topdiv"+t)})),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:"nrChoices",children:"Nr of questions in DCE"}),Object(n.jsx)("input",{type:"number",className:"col col-xs-1 form-control mb-2",id:"nrChoices",name:"nrQuestions",onChange:function(e){return o(e)}})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("input",{type:"checkbox",name:"grouped",id:"chkGrp",checked:b,onChange:m}),Object(n.jsx)("label",{htmlFor:"grouped",className:"",children:"Group by feature "})]},"chkbox"),Object(n.jsx)("div",{children:b&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("label",{className:"col-xs-6 col-form-label pb-0",id:"gr-label",htmlFor:"GrFeat",children:"Group feature"}),Object(n.jsx)(M.a,{className:"form form-select-sm col-xs-6 mb-2",id:"GrFeat",value:t.label,options:t,onChange:function(e){return j(e.value)}})]})}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){return O(e)},children:"Save DCE"})]},"form")},"i")),N(e)}),[d,h,p,b,s]),{dceHtml:g}};function Se(e){var t=e.showNewDceForm,c=e.dceList,s=e.setDceListChanged,r=e.setCurrentDce,i=Object(a.useState)([{featureName:null,featureValue1:null,featureValue2:null}]),l=Object(u.a)(i,2),d=l[0],j=l[1],b=Object(a.useState)(""),m=Object(u.a)(b,2),f=(m[0],m[1],Object(a.useState)([{dceDescr:""}])),O=Object(u.a)(f,2),p=(O[0],O[1],Object(a.useState)(!1)),x=Object(u.a)(p,2),v=x[0],g=x[1],N=Object(a.useState)(null),S=Object(u.a)(N,2),y=S[0],C=S[1],w=Object(a.useState)(0),D=Object(u.a)(w,2),L=D[0],k=D[1],I=Object(a.useState)({descr:""}),V=Object(u.a)(I,2),F=V[0],G=V[1],P=Object(a.useContext)(E).uid,R=function(e){return null==e.featureName||""===e.featureName?(alert("Please fill in all feature names"),!1):null!=e.featureValue1&&""!==e.featureValue1&&null!=e.featureValue2&&""!==e.featureValue2||(alert("Please fill in all feature values"),!1)},T=function(e){return F.name===e},J=Ne({handleEntry:function(e){e.preventDefault();var t=e.target,c=t.name,n=t.value;console.log(" tempdce newDce: "+JSON.stringify(F)),G((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(o.a)({},c,n))}))},handleDescrInputChange:function(e){e.preventDefault();var t=e.target,c=t.name,n=t.value,a=Object(h.a)({},F);console.log("tempDce: "+JSON.stringify(a)),a[c]=n,console.log("tempDce: "+JSON.stringify(a)),G((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(o.a)({},c,n))}))},handleInputChange:function(e,t){e.preventDefault();var c=e.target,n=c.name,a=c.value,s=Object(A.a)(d);s[t][n]=a,j(s)},handleRemoveClick:function(e,t){e.preventDefault();var c=Object(A.a)(d);c.splice(t,1),j(c)},handleNrQuestionsInput:function(e){e.preventDefault();var t,c=e.target.value;t=Number(c),k(t),G((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(o.a)({},"nrQuestions",t))}))},inputList:d},{setGroupValue:C,groupChecked:v,groupValue:y,handleCheckbox:function(){g(!v)}},{handleAddClick:function(e){e.preventDefault(),j([].concat(Object(A.a)(d),[{featureName:null,featureValue1:null,featureValue2:null}]))},saveDce:function(e){var n;(e.preventDefault(),d.every(R)&&function(){var e=F.name;return console.log("field not null check, dceName: "+e),""===e||c.list.length>0&&c.nameList().some(T)?(alert("Fill in a unique DCE name"),!1):!(F.nrQuestions<=0||!F.nrQuestions)||(alert("Fill in the number of questions (higher than 0) the participant has to answer in the DCE"),!1)}()&&(!v||null!==y||(alert("Please select a value for the group feature"),0)))&&(n=v?new ee(null,F.name,F.descr,F.nrQuestions,d,v,y,P):new $(null,F.name,F.descr,F.nrQuestions,d,v,P),c.list.length>0&&c.addDce(n).then((function(e){s(e),console.log("return dceId: "+e),r(n)})),t())},nrQuestions:L},F).dceHtml;return Object(n.jsx)("div",{children:J})}function ye(e){var t=e.dceList,c=Object(a.useState)(!1),s=Object(u.a)(c,2),r=s[0],i=s[1],l=Object(a.useState)(""),o=Object(u.a)(l,2),d=o[0],j=o[1],b=Object(a.useState)(null),h=Object(u.a)(b,2),m=(h[0],h[1],Object(a.useContext)(E).uid),f=Object(a.useState)({}),O=Object(u.a)(f,2),p=O[0],x=O[1],v=Object(a.useState)({}),g=Object(u.a)(v,2),N=g[0],S=g[1],y=Object(a.useState)({}),C=Object(u.a)(y,2),w=C[0],D=C[1],L=Object(a.useState)(!1),k=Object(u.a)(L,2),A=k[0],I=k[1];t.list=ge(m);var V=Object(a.useState)([]),F=Object(u.a)(V,2),G=F[0],P=F[1];console.log("dceList as prop: "+JSON.stringify(t.list)),Object(a.useEffect)((function(){var e=[];console.log("useEffect for list entered"),t.list.length>0&&t.list.map((function(c,a){e.push(Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":c.id,children:[" ",Object(n.jsx)("b",{children:c.name}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-warning mx-1",onClick:function(){x(c),S({dummy:c.id+N.id}),I(!0)},children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"edit"})}),Object(n.jsx)("hr",{className:"rulerSm"}),c.grouped&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",onClick:function(){x(c),D({dummy:c.id+w.id}),I(!1)},children:"settings"})}),Object(n.jsx)("hr",{className:"rulerSm"}),Object(n.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-1",onClick:function(){window.confirm("Are you sure you wish to delete this DCE?"),t.deleteDce(c),j(c.id)},children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"delete_forever"})})]})})},a))})),P(e)}),[t.list,d]);var R=function(){r?i(!1):r||i(!0)};return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"DCE list"})}),Object(n.jsx)("ul",{children:G})]}),Object(n.jsx)("div",{className:"row my-4",children:Object(n.jsxs)("div",{className:"col-auto  ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Create new DCE"})}),Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:R,children:" new DCE"})]}),t.list.length>0&&r&&Object(n.jsx)(Se,{showNewDceForm:R,dceList:t,setDceListChanged:j,setCurrentDce:x})]})})]}),A&&Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(de,{currentDce:p,dceId:p.id,currentSc:N,setCurrentSc:S})}),!A&&Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(ve,{currentDce:p,dceId:p.id,currentAsp:w,setCurrentDce:x,setCurrentAsp:D})})]})})}function Ce(e){var t=e.dceList,c=Object(a.useState)(null),s=Object(u.a)(c,2),r=(s[0],s[1],Object(a.useContext)(E).uid),i=Object(a.useState)({}),o=Object(u.a)(i,2),d=o[0],j=o[1];return t.list=ge(r),Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"DCE list"})}),Object(n.jsx)("ul",{children:t.list&&t.list.map((function(e,t){return Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(n.jsx)("b",{children:e.name}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)(l.b,{to:{pathname:"/app/"+r+"/"+e.id},children:Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"play_circle_outline"})})}),e.grouped&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",onClick:function(){j(e)},children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"poll"})})]})})},t)}))})]}),Object(n.jsx)("div",{className:"row my-4",children:Object(n.jsx)("div",{className:"col-auto  ",children:Object(n.jsx)("div",{})})})]}),Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(W,{currentDce:d,dceId:d.id,userId:r})})]})})}var we=function e(t){var c=this;Object(y.a)(this,e),this.uid=t.uid,this.list=[],this.nameList=function(){var e=[];return this.list.forEach((function(t){return e.push(t.name)})),e},this.deleteDce=function(e){var t=e.id,a=c.list.findIndex((function(e){return e.id===t}));c.list.splice(a,1),n("Scenarios"),p.collection("users").doc(c.uid).collection("DceList").doc(t.toString()).delete().then((function(){console.log("Document with ID"+t+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))},this.addDce=function(){var e=Object(m.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.list.push(t),t.id,t.scList,n=Object(je.a)(t,["id","scList"]),p.collection("users").doc(c.uid).collection("DceList").add(Object.assign({},n)).then((function(e){return console.log("Document written with ID: ",e.id),t.id=e.id,e.id})).catch((function(e){console.error("Error adding document: ",e)})),e.abrupt("return",t.name);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var n=function(e){var t=p.collection(e);t.onSnapshot((function(e){e.docs.forEach((function(e){t.doc(e.id).delete()}))}))}};var De=function(){var e=Object(a.useContext)(E),t=Object(a.useState)([]),c=Object(u.a)(t,2),s=c[0],r=c[1];return Object(a.useEffect)((function(){if(e){console.log("user must be there.. "+JSON.stringify(e));var t=new we(e);r(t)}}),[e]),e?Object(n.jsx)(d.c,{children:Object(n.jsxs)(l.a,{children:[Object(n.jsx)(d.a,{exact:!0,path:"/",children:Object(n.jsx)(ye,{dceList:s})}),Object(n.jsx)(d.a,{exact:!0,path:"/dcePlayList",children:Object(n.jsx)(Ce,{dceList:s})}),Object(n.jsx)(d.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(n.jsx)(te,{})}})]})}):Object(n.jsx)(d.c,{children:Object(n.jsxs)(l.a,{children:[Object(n.jsxs)(d.a,{exact:!0,path:"/signUp",children:[" ",Object(n.jsx)(ne,{})]}),Object(n.jsxs)(d.a,{exact:!0,path:"/",children:[" ",Object(n.jsx)(ce,{})]}),Object(n.jsxs)(d.a,{exact:!0,path:"/passwordReset",children:[" ",Object(n.jsx)(ae,{})," "]}),Object(n.jsx)(d.a,{exact:!0,path:"/dcePlayList",children:Object(n.jsx)(ce,{})}),Object(n.jsx)(d.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(n.jsx)(te,{})}})]})})};var Ee=function(){return Object(n.jsx)("div",{className:"App",children:Object(n.jsx)(l.a,{children:Object(n.jsxs)(L,{children:[Object(n.jsx)(k,{}),Object(n.jsx)(De,{})]})})})};i.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(Ee,{})}),document.getElementById("root"))},49:function(e,t,c){},64:function(e,t,c){},65:function(e,t,c){}},[[108,1,2]]]);
//# sourceMappingURL=main.29478d51.chunk.js.map