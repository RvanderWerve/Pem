(this.webpackJsonppem=this.webpackJsonppem||[]).push([[0],{108:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(1),s=c.n(a),r=c(33),i=c.n(r),l=(c(64),c(65),c(49),c(14)),o=c(16),u=c(13),d=c.n(u),j=c(7),b=c(20),h=c(36);c(109),c(110),c(68);h.a.initializeApp({apiKey:"AIzaSyDkuqUfQCo8w_7OWogV44gsGLzaE-yEvX4",authDomain:"pem-firestore.firebaseapp.com",projectId:"pem-firestore",storageBucket:"pem-firestore.appspot.com",messagingSenderId:"528017814946",appId:"1:528017814946:web:f8fab7864531498a146efb"});var m=h.a.storage(),f=h.a.firestore(),O=(h.a.firestore.FieldValue.serverTimestamp,h.a.firestore.FieldPath.documentId,h.a.auth()),x=new h.a.auth.GoogleAuthProvider,p=function(){O.signInWithPopup(x)},v=function(){var e=Object(b.a)(d.a.mark((function e(t,c){var n,a,s,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=f.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=16;break}return a=t.email,s=t.displayName,r=t.photoURL,e.prev=8,e.next=11,n.set(Object(j.a)({displayName:s,email:a,photoURL:r},c));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.error("Error creating user document",e.t0);case 16:return e.abrupt("return",g(t.uid));case 17:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t,c){return e.apply(this,arguments)}}(),g=function(){var e=Object(b.a)(d.a.mark((function e(t){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,f.doc("users/".concat(t)).get();case 5:return c=e.sent,e.abrupt("return",Object(j.a)({uid:t},c.data()));case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching user",e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),N=c(10),C=c(22),S=c(24),w=c(44),y=Object(a.createContext)({user:null}),E=function(e){Object(S.a)(c,e);var t=Object(w.a)(c);function c(){var e;Object(N.a)(this,c);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={user:null},e.componentDidMount=Object(b.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:O.onAuthStateChanged(function(){var t=Object(b.a)(d.a.mark((function t(c){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(c);case 2:n=t.sent,e.setState({user:n}),console.log("User logged in");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e}return Object(C.a)(c,[{key:"render",value:function(){var e=this.state.user;return Object(n.jsx)(y.Provider,{value:e,children:this.props.children})}}]),c}(a.Component);var D=Object(o.g)((function(e){var t=Object(a.useContext)(y);return Object(a.useEffect)((function(){t&&t.displayName}),[t]),Object(n.jsx)("div",{className:"navigation",children:Object(n.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-dark",children:Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)(l.b,{className:"navbar-brand",to:"/",children:Object(n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAW1SURBVGhD7ZpbaBxVGMe/mb0k2dy1uVWTJpV4KVJTL01D1baK4IMWwar1QcEqQlGDTxaxpQ++GX0q1JciCGKpFZpSEQxqQRtj0UqMF6RJ2wSJaZum2Wyz2WZv4/efPWd2Zndmd5oL3YX84LCzcz3/c77bHEYhsH+/2tbc/aym0W5SlI28p1zfX6hoWlgjZYBU5eDYrppe7rOmQERrc/eHfPht4j2pM4sFLalpykdjr9XuUdoOTT2nER0pPhESFqOoO1TdnIpWBFBUJZl8S9ViEfhEUQMNquIPFLZjuwAaVLFd9KwIKTRWhBQaSuuhq5wPiXwsyata0wmnTYol8St2OGB3rR2RePpGpV6FMq+YT2iOz/LyM3wZz0jwyVHuHzCE7HmojF66p0TfKYGIUFSj4ekE9Z6LUt9YlKIJcdDE3o0B2nm3X/yzB53c8kWIZmMa+blT3+6opltKrR1799QcnTgfFf+svPNgGb28ztq/YyNR2vfTnL5tmBZuXu5TLK2mRKGWSpUeb/HRgW3ldOzpKmqtMi4x8Huyr7VrBrwZsDm+qckrTrCCiXhijS/rfDxXkt0rwfR1ja5yM0/1uls99OmTlVTlt45kJrgmzrOZ2fLR2ejNMjdQH1B5AE29tsFRSM+ZCHUeDtL24yH6eyptT5ihNzpKxT973v95jjYfmbG0bUdDFDb5iB0t3NlGmxy9fpVH95FcOB5mP9dH8S8W8ebJWd1fJE+t9evT7USI/eDyXNLSJiNJ/Z65QNDYUJ898o/c5hNbzuTRmWJ0JknnZ9KzsppHrb0m91TfCBPh9Ch1NVk7jZnY2pzaB5Od4gGxw5UQDOS5oDVctdcunZC+sZjhi5tX+yx+Ul+mUiP7CBifTdLZ6UUIAZG42BDkc/gbIcymiLAMmtkHG0x+8kCD1/CP0xfjVMmR1A7XQjLxLJ0O3Td+n0yNFDp9X116trfenja1X1hIBYddOxYsxByWF0sFz+6P4+kp3yKc28O96xS5Bc8buhKnMvtU414IRs3MXI5QCrND7JetNiODZxLgcmXwclz3RXA/mxNo4mubhJkF5zW6wAEns0yRuBbSIBxOcolDqhN7OwPU/0K10T5+rEIcsQd11zAHk3kxOKgeIG59ndcI879BKB9GBWKHKyEoBcxRCjllaNKm6BLAf2DrssFEclHKt8aIDwdTg1PCN7iTn3eX6ZmD7EOKopA3vcuCKyEdPDK1pmgxxDeVUcYOJFIUl7KZk6kd0mxPjcdSG8y9nM3bqlMH8KR+9iGs9XgdFnxyCsG04oY9j5ZbFoyODttXqBJUpB2fBY32yjez4og98hUAoy5ZW+3RZwVc4wr8LFfgOMuponAU0r2hlAZ2VtPx7VV6fSWBrX45PC/+2RPlEIN3D9lQwudChnLcWxaX7TWqLgaMsP/gPgsSgmiBiGO+EOFv93dhfqERO5YIOduouEdDKd/r4gwvTU5GNAer0nEUgkGEbcMX/riSoPf65+j5r67pBeBSIzuIZw6KIGJOuD+IHJNDh7OQnl8j9DCX312HZ/RS/vN/5tlExMElxtzB0xNphwcwKViCzkJmZIbDIUY/V3RaDlBPmct9VMboSz4chdws0PGLJvM9cynuqhwqOCGIWn+a3kgHJtIhORfLIqSKK9S6suwmy/F89I7M08l/Y/Q9N5iaG5ZFyL5NARp4sSar3SHyQj6+vhCjXX2z9Cq3//hlyg3LIgS5B+Ezs+XKA4vFEAKHQqKTTTOK6vxkXuvUzNEIq4TmY67IeI45CFiWTM21PsoMN2tRAKW1myXT66Yl0TLTkikSYb4yBuB8XCeJ88jIlU9DSLGzLD5yM1gRUmisCCk0VA7uYbFdvLAGVf/KpsiBBrzLHuRNt7m18NC0hJJMHFDxvRM+FSpKMSyC0/0Ho6+vOpHK96xkzSfBZ/CVDVd2RfPhGWYCIkhRtP8BHVdn5YjM5rcAAAAASUVORK5CYII=",width:"35px",height:"30px",alt:"PEM logo"})}),Object(n.jsx)("div",{children:Object(n.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(n.jsx)("li",{className:"nav-item  ".concat("/"===e.location.pathname?"active":""),children:Object(n.jsx)(l.b,{className:"nav-link",to:"/",children:"Develop"})},"0"),Object(n.jsx)("li",{className:"nav-item  ".concat("/dcePlayList"===e.location.pathname?"active":""),children:Object(n.jsx)(l.b,{className:"nav-link",to:"/dcePlayList",children:"Run/Results"})},"1"),t?Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsxs)(l.b,{to:"/",className:"nav-link",onClick:function(){O.signOut()},children:["Sign out (",t.displayName,")"]})},"2"):Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(l.b,{to:"/",className:"nav-link",children:"Sign in"})},"2")]})})]})})})})),L=c(4),k=c(8),A=function(){return Object(n.jsx)("div",{className:"outtro",children:Object(n.jsx)("div",{className:"fixed-action-btn",children:Object(n.jsx)("a",{href:"#modal1",className:" modal-trigger btn-floating red darken-2",children:Object(n.jsx)("i",{className:"material-icons mat-icon",style:{fontSize:"140%"},children:"help_outline"})})})})},F=c(132),I=c(131),V=c(133),G=c(54),P=c.n(G),R=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=e.value,i=e.shownSc,l=e.ageGender,o=Object(a.useState)({}),u=Object(L.a)(o,2),d=u[0],b=u[1];return Object(a.useEffect)((function(){if(c&&s){var e=c.fValues,t=s.fValues,n=null;"A"===r&&(n={pref:Object(j.a)(Object(j.a)({},e),l),nonPref:Object(j.a)(Object(j.a)({},t),l)}),"B"===r&&(n={pref:Object(j.a)(Object(j.a)({},t),l),nonPref:Object(j.a)(Object(j.a)({},e),l)}),b(n)}}),[c,s,l,r]),Object(n.jsxs)("div",{className:"swiper-slide choose-btn",children:[Object(n.jsx)("div",{className:"s10 ",children:i&&Object(n.jsxs)("div",{className:"choice-container",children:[Object(n.jsx)("p",{children:i.scText}),Object(n.jsx)("img",{className:"swipe-img choice-container",src:i.scImg,alt:""})]})}),i&&Object(n.jsx)("button",{value:r,onClick:function(){t(d)},className:"btn blue darken-2 waves-effect waves-light z-depth-2",children:"Choose"})]})},T=function(e){var t=e.handleClick,c=e.sc1,s=e.sc2,r=e.dceDescr,i=e.ageGender,l=Object(a.useState)(0),o=Object(L.a)(l,2),u=o[0],d=o[1],j=Object(a.useState)(0),b=Object(L.a)(j,2),h=b[0],m=b[1],f={tabs:{background:"#fff"},label:{fontSize:"100%"}};return Object(n.jsxs)("div",{className:"swiper-container",children:[Object(n.jsx)(V.a,{position:"static",color:"default",children:Object(n.jsxs)(F.a,{indicatorColor:"primary",textColor:"primary",background:"primary",variant:"fullWidth",value:h,onChange:function(e,t){m(t),d(t)},style:f.tabs,children:[Object(n.jsx)(I.a,{style:f.label,label:"option n\xb01"}),Object(n.jsx)(I.a,{style:f.label,label:"option n\xb02"})]})}),Object(n.jsx)("h5",{className:"text-secondary mt-1 mb-0 text-center",children:r}),Object(n.jsxs)(P.a,{enableMouseEvents:!0,index:u,onChangeIndex:function(e){d(e),m(e)},children:[Object(n.jsx)("div",{className:"slide",children:Object(n.jsx)("div",{className:"innerslide",children:Object(n.jsx)(R,{handleClick:t,sc1:c,sc2:s,value:"A",shownSc:c,ageGender:i})})}),Object(n.jsx)("div",{className:"slide",children:Object(n.jsx)("div",{className:"innerslide",children:Object(n.jsx)(R,{handleClick:t,sc1:c,sc2:s,value:"B",shownSc:s,ageGender:i})})})]})]})},B=function(e){var t=e.sc1,c=e.sc2;return Object(n.jsx)("div",{children:Object(n.jsx)("div",{id:"modal1","data-id":"modal1",className:"modal",children:Object(n.jsx)("div",{className:"modal-content black-text modal-close center",children:Object(n.jsxs)("div",{className:"flow-text",children:[Object(n.jsx)("h4",{className:"mb-3",children:"Additional explanation:"}),Object(n.jsx)("h6",{children:Object(n.jsx)("u",{children:"Scenario 1:"})}),t&&Object(n.jsx)("p",{className:"flow-text",children:t.scExpl}),t&&0===t.scExpl.length&&Object(n.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(n.jsx)("h6",{children:Object(n.jsx)("u",{children:"Scenario 2:"})}),c&&Object(n.jsx)("p",{className:"flow-text",children:c.scExpl}),c&&0===c.scExpl.length&&Object(n.jsx)("h5",{className:"",children:"No additional explanation available"}),Object(n.jsx)("button",{className:"btn btn-sm blue darken-2 waves-effect waves-light z-depth-2",children:"Close"})]})})})})},Q=c(55),U=c.n(Q),K=function(e){var t=e.handleClick,c=e.sc1,a=e.sc2,s=e.dceDescr,r=e.ageGender;return Object(n.jsxs)("div",{className:"pc-view",children:[Object(n.jsx)("h5",{className:"text-secondary mt-1 mb-1",children:s}),Object(n.jsxs)("div",{className:"pc-container",children:[Object(n.jsx)("div",{className:"option-container",children:Object(n.jsx)(R,{handleClick:t,sc1:c,sc2:a,value:"A",shownSc:c,ageGender:r})}),Object(n.jsx)("div",{className:"option-container",children:Object(n.jsx)(R,{handleClick:t,sc2:a,sc1:c,value:"B",shownSc:a,ageGender:r})})]})]})},M=c(26),H=function(e){var t=e.nrQuestions,c=e.setStarted,a=e.setQNr,s=e.handleAGChoice;return Object(n.jsx)("div",{className:"my-5",children:Object(n.jsxs)("div",{className:"col resultsContainer mx-3",children:[Object(n.jsxs)("h5",{children:["Thank you for particpating in this experiment. You will be asked ",t," questions about your preference. Your privacy is ensured."]}),Object(n.jsx)("h5",{className:"text-secondary mb-5",children:"Please select your gender and age (or leave blank) and then start by clicking the button below. "}),Object(n.jsxs)("div",{className:"col-md-6   mx-auto",children:[" ",Object(n.jsx)("label",{htmlFor:"gender",className:"col-form-label",children:"Gender"}),Object(n.jsx)(M.a,{className:"mb-2",options:[{label:"female",value:"female"},{label:"male",value:"male"}],id:"gender",name:"gender",onChange:function(e,t){return s(e.value,t.name)}})]}),Object(n.jsxs)("div",{className:"col-md-6   mx-auto",children:[" ",Object(n.jsx)("label",{htmlFor:"age",className:"col-form-label",children:"Age"}),Object(n.jsx)(M.a,{className:"mb-4",options:[{label:"younger than 25 years",value:"younger than 25 years"},{label:"25 years or older",value:"25 years or older"}],id:"age",name:"age",onChange:function(e,t){return s(e.value,t.name)}})]}),Object(n.jsx)("button",{className:"btn blue darken-2 ",onClick:function(){c(!0),a(0)},children:"Start"})]})})},Y=function(e,t){var c=Object(a.useState)([]),n=Object(L.a)(c,2),s=n[0],r=n[1];return Object(a.useEffect)((function(){if(e&&t){var c=f.collection("users").doc(e).collection("DceList").doc(t).collection("Scenarios").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(j.a)({},e.data()))})),r(t)}));return function(){return c()}}}),[e,t]),{scenarios:s}};function z(e,t,c){var n=Object(a.useState)([]),s=Object(L.a)(n,2),r=s[0],i=s[1],l=c.features;return Object(a.useEffect)((function(){if(e&&t&&c){var n=[];return i(n),void f.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").orderBy("aspectName").get().then((function(a){a.forEach((function(a){n.push({aspectName:a.data().aspectName,aspectDescr:a.data().aspectDescr,id:a.id}),f.collection("users").doc(e).collection("DceList").doc(t).collection("AspectList").doc(a.id).collection("Combis").get().then((function(e){var t=[];e.forEach((function(e){var n=e.data(),s=[],r=[];s.push.apply(s,Object(k.a)(n.filterList)),r.push.apply(r,Object(k.a)(n.filterList));var i={fName:c.groupFeature,fValue:e.data().groupValue};if(a.data().ageGender){if(""!==a.data().ageGender.age){var o={fName:"age",fValue:a.data().ageGender.age};s.push(o),r.push(o)}if(""!==a.data().ageGender.gender){var u={fName:"gender",fValue:a.data().ageGender.gender};s.push(u),r.push(u)}}s.push(i);var d="";l.forEach((function(t,n){t.featureName===c.groupFeature&&(t.featureValue1===e.data().groupValue&&(d=t.featureValue2),t.featureValue2===e.data().groupValue&&(d=t.featureValue1))}));var j={fName:c.groupFeature,fValue:d};r.push(j),n.favorFilters=s,n.againstFilters=r,t.push(n)}));var s=[].concat(n);s[n.findIndex((function(e){return e.id===a.id}))].combis=t,i(s)}))}))})).catch((function(e){console.log("Error with loading document"+e)}))}}),[e,t,c]),{aspectObjs:r}}function Z(e,t){var c=Object(a.useState)([]),s=Object(L.a)(c,2),r=s[0],i=s[1];Object(a.useEffect)((function(){var c=[];c.push(Object(n.jsx)("div",{children:Object(n.jsx)("div",{className:"mb-3",children:" \u0394 P shows the difference in probability that the aspect is true and the probability that the aspect is not true"},"headtext")},"head")),e.forEach((function(e,a){var s=e.aspectDescr,r=[],u=[];e.combis&&e.combis.forEach((function(e){t.filter((function(t){var c=!0;return e.favorFilters.forEach((function(e){e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){-1===r.indexOf(e)&&r.push(e)}));t.filter((function(t){var c=!0;return e.againstFilters.forEach((function(e){e.fValue===t[e.fName]&&t.hasOwnProperty(e.fName)||(c=!1)})),c})).forEach((function(e){-1===u.indexOf(e)&&u.push(e)}))}));var d=0;(u.length>0||r.length>0)&&(d=r.length/(r.length+u.length)*2-1);var j=Math.abs(50*d),b=l(d),h=o(d);c.push(Object(n.jsxs)("div",{className:"pb-2",children:[Object(n.jsx)("span",{className:"text-secondary",children:s},"asp-desc ".concat(a)),Object(n.jsx)("br",{}),Object(n.jsxs)("div",{className:b,children:[Object(n.jsx)("div",{className:"progress-bar bg-light-grey",role:"progressbar",style:{width:"50%"},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"},"pg-bar-pt1 ".concat(a)),0===d&&Object(n.jsx)("div",{className:"progress-bar bg-teal",role:"progressbar",style:{width:"2px"},"aria-valuenow":"30","aria-valuemin":"0","aria-valuemax":"100"},"pg-bar-pt2 ".concat(a)),Object(n.jsx)("div",{className:h,role:"progressbar","aria-valuenow":d,"aria-valuemin":"0","aria-valuemax":"100",style:{width:j+"%"},children:(d>=.4||d<=-.4)&&Object(n.jsxs)("span",{className:"sr-only",children:["\u0394 P = ",d.toFixed(2)]},"pg-title ".concat(a))},"pg-bar-pt3 ".concat(a))]},"clNames ".concat(a)),d<.4&&d>-.4&&Object(n.jsxs)("div",{children:["\u0394 P = ",d.toFixed(2)]},"pg-desc ".concat(a)),Object(n.jsxs)("span",{children:["(Chosen ",(100*d).toFixed(0),"% ",d<0?"less":"more"," than the opposite.)"]},"pg-desc2 ".concat(a))]},"graphs ".concat(a))),i(c)})),0===e.length&&i([Object(n.jsx)("div",{children:Object(n.jsx)("h5",{children:"No aspects defined."})})])}),[e,t]);var l=function(e){var t="progress w-80 mx-auto";return e<0&&(t="progress w-80 mx-auto flex-row-reverse"),t},o=function(e){var t="progress-bar bg-teal progress-bar-striped";return e<0&&(t="progress-bar bg-purple progress-bar-striped"),t};return{resultHtml:r}}var q=function(e,t){var c=Object(a.useState)([]),n=Object(L.a)(c,2),s=n[0],r=n[1];return Object(a.useEffect)((function(){if(e&&t){var c=f.collection("users").doc(e).collection("DceList").doc(t).collection("RawResults").onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(j.a)(Object(j.a)({},e.data().pref),{},{id:e.id}))})),r(t)}));return function(){return c()}}}),[e,t]),{results:s}};function J(e){var t=e.currentDce,c=e.dceId,a=e.userId,s=q(a,c).results,r=Z(z(a,c,t).aspectObjs,s).resultHtml,i=Math.ceil(s.length/t.nrQuestions);return Object(n.jsxs)("div",{children:[!t.id&&Object(n.jsxs)("div",{children:[Object(n.jsxs)("h3",{children:["Click on ",Object(n.jsx)("i",{className:"material-icons mt-1  btn-outline-danger",children:"poll"})," in the dce list for results."]})," ",Object(n.jsx)("h5",{children:"(only available for grouped dce's)"})]}),t.id&&Object(n.jsxs)("div",{className:"mb-5",children:[Object(n.jsx)("h3",{children:"Total results from all participants: "}),Object(n.jsx)("div",{children:Object(n.jsxs)("h6",{children:["Number of participants: ",i]})}),r]},"title")]},"main")}function W(e){var t=e.resultList,c=e.currentDce,a=e.dceId,s=e.userId,r=Z(z(s,a,c).aspectObjs,t).resultHtml;return Object(n.jsxs)("div",{className:"my-5",children:[Object(n.jsx)("p",{children:"Thank you for completing this experiment!"}),c.grouped&&Object(n.jsxs)("div",{className:"col resultsContainer mx-3",children:[Object(n.jsx)("div",{children:" For SurveyCircle users (www.surveycircle.com): The Survey Code is: K9ET-Q8Y9-197K-TB19"}),Object(n.jsxs)("div",{className:"mb-5",children:[Object(n.jsx)("h3",{children:"Your results: "}),r]})]}),c.grouped&&Object(n.jsx)("div",{className:"col resultsContainer mx-3",children:Object(n.jsx)(J,{currentDce:c,dceId:a,userId:s})})]})}var X=function(e,t){for(var c=[],n=[],a=0;a<t;a++){for(var s=-1,r=5*e;r>0;r--){var i=Math.floor(Math.random()*e);if(!c.includes(i)){s=i;break}}-1!==s&&c.push(s),n.push(s)}return n};var _=function e(t,c,n,a,s,r){Object(N.a)(this,e),this.id=t,this.name=c,this.descr=n,this.nrQuestions=a,this.features=s,this.grouped=r,this.scList=[],this.aspectList=[]},$=function(e){Object(S.a)(c,e);var t=Object(w.a)(c);function c(e,n,a,s,r,i,l){var o;return Object(N.a)(this,c),(o=t.call(this,e,n,a,s,r,i)).groupFeature=l,o}return c}(_);var ee=function(){var e=Object(a.useState)([]),t=Object(L.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)([]),i=Object(L.a)(r,2),l=i[0],u=i[1],d=Object(a.useState)({age:"",gender:""}),j=Object(L.a)(d,2),b=j[0],h=j[1],m=Object(a.useState)([]),O=Object(L.a)(m,2),x=O[0],p=O[1],v=Object(a.useState)([]),g=Object(L.a)(v,2),N=g[0],C=g[1],S=Object(a.useState)(null),w=Object(L.a)(S,2),y=w[0],E=w[1],D=Object(a.useState)(null),F=Object(L.a)(D,2),I=F[0],V=F[1],G=Object(a.useState)(null),P=Object(L.a)(G,2),R=P[0],Q=P[1],M=Object(a.useState)(null),z=Object(L.a)(M,2),Z=z[0],q=z[1],J=Object(a.useState)(0),ee=Object(L.a)(J,2),te=ee[0],ce=ee[1],ne=Object(a.useState)(null),ae=Object(L.a)(ne,2),se=ae[0],re=ae[1],ie=Object(a.useState)(null),le=Object(L.a)(ie,2),oe=le[0],ue=le[1],de=Object(a.useState)([]),je=Object(L.a)(de,2),be=je[0],he=je[1],me=Object(a.useState)(null),fe=Object(L.a)(me,2),Oe=fe[0],xe=fe[1],pe=Object(a.useState)(""),ve=Object(L.a)(pe,2),ge=ve[0],Ne=ve[1],Ce=Object(a.useState)(!1),Se=Object(L.a)(Ce,2),we=Se[0],ye=Se[1],Ee=Object(a.useState)(!1),De=Object(L.a)(Ee,2),Le=De[0],ke=De[1],Ae=Object(a.useState)(""),Fe=Object(L.a)(Ae,2),Ie=Fe[0],Ve=Fe[1],Ge=Object(o.f)(),Pe=Ge.userId,Re=Ge.dceId,Te=Y(Pe,Re).scenarios,Be=function(e,t,c){var n=Object(a.useState)(null),s=Object(L.a)(n,2),r=s[0],i=s[1],l=Object(a.useState)(null),o=Object(L.a)(l,2),u=o[0],d=o[1];return Object(a.useEffect)((function(){if(e&&t&&null!==c&&e.length>0){var n=e.length,a=X(n,t),s=[];a.forEach((function(t){s.push(e[t])}));var r=[];c&&s.forEach((function(t){r.push(e.find((function(e){return e.id===t.altnr})))})),c||X(n,t).forEach((function(t){r.push(e[t])})),i(s),d(r)}}),[e,t,c]),{scenarioListA:r,scenarioListB:u}}(Te,te,se),Qe=Be.scenarioListA,Ue=Be.scenarioListB;Object(a.useEffect)((function(){U.a.AutoInit()})),Object(a.useEffect)((function(){Ue&&Qe&&(E(Qe[R]),V(Ue[R]))}),[Qe,Ue,R]);var Ke=function(e){if(e){var t=Object(k.a)(c);t.push(e),s(t)}R+2>te&&ye(!0),Q((function(e){return e+1})),function(e,t,c,a,s){var r=[];(r=Object(k.a)(e)).push(Object(n.jsx)("span",{className:"dot blue darken-2"},"filleddot".concat(s))),t(r);var i=[];(i=Object(k.a)(c)).pop(),a(i)}(x,p,N,C,R)};return Object(a.useEffect)((function(){if(Te&&Pe&&Re){Ve(""),s([]);var e=Te.map((function(e){return e.fValues})).map((function(e){return Object.values(e)[0]})).includes("");if(e)return void Ve("All scenario's must have data entered and saved - please contact the researcher.");e||f.collection("users").doc(Pe).collection("DceList").doc(Re).get().then((function(e){if(e.data().grouped&&Te.length<2*e.data().nrQuestions||!e.data().grouped&&(Te.length<e.data().nrQuestions||Te.length<2))Ve("The scenario's are incomplete - please contact the researcher.");else{Ve("");var t,c=e.data().grouped;t=e.data().grouped?new $(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped,e.data().groupFeature):new _(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped),q(t),he(e.data().features);var a={details:{grouped:e.data().grouped,groupFeature:e.data().groupFeature,nrQuestions:e.data().nrQuestions}};xe(a),ue(e.data().descr),Ne(e.data().name),ce(e.data().nrQuestions),re(c),C(function(e){for(var t=[],c=0;c<e;c++)t.push(Object(n.jsx)("span",{className:"dot"},"emptydot".concat(c)));return t}(e.data().nrQuestions))}})).catch((function(e){console.error("Error loading document: ",e)}))}}),[Te,Pe,Re]),function(e,t,c,n,s){var r=Object(a.useRef)(!0);Object(a.useEffect)((function(){if(r.current)r.current=!1;else{var e=f.collection("users").doc(c).collection("DceList").doc(n).collection("RawResults"),a=[];t.forEach((function(t,c){a.push(t.pref,c),e.add(t).then((function(e){console.log("answer added to results collection with id: "+e.id)})).catch((function(e){console.error("Error adding document: ",e)}))})),s(a)}}),[e])}(we,c,Pe,Re,u),Object(n.jsxs)("div",{children:[Object(n.jsx)(B,{sc1:y,sc2:I}),!we&&!Le&&Object(n.jsx)(H,{nrQuestions:te,setStarted:ke,setQNr:Q,handleAGChoice:function(e,t){var c=b;c[t]=e,h(c)}}),!we&&Le&&!Ie&&Object(n.jsx)(T,{handleClick:Ke,sc1:y,sc2:I,dceDescr:oe,ageGender:b}),!we&&Le&&!Ie&&y&&I&&Object(n.jsx)(K,{handleClick:Ke,sc1:y,sc2:I,dceDescr:oe,ageGender:b}),!we&&Le&&!Ie&&Object(n.jsx)(A,{}),!we&&Le&&!Ie&&Object(n.jsxs)("div",{className:"footer",children:[x,N]}),we&&Le&&!Ie&&Pe&&Re&&Object(n.jsx)(W,{resultList:l,currentDce:Z,dceDetails:Oe,dceNameEdit:ge,dceId:Re,dceFeatures:be,userId:Pe}),Ie&&Object(n.jsx)("div",{className:"text-danger mt-5",children:Object(n.jsxs)("h4",{children:["Error: ",Ie]})})]})},te=function(){var e=Object(a.useState)(""),t=Object(L.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)(""),i=Object(L.a)(r,2),o=i[0],u=i[1],d=Object(a.useState)(null),j=Object(L.a)(d,2),b=j[0],h=j[1],m=function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c?s(n):"userPassword"===c&&u(n)};return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign In"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[null!==b&&Object(n.jsx)("div",{className:"text-danger mb-3",children:b}),Object(n.jsxs)("form",{className:"",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your email",id:"userEmail",onChange:function(e){return m(e)}}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsxs)("div",{className:"form-floating ",children:[Object(n.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return m(e)}}),Object(n.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){!function(e,t,c){e.preventDefault(),O.signInWithEmailAndPassword(t,c).catch((function(e){h("Error signing in with password and email!"),console.error("Error signing in with password and email",e)}))}(e,c,o)},children:"Sign in"})]}),Object(n.jsx)("p",{className:"my-3",children:"or"}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){p()},children:"Sign in with Google"}),Object(n.jsxs)("p",{className:"my-3",children:["Don't have an account?"," ",Object(n.jsx)(l.b,{to:"/signUp",className:"text-blue-500 hover:text-blue-600",children:"Sign up here"})," ",Object(n.jsx)("br",{})," ",Object(n.jsx)(l.b,{to:"passwordReset",className:"text-blue-500 hover:text-blue-600",children:"Forgot Password?"})]})]})]})},ce=function(){var e=Object(a.useState)(""),t=Object(L.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)(""),i=Object(L.a)(r,2),o=i[0],u=i[1],j=Object(a.useState)(""),h=Object(L.a)(j,2),m=h[0],f=h[1],x=Object(a.useState)(null),g=Object(L.a)(x,2),N=g[0],C=g[1],S=function(){var e=Object(b.a)(d.a.mark((function e(t,c,n){var a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.createUserWithEmailAndPassword(c,n);case 4:a=e.sent,r=a.user,v(r,{displayName:m}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),C("Error Signing up with email and password");case 12:s(""),u(""),f("");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,c,n){return e.apply(this,arguments)}}(),w=function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c?s(n):"userPassword"===c?u(n):"displayName"===c&&f(n)};return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-3xl mb-2 text-center font-bold",children:"Sign Up"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[null!==N&&Object(n.jsx)("div",{className:"text-danger mb-3",children:N}),Object(n.jsxs)("form",{className:"",children:[Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"text",className:"form-control ",name:"displayName",value:m,placeholder:"Display name",id:"displayName",onChange:function(e){return w(e)}}),Object(n.jsx)("label",{htmlFor:"displayName",className:"block",children:"Display Name:"})]}),Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"email",className:"form-control",name:"userEmail",value:c,placeholder:"Your Email",id:"userEmail",onChange:function(e){return w(e)}}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsxs)("div",{className:"form-floating",children:[Object(n.jsx)("input",{type:"password",className:"form-control",name:"userPassword",value:o,placeholder:"Your Password",id:"userPassword",onChange:function(e){return w(e)}}),Object(n.jsx)("label",{htmlFor:"userPassword",className:"block",children:"Password:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(e){S(e,c,o)},children:"Sign up"})]}),Object(n.jsx)("p",{className:"my-3",children:"or"}),Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){try{p()}catch(N){console.error("Error signing in with Google",N)}},children:"Sign In with Google"}),Object(n.jsxs)("p",{className:"my-3",children:["Already have an account?"," ",Object(n.jsx)(l.b,{to:"/",className:"text-blue-500 hover:text-blue-600",children:"Sign in here"})," "]})]})]})},ne=function(){var e=Object(a.useState)(""),t=Object(L.a)(e,2),c=t[0],s=t[1],r=Object(a.useState)(!1),i=Object(L.a)(r,2),o=i[0],u=i[1],d=Object(a.useState)(null),j=Object(L.a)(d,2),b=j[0],h=j[1];return Object(n.jsxs)("div",{className:"row justify-content-center",children:[Object(n.jsx)("h1",{className:"text-xl text-center font-bold mb-3",children:"Reset your Password"}),Object(n.jsxs)("div",{className:"col-sm-7",children:[Object(n.jsxs)("form",{action:"",children:[o&&Object(n.jsx)("div",{className:"text-danger mb-3",children:"An email has been sent to you!"}),null!==b&&Object(n.jsx)("div",{className:"text-danger mb-3",children:b}),Object(n.jsxs)("div",{class:"form-floating",children:[Object(n.jsx)("input",{type:"email",name:"userEmail",id:"userEmail",value:c,placeholder:"Input your email",onChange:function(e){var t=e.currentTarget,c=t.name,n=t.value;"userEmail"===c&&s(n)},className:"form-control"}),Object(n.jsx)("label",{htmlFor:"userEmail",className:"block",children:"Email:"})]}),Object(n.jsx)("button",{className:"btn btn-outline-info my-3",onClick:function(e){!function(e){e.preventDefault(),O.sendPasswordResetEmail(c).then((function(){u(!0),setTimeout((function(){u(!1)}),3e3)})).catch((function(){h("Error resetting password")}))}(e)},children:"Send me a reset link"})]}),Object(n.jsx)(l.b,{to:"/",className:"my-2 text-blue-700 hover:text-blue-800 text-center block",children:"\u2190 back to sign in page"})]})]})},ae=function(e){var t=Object(a.useState)(0),c=Object(L.a)(t,2),n=c[0],s=c[1],r=Object(a.useState)(null),i=Object(L.a)(r,2),l=i[0],o=i[1],u=Object(a.useState)(null),j=Object(L.a)(u,2),h=j[0],f=j[1];return Object(a.useEffect)((function(){var t=m.ref(e.name);t.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;s(t)}),(function(e){o(e)}),Object(b.a)(d.a.mark((function e(){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:c=e.sent,f(c);case 4:case"end":return e.stop()}}),e)}))))}),[e]),{progress:n,url:h,error:l}},se=function(e){var t=e.file,c=e.setFile,s=e.dceId,r=e.scNr,i=e.setUrl,l=ae(t,s,r),o=l.progress,u=l.url,d=Object(a.useCallback)((function(e){i(e)}),[i]);return Object(a.useEffect)((function(){u&&(c(null),d(u))}),[u,c,d]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{children:"uploading..."}),Object(n.jsx)("div",{className:"upload-progress-bar",style:{width:o+"%"}})]})},re=function(e){var t=e.dceId,c=e.scNr,s=e.setUrl,r=Object(a.useState)(null),i=Object(L.a)(r,2),l=i[0],o=i[1],u=Object(a.useState)(null),d=Object(L.a)(u,2),j=d[0],b=d[1],h=["image/png","image/jpeg"];return Object(n.jsxs)("div",{children:[Object(n.jsxs)("label",{children:[Object(n.jsx)("input",{type:"file",style:{height:0,width:0},onChange:function(e){var t=e.target.files[0];t&&h.includes(t.type)?(o(t),b("")):(o(null),b("Please select an image file (png or jpg)"))}}),Object(n.jsx)("span",{className:"btn btn-sm btn-outline-info mb-3",children:"Upload image"})]}),Object(n.jsxs)("div",{className:"output",children:[j&&Object(n.jsx)("div",{className:"error",children:j}),l&&Object(n.jsx)("div",{children:l.name}),l&&Object(n.jsx)(se,{file:l,setFile:o,dceId:t,scNr:c,setUrl:s})]})]})},ie=function(e,t,c,s,r,i,l,o,u,d){var b=c.id,h=Object(a.useState)([]),m=Object(L.a)(h,2),f=m[0],O=m[1],x=function(e){var t=Object(j.a)({},c);t.scImg=e,s(t),r(!1)};return Object(a.useEffect)((function(){if(Object.keys(c).length>0){var a=[];return a.push(Object(n.jsx)("div",{children:c.id&&Object(n.jsxs)("div",{children:[e&&e.grouped&&Object(n.jsxs)("h5",{children:["Paired with scenario nr: ",c.altnr]}),Object(n.jsxs)("div",{className:"form-row",children:[Object(n.jsx)("h6",{children:"Features"}),Object(n.jsx)("div",{className:"row",children:c.fValues&&e.features&&e.features.map((function(e,t){var a=[{label:e.featureValue1,value:e.featureValue1},{label:e.featureValue2,value:e.featureValue2}];return Object(n.jsxs)("div",{className:"col-md-4  mb-3",children:[" ",Object(n.jsx)("label",{htmlFor:t,className:"col-form-label",children:e.featureName}),Object(n.jsx)(M.a,{options:a,placeholder:c.fValues[e.featureName]||"Select..",defaultValue:c.fValues[e.featureName],isDisabled:c.altSc,onChange:function(t){return l(t.value,e.featureName)},id:t},c.id+t)]},t)}))})]},"form-row"),Object(n.jsxs)("form",{id:"textForm",children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("h6",{children:"Scenario text"}),Object(n.jsx)("textarea",{className:"form-control form-control-sm mb-3",name:"scText",value:c.scText,placeholder:"Enter scenario text",id:"scText",onChange:function(e){return d(e)}})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h6",{children:"Scenario explanation"}),Object(n.jsx)("textarea",{className:"form-control form-control-sm mb-3",type:"text",name:"scExpl",value:c.scExpl,placeholder:"Enter additional explanatory text",id:"scExpl",onChange:function(e){return d(e)}})]}),Object(n.jsx)("h6",{children:"Scenario image link"}),Object(n.jsx)(re,{dceId:t,scNr:b,setUrl:x}),c.scImg&&Object(n.jsx)("img",{src:c.scImg,className:"scImage",alt:"scenario"}),e&&e.grouped&&!c.altnr&&Object(n.jsx)("input",{className:"btn  btn-outline-success my-3",type:"button",onClick:function(e){return u(e)},value:"Save & Create pair"}),(c.altnr||!e.grouped)&&Object(n.jsx)("input",{type:"button",className:"btn  btn-outline-success my-3",onClick:function(e){return o(e)},value:"Save"})]}),i&&Object(n.jsx)("div",{children:"Scenario has been saved"})]})},"scDtls ".concat(c.id))),void O(a)}}),[e,c,i]),{scenarioHtml:f}};function le(e){var t=e.currentDce,c=e.dceId,s=e.currentSc,r=e.setCurrentSc,i=e.handleAddScenario,l=e.setIsSaved,o=e.isSaved,u=Object(a.useContext)(y).uid,h=function(e){var c,n=t.groupFeature,a=e[n];t.features.forEach((function(e){e.featureName===n&&(e.featureValue1===a&&(c=e.featureValue2),e.featureValue2===a&&(c=e.featureValue1))}));var s=Object(j.a)({},e);return s[n]=c,s},m=function(){var e,c=!1;return 0!==s.scText.length||0!==s.scImg.length?c=!0:alert("Fill in the Scenario Text or upload a Scenario Image, or do both"),e=!t.features.some((function(e){return 0===s.fValues[e.featureName].length&&alert("Select a value for every feature in the scenario"),0===s.fValues[e.featureName].length})),c&&e},O=function(){var e=Object(b.a)(d.a.mark((function e(n){var a,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),m()&&(x(s),a=s.altnr,r=h(s.fValues),a&&(i=t.scList.findIndex((function(e){return e.id===a})),t.scList[i].fValues=r,f.collection("users").doc(u).collection("DceList").doc(c).collection("Scenarios").doc(a.toString()).update({fValues:r})),l(!0));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(e){var n=t.scList.findIndex((function(t){return t.id===e.id}));t.scList[n]=e,f.collection("users").doc(u).collection("DceList").doc(c).collection("Scenarios").doc(s.id.toString()).set(Object.assign({},e))},p=ie(t,c,s,r,l,o,(function(e,t){var c=Object(j.a)({},s);c.fValues[t]=e,r(c),l(!1)}),O,(function(e){if(m()){var t=h(s.fValues);i(t,s.id).then((function(e){s.altnr=e,x(s)}))}}),(function(e){e.preventDefault();var t=e.target,c=t.name,n=t.value,a=Object(j.a)({},s);a[c]=n,r(a),l(!1)})).scenarioHtml;return Object(n.jsx)("div",{children:p},"1")}var oe=function e(t,c,n,a,s,r,i){Object(N.a)(this,e),this.id=t,this.scText=c,this.scExpl=n,this.scImg=a,this.fValues=s,this.altSc=r,this.altnr=i};function ue(e){var t=e.currentDce,c=e.dceId,s=e.currentSc,r=e.setCurrentSc,i=Object(a.useContext)(y).uid,o=Object(a.useState)(!1),u=Object(L.a)(o,2),h=u[0],m=u[1],O=Object(a.useState)([]),x=Object(L.a)(O,2),p=x[0],v=x[1],g=Object(a.useState)(""),N=Object(L.a)(g,2),C=N[0],S=N[1],w=function(){var e=Object(b.a)(d.a.mark((function e(n,a){var s,l,o,u,b;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=18;break}return s={},t.features.forEach((function(e){s[e.featureName]=""})),t.scList.sort((function(e,t){return e.id-t.id})),l=1,t.scList.forEach((function(e){e.id===l&&(l+=1)})),o=!1,a&&(o=!0,s=Object(j.a)({},n)),u={id:l,altnr:a,altSc:o,fValues:s,scText:"",scImg:"",scExpl:""},f.collection("users").doc(i).collection("DceList").doc(c).collection("Scenarios").doc(l.toString()).set(u),b=new oe(l,"","","",s,o,a||null),t.scList.push(b),t.scList.sort((function(e,t){return e.id-t.id})),m(!1),S("added"+l),r(b),e.abrupt("return",b.id);case 18:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=[];t.scList&&t.scList.forEach((function(a,l){e.push(Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":a.id,children:[Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){r({dummy:"clear"+l}),r(a),m(!1)},children:a.id}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsxs)("button",{className:"btn  btn-outline-warning btn-sm mx-2",onClick:function(){r({dummy:"clear"+l}),r(a),m(!1)},children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"edit"})]}),Object(n.jsx)("hr",{className:"rulerSm"}),Object(n.jsxs)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:function(){window.confirm("Are you sure you wish to delete this scenario?")&&function(e){var n=e.id,a=t.scList.findIndex((function(e){return e.id===n})),l=t.scList[a].altnr;if(t.scList.splice(a,1),f.collection("users").doc(i).collection("DceList").doc(c).collection("Scenarios").doc(n.toString()).delete().then((function(){console.log("Scenario with ID "+n+"  successfully deleted!"),n===s.id&&r({dummy:s.id}),m(!1),S("deleted"+n)})).catch((function(e){console.error("Error removing document: ",e)})),l){var o=t.scList.findIndex((function(e){return e.id===l}));o>-1&&t.scList.splice(o,1),f.collection("users").doc(i).collection("DceList").doc(c).collection("Scenarios").doc(l.toString()).delete().then((function(){console.log("Alt scenario with ID "+l.toString()+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))}}(a)},children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]})]})})},l))})),v(e)}),[C,s]),Object(n.jsxs)("div",{children:[Object(n.jsxs)("h4",{children:[Object(n.jsx)("u",{children:"Details"})," for ",Object(n.jsxs)("b",{children:[" ",t&&t.name,!t.name&&Object(n.jsx)("span",{children:" - Select a dce"})]}),s.id&&Object(n.jsxs)("span",{children:[" - Scenario nr. ",s.id]}),!s.id&&Object(n.jsx)("span",{children:" - Select a scenario nr."})]}),Object(n.jsx)("div",{className:"",children:Object(n.jsxs)("h6",{children:[t&&t.id&&Object(n.jsxs)("span",{children:[" ",Object(n.jsx)(l.b,{to:{pathname:"/app/"+i+"/"+t.id},children:Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"play_circle_outline"})})})]}),t&&t.id&&Object(n.jsx)("span",{children:" Play this DCE"})," ",t&&t.id&&Object(n.jsxs)("span",{children:[" ",Object(n.jsx)("hr",{className:"ruler detailsRuler"})," ",Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){var e=window.location.href+"app/"+i+"/"+t.id;navigator.clipboard.writeText(e)},children:"Copy DCE link "})]})," "]})}),Object(n.jsx)("div",{className:"pb-4",children:Object(n.jsxs)("h6",{children:[" ",t&&t.grouped&&Object(n.jsxs)("span",{children:["Group feature: ",t&&t.groupFeature]})," ",Object(n.jsxs)("span",{children:[" ",Object(n.jsx)("hr",{className:"ruler detailsRuler"})," Questions in DCE: ",t&&t.nrQuestions]})]})}),Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"scenarioList col col-6 col-md-3 col-sm-5",children:[Object(n.jsx)("h5",{children:"Scenario's"}),Object(n.jsxs)("ul",{children:[Object(n.jsxs)("li",{className:"listRuler mb-1",children:["Nr.  ",Object(n.jsx)("hr",{className:"ruler"})," Edit ",Object(n.jsx)("hr",{className:"rulerSm"}),"\xa0Delete "]},"header"),p,t&&t.id&&Object(n.jsx)("li",{className:"mb-2",children:Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:function(){w(null,null)},children:"Add scenario"})})]})]}),Object(n.jsx)("div",{className:"col",children:Object(n.jsx)(le,{currentDce:t,dceId:c,currentSc:s,setCurrentSc:r,handleAddScenario:w,setIsSaved:m,isSaved:h})})]})]})}var de=c(5);function je(e){var t=e.addAspect,c=Object(a.useState)(["name"]),s=Object(L.a)(c,2),r=s[0],i=s[1],l=Object(a.useState)(["descr"]),o=Object(L.a)(l,2),u=o[0],d=o[1],j=function(e,t){var c=e.target.value,n=Object(k.a)(t);return n[0]=c,n};return Object(n.jsx)("div",{children:Object(n.jsxs)("form",{className:"form-inline",children:[Object(n.jsxs)("div",{className:"my-2",children:[Object(n.jsx)("label",{htmlFor:"aspectName",className:"block",children:"Name: "}),Object(n.jsx)("input",{type:"text",className:"form-control mb-2",name:"aspectName",placeholder:"Aspect name",id:"aspectName",required:!0,onChange:function(e){var t=j(e,r);i(t)}})]}),Object(n.jsxs)("div",{className:"my-2",children:[Object(n.jsx)("label",{htmlFor:"aspectDescr",className:"block",children:"Description: "}),Object(n.jsx)("textarea",{type:"text",rows:"3",className:"form-control mb-2",name:"aspectDescr",placeholder:"Description",id:"aspectDescr",required:!0,onChange:function(e){var t=j(e,u);d(t)}})]}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){e.preventDefault(),t(r[0],u[0])},children:"Save aspect"})]})})}function be(e){var t=e.currentDce,c=e.refreshListFlag,s=e.setCurrentAsp,r=e.deleteAspect,i=Object(a.useState)([]),l=Object(L.a)(i,2),o=l[0],u=l[1];return Object(a.useEffect)((function(){var e=[];t.aspectList&&t.aspectList.forEach((function(t,c){e.push(Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h6",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":t.id,children:[" ",Object(n.jsx)("b",{children:t.name}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-warning",onClick:function(){s({dummy:"clear"+c}),s(t)},children:Object(n.jsx)("i",{className:"material-icons mat-icon",children:"edit"})}),Object(n.jsx)("hr",{className:"rulerSm"}),Object(n.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-2",onClick:function(){r(t)},children:Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})})]},c)})},"aspectList ".concat(c)))})),u(e)}),[t,c]),Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Aspect list"})}),Object(n.jsx)("ul",{children:o})]})})}var he=function e(t,c){Object(N.a)(this,e),this.age=t,this.gender=c},me=function e(t,c,n){Object(N.a)(this,e),this.nr=t,this.groupValue=c,this.filterList=n},fe=function e(t,c,n,a,s){Object(N.a)(this,e),this.id=t,this.name=c,this.descr=n,this.ageGender=a,this.combiList=s};var Oe=function e(t,c){Object(N.a)(this,e),this.fName=t,this.fValue=c};function xe(e){var t=e.currentDce,c=e.currentAsp,s=e.showAspectsFlag,r=e.setCurrentDce,i=e.setCurrentAsp,l=e.filterSaved,o=e.setFilterSaved,u=e.editFunctions,d=u.saveFilters,b=u.handleAddCombi,h=u.handleDeleteCombi,m=function(e,t,c,s,r,i,l,o,u,d,j,b){var h=Object(a.useState)([]),m=Object(L.a)(h,2),f=m[0],O=m[1],x=[{}],p=[{label:"younger than 25 years",value:"younger than 25 years"},{label:"25 years or older",value:"25 years or older"}],v=[{label:"female",value:"female"},{label:"male",value:"male"}],g=e.features;return Object(a.useEffect)((function(){var c=[];t.combiList&&t.combiList.forEach((function(a,l){c.push(Object(n.jsxs)("div",{id:l,children:[" ",0!==l&&Object(n.jsxs)("h5",{className:"my-5",children:[Object(n.jsxs)("button",{onClick:function(e){return j(e,l)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]}),"combined with:"]}),Object(n.jsxs)("h5",{children:["Select value for group feature - ",e.groupFeature]}),Object(n.jsx)("label",{htmlFor:"groupVal",children:"Group value"}),Object(n.jsx)("div",{className:"selectInputs mb-3",children:e.features&&x.map((function(c,s){return Object(n.jsx)(M.a,{options:[{label:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue1,value:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue1},{label:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue2,value:e.features.find((function(t){return t.featureName===e.groupFeature})).featureValue2}],placeholder:a.groupValue||"Select...",onChange:function(e){return i(e.value,l)}},"".concat(t.id,"-grValue- ").concat(l))}))}),Object(n.jsx)("h5",{children:"Filter features and values"})]},l+t.id)),a.filterList&&a.filterList.length>0&&a.filterList.forEach((function(a,i){c.push(Object(n.jsxs)("div",{id:i,className:"selectInputs my-3",children:[Object(n.jsx)("span",{children:Object(n.jsx)(M.a,{options:g&&g.map((function(t,c){var n=t.featureName,a=!1;return t.featureName===e.groupFeature&&(a=!0),{label:n,value:n,isDisabled:a}})),id:"fNames",placeholder:a.fName||"Enter feature name",onChange:function(e){s(e.value,l,i)}},"".concat(t.id,"-fName- ").concat(l))}),Object(n.jsx)("span",{className:"selectInputs pb-3",children:a.fName&&Object(n.jsx)(M.a,{options:[{label:g.find((function(e){return e.featureName===a.fName})).featureValue1,value:g.find((function(e){return e.featureName===a.fName})).featureValue1},{label:g.find((function(e){return e.featureName===a.fName})).featureValue2,value:g.find((function(e){return e.featureName===a.fName})).featureValue2}],placeholder:a.fValue||"Enter feature value",onChange:function(e){return r(e.value,l,i)}})}),Object(n.jsx)("span",{children:Object(n.jsxs)("button",{onClick:function(e){return o(e,i,l)},className:"btn  btn-outline-success btn-sm mx-2",children:[" ",Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})]})})]},"".concat(t.id,"-feature- ").concat(l," ").concat(i)))})),c.push(Object(n.jsx)("div",{children:Object(n.jsx)("span",{children:Object(n.jsx)("button",{onClick:function(e){return u(e,l)},className:"btn  btn-outline-success btn-sm mx-2",children:" Add filter feature"})})},"addFilterButton"+l))})),c.push(Object(n.jsxs)("div",{children:[!t.dummy&&Object.keys(t).length>0&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:d,children:"Add combination feature"}),Object(n.jsx)("span",{children:g&&Object(n.jsx)("form",{children:Object(n.jsxs)("div",{className:"selectInputs pb-3",children:[t.ageGender&&Object(n.jsx)("label",{htmlFor:"ageFilter",className:"",children:"Optional filters for age and gender of participants "}),t.ageGender&&Object(n.jsx)(M.a,{options:p,isClearable:!0,id:"ageFilter",name:"age",placeholder:t.ageGender.age||"Select age filter ...",onChange:function(e,c){var n;n=null==e?"":e.value,l(c.name,n,t.id)}},"ageFilter"),t.ageGender&&Object(n.jsx)(M.a,{options:v,isClearable:!0,id:"genderFilter",name:"gender",placeholder:t.ageGender.gender||"Select gender filter ...",onChange:function(e,c){var n;n=null==e?"":e.value,l(c.name,n,t.id)}},"genderFilter")]},"agSelectForm")})}),!t.dummy&&Object.keys(t).length>0&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mb-3",onClick:b,children:"save all filters "})]},"filterform +".concat(t.id))),O(c)}),[t,e,c]),{editHtml:f}}(t,c,s,(function(e,t,n){var a=Object(k.a)(c.combiList);a[t].filterList[n].fName=e,i((function(e){return Object(j.a)(Object(j.a)({},e),{},{combiList:a})})),o(!1)}),(function(e,t,n){var a=Object(k.a)(c.combiList);a[t].filterList[n].fValue=e,i((function(e){return Object(j.a)(Object(j.a)({},e),{},{combiList:a})})),o(!1)}),(function(e,t){var n=Object(k.a)(c.combiList);n[t].groupValue=e,i((function(e){return Object(j.a)(Object(j.a)({},e),{},{combiList:n})})),o(!1)}),(function(e,c,n){var a=t.aspectList.findIndex((function(e){return e.id===n})),s=Object(k.a)(t.aspectList),l=Object(j.a)({},s[a]),u=Object(j.a)({},l.ageGender);u[e]=c,l.ageGender=u,s[a]=l,r((function(e){return Object(j.a)(Object(j.a)({},e),{},{aspectList:s})})),i((function(e){return Object(j.a)(Object(j.a)({},e),{},{ageGender:u})})),o(!1)}),(function(e,t,n){e.preventDefault();var a=Object(k.a)(c.combiList);a[n].filterList.splice(t,1),i((function(e){return Object(j.a)(Object(j.a)({},e),{},{combiList:a})})),o(!1)}),(function(e,t){e.preventDefault();var n=Object(k.a)(c.combiList);n[t].filterList.push(new Oe("","")),i((function(e){return Object(j.a)(Object(j.a)({},e),{},{combiList:n})})),o(!1)}),b,h,d).editHtml;return c.dummy||0!==!Object.keys(c).length||[].push(Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info my-4",onClick:b,children:"add combination feature"})),Object(n.jsxs)("div",{children:[Object(n.jsxs)("h4",{className:"mb-1",children:["Define aspect for ",Object(n.jsx)("b",{children:c.name||"(Select an aspect..)"})]}),Object(n.jsxs)("h6",{className:"text-secondary pb-3",children:["Description: ",c.descr]}),!c.dummy&&m,l&&Object(n.jsx)("h6",{children:"Filters saved"})]})}function pe(e){var t=e.currentDce,c=e.dceId,s=e.currentAsp,r=e.setCurrentDce,i=e.setCurrentAsp,l=Object(a.useContext)(y).uid,o=Object(a.useState)(""),u=Object(L.a)(o,2),d=u[0],j=u[1],b=Object(a.useState)(""),h=Object(L.a)(b,2),m=h[0],O=h[1],x=Object(a.useState)(!1),p=Object(L.a)(x,2),v=p[0],g=p[1],N=Object(a.useState)(!1),C=Object(L.a)(N,2),S=C[0],w=C[1],E=function(){var e=0;return s.combiList.sort((function(e,t){return e.nr-t.nr})).forEach((function(t){if(t.nr!==e)return e;e+=1})),e},D=function(e){f.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList").doc(s.id).collection("Combis").doc(e.nr.toString()).set(Object.assign({},e)).then((function(){console.log("combi added with nr "+e.nr)})).catch((function(e){console.log("Error adding combi",e)}))},k=function(){w(!S)},A={saveFilters:function(){var e=f.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList");t.aspectList.length>0&&t.aspectList.forEach((function(t){e.doc(t.id).update({ageGender:{age:t.ageGender.age,gender:t.ageGender.gender}});var c=e.doc(t.id).collection("Combis");t.combiList.length>0&&t.combiList.forEach((function(e){var t=e.filterList,n=Object(de.a)(e,["filterList"]),a=[];t.forEach((function(e){var t={fName:e.fName,fValue:e.fValue};a.push(t)})),n.filterList=a,c.doc(e.nr.toString()).set(Object.assign({},n)).then((function(){console.log("combi saved with nr "+e.nr),g(!0)})).catch((function(e){console.log("Error saving combi",e)}))}))}))},handleAddCombi:function(){var e=E(),t=new me(e,"",[]);s.combiList.push(t),D(t),j("combi added"+e)},handleDeleteCombi:function(e,t){f.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList").doc(s.id).collection("Combis").doc(t.toString()).delete().then((function(){console.log("Combination successfully deleted!"),s.combiList.splice(t,1),j("combi deleted"+t)})).catch((function(e){console.error("Error removing document: ",e)}))}};return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsx)(be,{currentDce:t,refreshListFlag:m,setCurrentAsp:i,deleteAspect:function(e){var n=e.id,a=t.aspectList.findIndex((function(e){return e.id===n})),r=f.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList").doc(n);r.collection("Combis").get().then((function(e){e.forEach((function(e){r.collection("Combis").doc(e.id).delete().then((function(){console.log("Combi with ID "+e.id+" deleted")}))}))})).then((function(){r.delete().then((function(){t.aspectList.splice(a,1),console.log("Document with ID"+n+"  successfully deleted!"),O("set flag "+n)})).catch((function(e){console.error("Error removing document: ",e)})),s.id===n&&i({dummy:s.id})}))}}),Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"col-auto  ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Create new Aspect"})}),Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:k,children:" new Aspect"})]}),S&&Object(n.jsx)(je,{dceId:c,addAspect:function(e,n){var a=f.collection("users").doc(l).collection("DceList").doc(c).collection("AspectList");a.add({aspectName:e,aspectDescr:n,ageGender:{age:"",gender:""}}).then((function(c){console.log("Document written with ID: ",c.id),a.doc(c.id).collection("Combis").doc("0").set({nr:0,groupValue:"",filterList:[]});var s=[new me(0,"",[])],r=new he("",""),l=new fe(c.id,e,n,r,s);t.aspectList.push(l),i(l),O("new aspect saved id "+c.id)})).catch((function(e){console.error("Error adding document: ",e)})),k()},setRefreshListFlag:O,showNewAspectForm:k})]}),Object(n.jsxs)("div",{className:"col-auto my-4 ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Clear recorded results for this dce"})}),Object(n.jsxs)("div",{children:[" ",Object(n.jsxs)("button",{className:"btn btn-sm btn-outline-danger",onClick:function(){window.confirm("You are about to DELETE all results recorded for this dce so far!! Click Ok to continue.")&&function(e){var t=f.collection("users").doc(l).collection("DceList").doc(e.toString()).collection("RawResults");t.get().then((function(e){e.docs.forEach((function(e){t.doc(e.id).delete()}))})),alert("All results for this DCE have been deleted.")}(t.id)},children:[" ",Object(n.jsx)("b",{children:"CLEAR"})]})]})]})]})]}),Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(xe,{currentDce:t,currentAsp:s,showAspectsFlag:d,setCurrentDce:r,setCurrentAsp:i,filterSaved:v,setFilterSaved:g,editFunctions:A})})]})})}var ve=function(e){var t=Object(a.useState)([]),c=Object(L.a)(t,2),n=c[0],s=c[1];return Object(a.useEffect)((function(){f.collection("users").doc(e).collection("DceList").get().then((function(e){var t=[];e.docs.forEach((function(e){var c;c=e.data().grouped?new $(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped,e.data().groupFeature):new _(e.id,e.data().name,e.data().descr,e.data().nrQuestions,e.data().features,e.data().grouped),t.push(c)})),s(t)})).catch((function(e){console.log("Error with loading dce"+e)}))}),[e]),Object(a.useEffect)((function(){n.forEach((function(t){f.collection("users").doc(e).collection("DceList").doc(t.id).collection("Scenarios").orderBy("id").get().then((function(e){var c=[];e.forEach((function(e){var t=new oe(e.data().id,e.data().scText,e.data().scExpl,e.data().scImg,e.data().fValues,e.data().altSc,e.data().altnr);c.push(t)})),t.scList=c})).catch((function(e){console.log("Error with loading scenario document"+e)}))}))}),[n]),Object(a.useEffect)((function(){n.forEach((function(t){f.collection("users").doc(e).collection("DceList").doc(t.id).collection("AspectList").orderBy("aspectName").get().then((function(c){var n=[];c.forEach((function(c){var a=f.collection("users").doc(e).collection("DceList").doc(t.id).collection("AspectList").doc(c.id),s=[];a.collection("Combis").get().then((function(e){e.forEach((function(e){var t=new me(e.data().nr,e.data().groupValue,e.data().filterList);s.push(t)}));var t=new he("","");c.data().ageGender&&(t=new he(c.data().ageGender.age,c.data().ageGender.gender));var a=new fe(c.id,c.data().aspectName,c.data().aspectDescr,t,s);n.push(a)})),t.aspectList=n}))})).catch((function(e){console.log("Error with loading aspect document"+e)}))}))}),[n]),n},ge=c(9),Ne=function(e,t,c,s){var r=e.handleEntry,i=e.handleInputChange,l=e.handleRemoveClick,o=e.handleNrQuestionsInput,u=e.inputList,d=t.setGroupValue,j=t.groupChecked,b=t.groupValue,h=t.handleCheckbox,m=c.handleAddClick,f=c.saveDce,O=c.nrQuestions,x=Object(a.useState)([]),p=Object(L.a)(x,2),v=p[0],g=p[1];return Object(a.useEffect)((function(){var e=[],t=u&&u.map((function(e,t){return{label:e.featureName,value:e.featureName}}));e.push(Object(n.jsx)("div",{children:Object(n.jsxs)("form",{className:"form-inline",children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:"dceName",className:"block",children:"Name: "}),Object(n.jsx)("input",{type:"text",className:"form-control mb-2",name:"name",placeholder:"DCE name",id:"dceName",onChange:function(e){return r(e)}},"dceName")]},"formdiv"),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:"descr",className:"block",children:"Description: "}),Object(n.jsx)("textarea",{type:"text",className:"form-control mb-2",name:"descr",rows:"3",placeholder:"This text will be displayed in the DCE",id:"descr",onChange:function(e){return r(e)}},"descr")]},"formdiv2"),u&&u.map((function(e,t){return Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"",children:[Object(n.jsx)("label",{htmlFor:t+"Fname",className:"",children:"Feature name: "}),Object(n.jsx)("input",{className:"form-control mb-2",name:"featureName",required:!0,id:t+"Fname",placeholder:"Enter feature name",value:e.featureName,onChange:function(e){return i(e,t)}})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:t+"fV1",className:"",children:"Feature value 1: "}),Object(n.jsx)("input",{className:"form-control mb-2",name:"featureValue1",required:!0,id:t+"fV1",placeholder:"Enter value",value:e.featureValue1,onChange:function(e){return i(e,t)}},t+"fV1")]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:t+"fV2",className:"",children:"Feature value 2: "}),Object(n.jsx)("input",{className:"form-control mb-2",name:"featureValue2",required:!0,id:t+"fV2",placeholder:"Enter value",value:e.featureValue2,onChange:function(e){return i(e,t)}},t+"fV2")]}),Object(n.jsx)("div",{className:"col col-xs-1",children:1!==u.length&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-success mb-2",onClick:function(e){return l(e,t)},children:Object(n.jsx)("i",{className:"material-icons mat-icon",children:"delete_forever"})})}),Object(n.jsx)("div",{children:u.length-1===t&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mb-2",onClick:function(e){return m(e)},children:"Add another feature"})})]},"topdiv"+t)})),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{htmlFor:"nrChoices",children:"Nr of questions in DCE"}),Object(n.jsx)("input",{type:"number",className:"col col-xs-1 form-control mb-2",id:"nrChoices",name:"nrQuestions",onChange:function(e){return o(e)}})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("input",{type:"checkbox",name:"grouped",id:"chkGrp",checked:j,onChange:h}),Object(n.jsx)("label",{htmlFor:"grouped",className:"",children:"Group by feature "})]},"chkbox"),Object(n.jsx)("div",{children:j&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("label",{className:"col-xs-6 col-form-label pb-0",id:"gr-label",htmlFor:"GrFeat",children:"Group feature"}),Object(n.jsx)(M.a,{className:"form form-select-sm col-xs-6 mb-2",id:"GrFeat",value:t.label,options:t,onChange:function(e){return d(e.value)}})]})}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-success",onClick:function(e){return f(e)},children:"Save DCE"})]},"form")},"i")),g(e)}),[u,b,O,j,s]),{dceHtml:v}};function Ce(e){var t=e.showNewDceForm,c=e.dceList,s=e.setDceListChanged,r=Object(a.useState)([{featureName:null,featureValue1:null,featureValue2:null}]),i=Object(L.a)(r,2),l=i[0],o=i[1],u=Object(a.useState)(!1),d=Object(L.a)(u,2),b=d[0],h=d[1],m=Object(a.useState)(null),f=Object(L.a)(m,2),O=f[0],x=f[1],p=Object(a.useState)(0),v=Object(L.a)(p,2),g=v[0],N=v[1],C=Object(a.useState)({descr:""}),S=Object(L.a)(C,2),w=S[0],E=S[1],D=(Object(a.useContext)(y).uid,function(e){return null==e.featureName||""===e.featureName?(alert("Please fill in all feature names"),!1):null!=e.featureValue1&&""!==e.featureValue1&&null!=e.featureValue2&&""!==e.featureValue2||(alert("Please fill in all feature values"),!1)}),A=function(e){return w.name===e},F=Ne({handleEntry:function(e){e.preventDefault();var t=e.target,c=t.name,n=t.value;E((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(ge.a)({},c,n))}))},handleInputChange:function(e,t){e.preventDefault();var c=e.target,n=c.name,a=c.value,s=Object(k.a)(l);s[t][n]=a,o(s)},handleRemoveClick:function(e,t){e.preventDefault();var c=Object(k.a)(l);c.splice(t,1),o(c)},handleNrQuestionsInput:function(e){e.preventDefault();var t,c=e.target.value;t=Number(c),N(t),E((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(ge.a)({},"nrQuestions",t))}))},inputList:l},{setGroupValue:x,groupChecked:b,groupValue:O,handleCheckbox:function(){h(!b)}},{handleAddClick:function(e){e.preventDefault(),o([].concat(Object(k.a)(l),[{featureName:null,featureValue1:null,featureValue2:null}]))},saveDce:function(e){var n;(e.preventDefault(),l.every(D)&&function(){var e=w.name;return void 0===e||""===e||c.list.length>0&&c.nameList().some(A)?(alert("Fill in a unique DCE name"),!1):!(w.nrQuestions<=0||!w.nrQuestions)||(alert("Fill in the number of questions (higher than 0) the participant has to answer in the DCE"),!1)}()&&(!b||null!==O||(alert("Please select a value for the group feature"),0)))&&(n=b?new $(null,w.name,w.descr,w.nrQuestions,l,b,O):new _(null,w.name,w.descr,w.nrQuestions,l,b),c.list&&c.addDce(n).then((function(e){s(e)})),t())},nrQuestions:g},w).dceHtml;return Object(n.jsx)("div",{children:F})}function Se(e){var t=e.dceList,c=Object(a.useState)(!1),s=Object(L.a)(c,2),r=s[0],i=s[1],l=Object(a.useState)(""),o=Object(L.a)(l,2),u=o[0],d=o[1],j=Object(a.useContext)(y).uid,b=Object(a.useState)({}),h=Object(L.a)(b,2),m=h[0],f=h[1],O=Object(a.useState)({}),x=Object(L.a)(O,2),p=x[0],v=x[1],g=Object(a.useState)({}),N=Object(L.a)(g,2),C=N[0],S=N[1],w=Object(a.useState)(!0),E=Object(L.a)(w,2),D=E[0],k=E[1];t.list=ve(j);var A=Object(a.useState)([]),F=Object(L.a)(A,2),I=F[0],V=F[1];Object(a.useEffect)((function(){var e=[];t.list.length>0&&t.list.forEach((function(c,a){e.push(Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":c.id,children:[" ",Object(n.jsx)("b",{children:c.name}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)("button",{className:"btn btn-sm btn-outline-warning mx-1",onClick:function(){f(c),v({dummy:c.id+p.id}),k(!0)},children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"edit"})}),Object(n.jsx)("hr",{className:"rulerSm"}),c.grouped&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",onClick:function(){f(c),S({dummy:c.id+C.id}),k(!1)},children:"settings"})}),Object(n.jsx)("hr",{className:"rulerSm"}),Object(n.jsx)("button",{className:"btn  btn-outline-success btn-sm mx-1",onClick:function(){window.confirm("Are you sure you wish to delete this DCE?")&&(t.deleteDce(c),d(c.id),f({dummy:c.id}),v({dummy:"sc deleted"}),S({dummy:"asp deleted"}))},children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"delete_forever"})})]})})},a))})),V(e)}),[t.list,u]);var G=function(){i(!r)};return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"DCE list"})}),Object(n.jsx)("ul",{children:I})]}),Object(n.jsx)("div",{className:"row my-4",children:Object(n.jsxs)("div",{className:"col-auto  ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"Create new DCE"})}),Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info",onClick:G,children:" new DCE"})]}),t.list&&r&&Object(n.jsx)(Ce,{showNewDceForm:G,dceList:t,setDceListChanged:d})]})})]}),D&&Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(ue,{currentDce:m,dceId:m.id,currentSc:p,setCurrentSc:v})}),!D&&Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(pe,{currentDce:m,dceId:m.id,currentAsp:C,setCurrentDce:f,setCurrentAsp:S})})]})})}function we(e){var t=e.dceList,c=Object(a.useContext)(y).uid,s=Object(a.useState)({}),r=Object(L.a)(s,2),i=r[0],o=r[1];return t.list=ve(c),Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"row my-4",children:[Object(n.jsxs)("div",{className:"listContainer col col-12 col-sm-3",children:[Object(n.jsxs)("div",{className:" col-auto ",children:[Object(n.jsx)("h4",{children:Object(n.jsx)("u",{children:"DCE list"})}),Object(n.jsx)("ul",{children:t.list&&t.list.map((function(e,t){return Object(n.jsx)("div",{className:"",children:Object(n.jsx)("h5",{className:"mt-3",children:Object(n.jsxs)("li",{className:"listRuler mb-1","data-id":e.id,children:[" ",Object(n.jsx)("b",{children:e.name}),Object(n.jsx)("hr",{className:"ruler"}),Object(n.jsx)(l.b,{to:{pathname:"/app/"+c+"/"+e.id},children:Object(n.jsx)("button",{className:"btn btn-sm btn-outline-info mx-1",children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"play_circle_outline"})})}),e.grouped&&Object(n.jsx)("button",{className:"btn btn-sm btn-outline-danger mx-1",onClick:function(){o(e)},children:Object(n.jsx)("i",{className:"material-icons mat-icon mt-1",children:"poll"})})]})})},t)}))})]}),Object(n.jsx)("div",{className:"row my-4",children:Object(n.jsx)("div",{className:"col-auto  ",children:Object(n.jsx)("div",{})})})]}),Object(n.jsx)("div",{className:"col scenarioContainer",children:Object(n.jsx)(J,{currentDce:i,dceId:i.id,userId:c})})]})})}var ye=function e(t){var c=this;Object(N.a)(this,e),this.uid=t.uid,this.list=[],this.nameList=function(){var e=[];return this.list.forEach((function(t){return e.push(t.name)})),e},this.deleteDce=function(e){var t=e.id,n=c.list.findIndex((function(e){return e.id===t}));c.list.splice(n,1),c.clearCollection(t,"Scenarios"),c.clearCollection(t,"AspectList"),c.clearCollection(t,"RawResults"),f.collection("users").doc(c.uid).collection("DceList").doc(t.toString()).delete().then((function(){console.log("Document with ID"+t+"  successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))},this.addDce=function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.list.push(t),t.id,t.scList,t.aspectList,n=Object(de.a)(t,["id","scList","aspectList"]),f.collection("users").doc(c.uid).collection("DceList").add(Object.assign({},n)).then((function(e){return console.log("Document written with ID: ",e.id),t.id=e.id,e.id})).catch((function(e){console.error("Error adding document: ",e)})),e.abrupt("return",t.name);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.clearCollection=function(e,t){var n=f.collection("users").doc(c.uid).collection("DceList").doc(e.toString()).collection(t);n.get().then((function(e){e.docs.forEach((function(e){"AspectList"===t&&n.doc(e.id).collection("Combis").onSnapshot((function(t){t.docs.forEach((function(t){n.doc(e.id).collection("Combis").doc(t.id).delete().then((function(){console.log("Combi deleted with id "+t.id)}))}))})),n.doc(e.id).delete().then((function(){console.log("Document deleted with id "+e.id+" from collection "+t)}))}))}))}};var Ee=function(){var e=Object(a.useContext)(y),t=Object(a.useState)([]),c=Object(L.a)(t,2),s=c[0],r=c[1];return Object(a.useEffect)((function(){if(e){console.log("user is logged in: "+JSON.stringify(e));var t=new ye(e);r(t)}}),[e]),e?Object(n.jsx)(o.c,{children:Object(n.jsxs)(l.a,{children:[Object(n.jsx)(o.a,{exact:!0,path:"/",children:Object(n.jsx)(Se,{dceList:s})}),Object(n.jsx)(o.a,{exact:!0,path:"/dcePlayList",children:Object(n.jsx)(we,{dceList:s})}),Object(n.jsx)(o.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(n.jsx)(ee,{})}})]})}):Object(n.jsx)(o.c,{children:Object(n.jsxs)(l.a,{children:[Object(n.jsxs)(o.a,{exact:!0,path:"/signUp",children:[" ",Object(n.jsx)(ce,{})]}),Object(n.jsxs)(o.a,{exact:!0,path:"/",children:[" ",Object(n.jsx)(te,{})]}),Object(n.jsxs)(o.a,{exact:!0,path:"/passwordReset",children:[" ",Object(n.jsx)(ne,{})," "]}),Object(n.jsx)(o.a,{exact:!0,path:"/dcePlayList",children:Object(n.jsx)(te,{})}),Object(n.jsx)(o.a,{path:"/app/:userId/:dceId",exact:!0,component:function(){return Object(n.jsx)(ee,{})}})]})})};var De=function(){return Object(n.jsx)("div",{className:"App",children:Object(n.jsx)(l.a,{children:Object(n.jsxs)(E,{children:[Object(n.jsx)(D,{}),Object(n.jsx)(Ee,{})]})})})};i.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(De,{})}),document.getElementById("root"))},49:function(e,t,c){},64:function(e,t,c){},65:function(e,t,c){}},[[108,1,2]]]);
//# sourceMappingURL=main.3965b23a.chunk.js.map